{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///post-robot.ie.min.js","webpack:///webpack/bootstrap e6b67721146c44b5a85e","webpack:///./src/conf/index.js","webpack:///./src/lib/index.js","webpack:///./src/global.js","webpack:///./~/cross-domain-safe-weakmap/src/index.js","webpack:///./src/drivers/index.js","webpack:///./src/lib/util.js","webpack:///./src/interface.js","webpack:///./src/lib/windows.js","webpack:///./~/sync-browser-mocks/src/promise.js","webpack:///./src/bridge/common.js","webpack:///./src/bridge/index.js","webpack:///./src/lib/log.js","webpack:///./src/compat/index.js","webpack:///./src/conf/constants.js","webpack:///./src/drivers/listeners.js","webpack:///./src/drivers/send/index.js","webpack:///./src/lib/domain.js","webpack:///./src/lib/promise.js","webpack:///./src/lib/tick.js","webpack:///./~/cross-domain-safe-weakmap/src/interface.js","webpack:///./~/cross-domain-safe-weakmap/src/util.js","webpack:///./~/cross-domain-safe-weakmap/src/weakmap.js","webpack:///./src/bridge/bridge.js","webpack:///./src/bridge/child.js","webpack:///./src/bridge/interface.js","webpack:///./src/bridge/parent.js","webpack:///./src/compat/ie.js","webpack:///./src/conf/config.js","webpack:///./src/drivers/receive/index.js","webpack:///./src/drivers/receive/types.js","webpack:///./src/drivers/send/strategies.js","webpack:///./src/lib/methods.js","webpack:///./src/lib/ready.js","webpack:///./src/public/client.js","webpack:///./src/public/config.js","webpack:///./src/public/index.js","webpack:///./src/public/server.js","webpack:///./src/index.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_config","keys","forEach","key","_constants","_promise","_util","_log","_windows","_methods","_tick","_ready","_domain","global","undefined","_conf","window","CONSTANTS","WINDOW_PROPS","POSTROBOT","registerSelf","_interopRequireWildcard","obj","newObj","_interface","INTERFACE","_receive","_send","_listeners","isRegex","item","toString","weakMapMemoize","method","map","_src","WeakMap","arg","result","set","util","_typeof","Symbol","iterator","constructor","once","called","apply","arguments","noop","safeHasProp","err","safeGetProp","listen","win","event","handler","addEventListener","attachEvent","cancel","removeEventListener","detachEvent","context","args","find","collection","def","length","results","push","some","Boolean","mapping","values","getByValue","uniqueID","chars","replace","charAt","Math","floor","random","memoize","JSON","stringify","Array","slice","extend","source","each","callback","isArray","replaceObject","depth","Error","newobj","safeInterval","time","runInterval","timeout","setTimeout","clearTimeout","intervalTimeout","interval","getActualDomain","location","protocol","host","getDomain","mockDomain","indexOf","MOCK_PROTOCOL","FILE_PROTOCOL","getDomainFromUrl","url","domain","match","split","join","safeGet","prop","init","_global","initialized","_drivers","listenForMessages","openTunnelToOpener","_lib","initOnReady","listenForMethods","Promise","_public","isSameDomain","domainMatches","has","domainMatchTimeout","isActuallySameDomain","href","getOpener","opener","getParent","parent","getParents","isAncestorParent","child","childParent","getFrames","frames","len","frame","getAllChildFrames","_iterator","_isArray","_i2","_ref","next","done","_iterator2","_isArray2","_i3","_ref2","childFrame","getAllFramesInWindow","_iterator3","_isArray3","_i4","_ref3","_iterator4","_isArray4","_i5","_ref4","getTop","top","_iterator5","_isArray5","_i6","_ref5","isWindowClosed","allowMock","closed","message","getUserAgent","navigator","mockUserAgent","userAgent","getFrameByName","winFrames","_iterator6","_isArray6","_i7","_ref6","findChildFrameByName","_iterator7","_isArray7","_i8","_ref7","namedFrame","findFrameByName","isParent","frameParent","_iterator8","_isArray8","_i9","_ref8","isOpener","getAncestor","getAncestors","ancestor","isAncestor","actualParent","_iterator9","_isArray9","_i10","_ref9","isPopup","isIframe","isFullpage","getWindowType","WINDOW_TYPES","POPUP","IFRAME","FULLPAGE","anyMatch","collection1","collection2","_iterator10","_isArray10","_i11","_ref10","item1","_iterator11","_isArray11","_i12","_ref11","item2","isSameTopWindow","win1","win2","top1","top2","allFrames1","allFrames2","opener1","opener2","jsonStringify","objectToJSON","arrayToJSON","toJSON","jsonParse","parse","trycatch","successHandler","errorHandler","flush","isCalled","isError","isSuccess","res","error","addPossiblyUnhandledPromise","promise","possiblyUnhandledPromises","possiblyUnhandledPromiseTimeout","flushPossiblyUnhandledPromises","promises","_loop","silentReject","handlers","onError","dispatchError","dispatch","dispatchedErrors","j","possiblyUnhandledPromiseHandlers","isPromise","Window","then","Function","patchPromise","SyncPromise","resolved","rejected","self","resolve","reject","asyncReject","_this","_loop2","shift","onSuccess","all","count","_loop3","prom","onPossiblyUnhandledException","delay","hash","_loop4","promisifyCall","needsBridgeForBrowser","CONFIG","ALLOW_POSTMESSAGE_POPUP","needsBridgeForWin","needsBridgeForDomain","needsBridge","getBridgeName","sanitizedDomain","id","BRIDGE_NAME_PREFIX","isBridge","registerRemoteWindow","BRIDGE_TIMEOUT","remoteWindows","sendMessagePromise","findRemoteWindow","registerRemoteSendMessage","sendMessage","remoteWindow","sendMessageWrapper","remoteWin","remoteDomain","matchDomain","rejectRemoteSendMessage","sendBridgeMessage","messagingChild","messagingParent","documentBodyReady","document","body","setInterval","clearInterval","receiveMessage","_bridge","_child","_common","_parent","log","LOG_LEVELS","bind","console","clearLogs","clear","LOG_TO_PAGE","container","getElementById","parentNode","removeChild","writeToPage","level","createElement","style","cssText","appendChild","el","date","Date","payload","json","e","msg","innerHTML","color","warn","info","debug","childNodes","insertBefore","logLevel","LOG_LEVEL","unshift","pathname","toLowerCase","_ie","POST_MESSAGE_TYPE","REQUEST","RESPONSE","ACK","POST_MESSAGE_ACK","SUCCESS","ERROR","POST_MESSAGE_NAMES","METHOD","READY","OPEN_TUNNEL","SERIALIZATION_TYPES","SEND_STRATEGIES","POST_MESSAGE","BRIDGE","GLOBAL","POSTROBOT_PROXY","WILDCARD","POST_MESSAGE_NAMES_LIST","resetListeners","responseListeners","requestListeners","addResponseListener","listener","getResponseListener","deleteResponseListener","getRequestListener","qualifiers","nameListeners","_arr","WINDOW_WILDCARD","_i","winQualifier","winListeners","_arr2","domainQualifier","__DOMAIN_REGEX__","regex","addRequestListener","existingListener","strDomain","regexListeners","regexListener","splice","_defineProperty","writable","buildMessage","options","type","sourceDomain","_extends","windowType","run","data","serializeMethods","ack","MOCK_MODE","target","postMessage","origin","messages","serializedMessage","_strategies","SEND_MESSAGE_STRATEGIES","strategyName","ALLOWED_POST_MESSAGE_METHODS","stack","success","status","assign","nextTick","_arguments","nodeify","deNodeify","_len","_key","concat","items","queue","tickMessageName","isWindow","windows","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","props","descriptor","protoProps","staticProps","counter","now","safeSet","entry","safeDelete","safeHas","index","cleanTunnelWindows","tunnelWindows","tunnelWindow","addTunnelWindow","tunnelWindowId","getTunnelWindow","openTunnelToParent","parentWindow","send","canary","awaitRemoteBridgeForWindow","bridge","openBridge","linkUrl","destroyBridges","listenForRegister","on","popupWindowsByName","winDetails","openBridgeFrame","iframe","setAttribute","src","bridges","contentWindow","onload","onerror","onWindowReady","winOptions","popupWindowsByWin","_slicedToArray","sliceIterator","arr","_n","_d","_e","_s","windowOpen","open","last","_url$split","_url$split2","winName","emulateIERestrictions","sourceWindow","targetWindow","_ALLOWED_POST_MESSAGE","ACK_TIMEOUT","parseMessage","_types","RECEIVE_MESSAGE_TYPES","receivedMessages","deserializeMethods","messageListener","sourceElement","originalEvent","_RECEIVE_MESSAGE_TYPE","respond","fireAndForget","originalSource","handleError","response","domains","dom","foreignGlobal","isSerialized","__type__","serializeMethod","destination","methods","__id__","__name__","serializeError","__message__","deserializeMethod","wrapper","deserializeError","meth","readyPromises","request","tagName","HTMLElement","hasResult","ackTimeout","remaining","sendToParent","client","enableMockMode","disableMockMode","disable","winutil","_client","_server","windowUtil","requestListener","errorOnClose","myListener","_on"],"mappings":"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","file":"post-robot.ie.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"postRobot\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"postRobot\"] = factory();\n\telse\n\t\troot[\"postRobot\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"postRobot\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"postRobot\"] = factory();\n\telse\n\t\troot[\"postRobot\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 37);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _config = __webpack_require__(27);\n\nObject.keys(_config).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _config[key];\n    }\n  });\n});\n\nvar _constants = __webpack_require__(13);\n\nObject.keys(_constants).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _constants[key];\n    }\n  });\n});\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _promise = __webpack_require__(17);\n\nObject.keys(_promise).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _promise[key];\n    }\n  });\n});\n\nvar _util = __webpack_require__(5);\n\nObject.keys(_util).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _util[key];\n    }\n  });\n});\n\nvar _log = __webpack_require__(11);\n\nObject.keys(_log).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _log[key];\n    }\n  });\n});\n\nvar _windows = __webpack_require__(7);\n\nObject.keys(_windows).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _windows[key];\n    }\n  });\n});\n\nvar _methods = __webpack_require__(31);\n\nObject.keys(_methods).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _methods[key];\n    }\n  });\n});\n\nvar _tick = __webpack_require__(18);\n\nObject.keys(_tick).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _tick[key];\n    }\n  });\n});\n\nvar _ready = __webpack_require__(32);\n\nObject.keys(_ready).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _ready[key];\n    }\n  });\n});\n\nvar _domain = __webpack_require__(16);\n\nObject.keys(_domain).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _domain[key];\n    }\n  });\n});\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.global = undefined;\n\nvar _conf = __webpack_require__(0);\n\nvar global = exports.global = window[_conf.CONSTANTS.WINDOW_PROPS.POSTROBOT] = window[_conf.CONSTANTS.WINDOW_PROPS.POSTROBOT] || {};\n\n// Backwards compatibility\n\nglobal.registerSelf = function () {\n    // pass\n};\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _interface = __webpack_require__(19);\n\nObject.keys(_interface).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _interface[key];\n    }\n  });\n});\n\nvar INTERFACE = _interopRequireWildcard(_interface);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nexports['default'] = INTERFACE;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _receive = __webpack_require__(28);\n\nObject.keys(_receive).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _receive[key];\n    }\n  });\n});\n\nvar _send = __webpack_require__(15);\n\nObject.keys(_send).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _send[key];\n    }\n  });\n});\n\nvar _listeners = __webpack_require__(14);\n\nObject.keys(_listeners).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _listeners[key];\n    }\n  });\n});\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.util = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.isRegex = isRegex;\nexports.weakMapMemoize = weakMapMemoize;\n\nvar _src = __webpack_require__(3);\n\nvar _conf = __webpack_require__(0);\n\nvar util = exports.util = {\n    once: function once(method) {\n        if (!method) {\n            return method;\n        }\n        var called = false;\n        return function onceWrapper() {\n            if (!called) {\n                called = true;\n                return method.apply(this, arguments);\n            }\n        };\n    },\n    noop: function noop() {},\n    // eslint-disable-line no-empty-function\n\n    safeHasProp: function safeHasProp(obj, name) {\n        try {\n            if (obj[name]) {\n                return true;\n            } else {\n                return false;\n            }\n        } catch (err) {\n            return false;\n        }\n    },\n    safeGetProp: function safeGetProp(obj, name) {\n        try {\n            return obj[name];\n        } catch (err) {\n            return;\n        }\n    },\n    listen: function listen(win, event, handler) {\n        if (win.addEventListener) {\n            win.addEventListener(event, handler);\n        } else {\n            win.attachEvent('on' + event, handler);\n        }\n\n        return {\n            cancel: function cancel() {\n                if (win.removeEventListener) {\n                    win.removeEventListener(event, handler);\n                } else {\n                    win.detachEvent('on' + event, handler);\n                }\n            }\n        };\n    },\n    apply: function apply(method, context, args) {\n        if (typeof method.apply === 'function') {\n            return method.apply(context, args);\n        }\n        return method(args[0], args[1], args[2], args[3], args[4], args[5], args[6], args[7], args[8], args[9]);\n    },\n    find: function find(collection, method, def) {\n        if (!collection) {\n            return def;\n        }\n        for (var i = 0; i < collection.length; i++) {\n            if (method(collection[i])) {\n                return collection[i];\n            }\n        }\n        return def;\n    },\n    map: function map(collection, method) {\n        var results = [];\n        for (var i = 0; i < collection.length; i++) {\n            results.push(method(collection[i]));\n        }\n        return results;\n    },\n    some: function some(collection, method) {\n        method = method || Boolean;\n        for (var i = 0; i < collection.length; i++) {\n            if (method(collection[i])) {\n                return true;\n            }\n        }\n        return false;\n    },\n    keys: function keys(mapping) {\n        var result = [];\n        for (var key in mapping) {\n            if (mapping.hasOwnProperty(key)) {\n                result.push(key);\n            }\n        }\n        return result;\n    },\n    values: function values(mapping) {\n        var result = [];\n        for (var key in mapping) {\n            if (mapping.hasOwnProperty(key)) {\n                result.push(mapping[key]);\n            }\n        }\n        return result;\n    },\n    getByValue: function getByValue(mapping, value) {\n        for (var key in mapping) {\n            if (mapping.hasOwnProperty(key) && mapping[key] === value) {\n                return key;\n            }\n        }\n    },\n    uniqueID: function uniqueID() {\n\n        var chars = '0123456789abcdef';\n\n        return 'xxxxxxxxxx'.replace(/./g, function () {\n            return chars.charAt(Math.floor(Math.random() * chars.length));\n        });\n    },\n    memoize: function memoize(method) {\n\n        var results = {};\n\n        return function memoized() {\n            var args = JSON.stringify(Array.prototype.slice.call(arguments));\n            if (!results.hasOwnProperty(args)) {\n                results[args] = method.apply(this, arguments);\n            }\n            return results[args];\n        };\n    },\n    extend: function extend(obj, source) {\n        if (!source) {\n            return obj;\n        }\n\n        for (var key in source) {\n            if (source.hasOwnProperty(key)) {\n                obj[key] = source[key];\n            }\n        }\n\n        return obj;\n    },\n    each: function each(obj, callback) {\n        if (Array.isArray(obj)) {\n            for (var i = 0; i < obj.length; i++) {\n                callback(obj[i], i);\n            }\n        } else if ((typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) === 'object' && obj !== null) {\n            for (var key in obj) {\n                if (obj.hasOwnProperty(key)) {\n                    callback(obj[key], key);\n                }\n            }\n        }\n    },\n    replaceObject: function replaceObject(obj, callback) {\n        var depth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\n\n        if (depth >= 100) {\n            throw new Error('Self-referential object passed, or object contained too many layers');\n        }\n\n        var newobj = Array.isArray(obj) ? [] : {};\n\n        util.each(obj, function (item, key) {\n\n            var result = callback(item, key);\n\n            if (result !== undefined) {\n                newobj[key] = result;\n            } else if ((typeof item === 'undefined' ? 'undefined' : _typeof(item)) === 'object' && item !== null) {\n                newobj[key] = util.replaceObject(item, callback, depth + 1);\n            } else {\n                newobj[key] = item;\n            }\n        });\n\n        return newobj;\n    },\n    safeInterval: function safeInterval(method, time) {\n        var timeout = void 0;\n\n        function runInterval() {\n            timeout = setTimeout(runInterval, time);\n            method.call();\n        }\n\n        timeout = setTimeout(runInterval, time);\n\n        return {\n            cancel: function cancel() {\n                clearTimeout(timeout);\n            }\n        };\n    },\n    intervalTimeout: function intervalTimeout(time, interval, method) {\n\n        var safeInterval = util.safeInterval(function () {\n            time -= interval;\n\n            time = time <= 0 ? 0 : time;\n\n            if (time === 0) {\n                safeInterval.cancel();\n            }\n\n            method(time);\n        }, interval);\n\n        return safeInterval;\n    },\n    getActualDomain: function getActualDomain(win) {\n        return win.location.protocol + '//' + win.location.host;\n    },\n    getDomain: function getDomain(win) {\n\n        win = win || window;\n\n        if (win.mockDomain && win.mockDomain.indexOf(_conf.CONSTANTS.MOCK_PROTOCOL) === 0) {\n            return win.mockDomain;\n        }\n\n        if (!win.location.protocol) {\n            throw new Error('Can not read window protocol');\n        }\n\n        if (win.location.protocol === _conf.CONSTANTS.FILE_PROTOCOL) {\n            return util.getActualDomain(win);\n        }\n\n        if (!win.location.host) {\n            throw new Error('Can not read window host');\n        }\n\n        return util.getActualDomain(win);\n    },\n    getDomainFromUrl: function getDomainFromUrl(url) {\n\n        var domain = void 0;\n\n        if (url.match(/^(https?|mock|file):\\/\\//)) {\n            domain = url;\n        } else {\n            return this.getDomain();\n        }\n\n        domain = domain.split('/').slice(0, 3).join('/');\n\n        return domain;\n    },\n    safeGet: function safeGet(obj, prop) {\n\n        var result = void 0;\n\n        try {\n            result = obj[prop];\n        } catch (err) {\n            // pass\n        }\n\n        return result;\n    }\n};\n\nfunction isRegex(item) {\n    return Object.prototype.toString.call(item) === '[object RegExp]';\n}\n\nfunction weakMapMemoize(method) {\n\n    var map = new _src.WeakMap();\n\n    return function (arg) {\n        var result = map.get(arg);\n\n        if (typeof result !== 'undefined') {\n            return result;\n        }\n\n        result = method.call(this, arg);\n\n        if (typeof result !== 'undefined') {\n            map.set(arg, result);\n        }\n\n        return result;\n    };\n}\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Promise = undefined;\nexports.init = init;\n\nvar _public = __webpack_require__(35);\n\nObject.keys(_public).forEach(function (key) {\n    if (key === \"default\" || key === \"__esModule\") return;\n    Object.defineProperty(exports, key, {\n        enumerable: true,\n        get: function get() {\n            return _public[key];\n        }\n    });\n});\n\nvar _lib = __webpack_require__(1);\n\nObject.defineProperty(exports, 'Promise', {\n    enumerable: true,\n    get: function get() {\n        return _lib.Promise;\n    }\n});\n\nvar _drivers = __webpack_require__(4);\n\nvar _global = __webpack_require__(2);\n\nfunction init() {\n\n    if (!_global.global.initialized) {\n        (0, _drivers.listenForMessages)();\n\n        if (true) {\n            __webpack_require__(10).openTunnelToOpener();\n        }\n\n        (0, _lib.initOnReady)();\n        (0, _lib.listenForMethods)();\n    }\n\n    _global.global.initialized = true;\n}\n\ninit();\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.isSameDomain = isSameDomain;\nexports.isActuallySameDomain = isActuallySameDomain;\nexports.getOpener = getOpener;\nexports.getParent = getParent;\nexports.getParents = getParents;\nexports.isAncestorParent = isAncestorParent;\nexports.getFrames = getFrames;\nexports.getAllChildFrames = getAllChildFrames;\nexports.getAllFramesInWindow = getAllFramesInWindow;\nexports.getTop = getTop;\nexports.isWindowClosed = isWindowClosed;\nexports.getUserAgent = getUserAgent;\nexports.getFrameByName = getFrameByName;\nexports.findChildFrameByName = findChildFrameByName;\nexports.findFrameByName = findFrameByName;\nexports.isParent = isParent;\nexports.isOpener = isOpener;\nexports.getAncestor = getAncestor;\nexports.getAncestors = getAncestors;\nexports.isAncestor = isAncestor;\nexports.isPopup = isPopup;\nexports.isIframe = isIframe;\nexports.isFullpage = isFullpage;\nexports.getWindowType = getWindowType;\nexports.isSameTopWindow = isSameTopWindow;\nexports.jsonStringify = jsonStringify;\nexports.jsonParse = jsonParse;\n\nvar _src = __webpack_require__(3);\n\nvar _util = __webpack_require__(5);\n\nvar _global = __webpack_require__(2);\n\nvar _conf = __webpack_require__(0);\n\n_global.global.domainMatches = _global.global.domainMatches || new _src.WeakMap();\n\nvar domainMatchTimeout = void 0;\n\nfunction isSameDomain(win) {\n\n    if (_global.global.domainMatches.has(win)) {\n        return _global.global.domainMatches.get(win);\n    }\n\n    var match = void 0;\n\n    try {\n        if (_util.util.getDomain(window) === _util.util.getDomain(win)) {\n            match = true;\n        } else {\n            match = false;\n        }\n    } catch (err) {\n        match = false;\n    }\n\n    _global.global.domainMatches.set(win, match);\n\n    if (!domainMatchTimeout) {\n        domainMatchTimeout = setTimeout(function () {\n            _global.global.domainMatches = new _src.WeakMap();\n            domainMatchTimeout = null;\n        }, 1);\n    }\n\n    return match;\n}\n\nfunction isActuallySameDomain(win) {\n\n    try {\n        if (win && win.location && win.location.href) {\n            return true;\n        }\n    } catch (err) {\n        _global.global.domainMatches.push({ win: win, match: false });\n        return false;\n    }\n\n    return true;\n}\n\nfunction getOpener(win) {\n\n    if (!win) {\n        return;\n    }\n\n    try {\n        return win.opener;\n    } catch (err) {\n        return;\n    }\n}\n\nfunction getParent(win) {\n\n    if (!win) {\n        return;\n    }\n\n    try {\n        if (win.parent && win.parent !== win) {\n            return win.parent;\n        }\n    } catch (err) {\n        return;\n    }\n}\n\nfunction getParents(win) {\n\n    var result = [];\n\n    try {\n\n        while (win.parent !== win) {\n            result.push(win.parent);\n            win = win.parent;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    return result;\n}\n\nfunction isAncestorParent(parent, child) {\n\n    if (!parent || !child) {\n        return false;\n    }\n\n    var childParent = getParent(child);\n\n    if (childParent) {\n        return childParent === parent;\n    }\n\n    if (getParents(child).indexOf(parent) !== -1) {\n        return true;\n    }\n\n    return false;\n}\n\nfunction getFrames(win) {\n\n    var result = [];\n\n    var frames = void 0;\n\n    try {\n        frames = win.frames;\n    } catch (err) {\n        frames = win;\n    }\n\n    var len = void 0;\n\n    try {\n        len = frames.length;\n    } catch (err) {\n        // pass\n    }\n\n    if (len === 0) {\n        return result;\n    }\n\n    if (len) {\n        for (var i = 0; i < len; i++) {\n\n            var frame = void 0;\n\n            try {\n                frame = frames[i];\n            } catch (err) {\n                continue;\n            }\n\n            result.push(frame);\n        }\n\n        return result;\n    }\n\n    for (var _i = 0; _i < 100; _i++) {\n        var _frame = void 0;\n\n        try {\n            _frame = frames[_i];\n        } catch (err) {\n            return result;\n        }\n\n        if (!_frame) {\n            return result;\n        }\n\n        result.push(_frame);\n    }\n\n    return result;\n}\n\nfunction getAllChildFrames(win) {\n\n    var result = [];\n\n    for (var _iterator = getFrames(win), _isArray = Array.isArray(_iterator), _i2 = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n        var _ref;\n\n        if (_isArray) {\n            if (_i2 >= _iterator.length) break;\n            _ref = _iterator[_i2++];\n        } else {\n            _i2 = _iterator.next();\n            if (_i2.done) break;\n            _ref = _i2.value;\n        }\n\n        var frame = _ref;\n\n        result.push(frame);\n\n        for (var _iterator2 = getAllChildFrames(frame), _isArray2 = Array.isArray(_iterator2), _i3 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {\n            var _ref2;\n\n            if (_isArray2) {\n                if (_i3 >= _iterator2.length) break;\n                _ref2 = _iterator2[_i3++];\n            } else {\n                _i3 = _iterator2.next();\n                if (_i3.done) break;\n                _ref2 = _i3.value;\n            }\n\n            var childFrame = _ref2;\n\n            result.push(childFrame);\n        }\n    }\n\n    return result;\n}\n\nfunction getAllFramesInWindow(win) {\n\n    var result = getAllChildFrames(win);\n\n    result.push(win);\n\n    for (var _iterator3 = getParents(win), _isArray3 = Array.isArray(_iterator3), _i4 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {\n        var _ref3;\n\n        if (_isArray3) {\n            if (_i4 >= _iterator3.length) break;\n            _ref3 = _iterator3[_i4++];\n        } else {\n            _i4 = _iterator3.next();\n            if (_i4.done) break;\n            _ref3 = _i4.value;\n        }\n\n        var parent = _ref3;\n\n\n        result.push(parent);\n\n        for (var _iterator4 = getFrames(parent), _isArray4 = Array.isArray(_iterator4), _i5 = 0, _iterator4 = _isArray4 ? _iterator4 : _iterator4[Symbol.iterator]();;) {\n            var _ref4;\n\n            if (_isArray4) {\n                if (_i5 >= _iterator4.length) break;\n                _ref4 = _iterator4[_i5++];\n            } else {\n                _i5 = _iterator4.next();\n                if (_i5.done) break;\n                _ref4 = _i5.value;\n            }\n\n            var frame = _ref4;\n\n\n            if (result.indexOf(frame) === -1) {\n                result.push(frame);\n            }\n        }\n    }\n\n    return result;\n}\n\nfunction getTop(win) {\n\n    if (!win) {\n        return;\n    }\n\n    try {\n        if (win.top) {\n            return win.top;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    if (getParent(win) === win) {\n        return win;\n    }\n\n    try {\n        if (isAncestorParent(window, win)) {\n            return window.top;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    try {\n        if (isAncestorParent(win, window)) {\n            return window.top;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    for (var _iterator5 = getAllChildFrames(win), _isArray5 = Array.isArray(_iterator5), _i6 = 0, _iterator5 = _isArray5 ? _iterator5 : _iterator5[Symbol.iterator]();;) {\n        var _ref5;\n\n        if (_isArray5) {\n            if (_i6 >= _iterator5.length) break;\n            _ref5 = _iterator5[_i6++];\n        } else {\n            _i6 = _iterator5.next();\n            if (_i6.done) break;\n            _ref5 = _i6.value;\n        }\n\n        var frame = _ref5;\n\n        try {\n            if (frame.top) {\n                return frame.top;\n            }\n        } catch (err) {\n            // pass\n        }\n\n        if (getParent(frame) === frame) {\n            return frame;\n        }\n    }\n}\n\nfunction isWindowClosed(win) {\n    var allowMock = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n\n    try {\n        if (win === window) {\n            return false;\n        }\n    } catch (err) {\n        return true;\n    }\n\n    try {\n        if (!win) {\n            return true;\n        }\n    } catch (err) {\n        return true;\n    }\n\n    try {\n        if (win.closed) {\n            return true;\n        }\n    } catch (err) {\n\n        // I love you so much IE\n\n        if (err && err.message === 'Call was rejected by callee.\\r\\n') {\n            return false;\n        }\n\n        return true;\n    }\n\n    if (allowMock && isSameDomain(win) && _util.util.safeGet(win, 'mockclosed')) {\n        return true;\n    }\n\n    /*\n     // IE9... don't even ask. If an iframe is removed from the parent page, .closed does not get set to true\n     try {\n        if (win.parent === win && !getOpener(win) && win !== getTop(window)) {\n            // return true;\n        }\n    } catch (err) {\n        // pass\n    }\n     */\n\n    return false;\n}\n\nfunction getUserAgent(win) {\n    win = win || window;\n    return win.navigator.mockUserAgent || win.navigator.userAgent;\n}\n\nfunction getFrameByName(win, name) {\n\n    var winFrames = getFrames(win);\n\n    for (var _iterator6 = winFrames, _isArray6 = Array.isArray(_iterator6), _i7 = 0, _iterator6 = _isArray6 ? _iterator6 : _iterator6[Symbol.iterator]();;) {\n        var _ref6;\n\n        if (_isArray6) {\n            if (_i7 >= _iterator6.length) break;\n            _ref6 = _iterator6[_i7++];\n        } else {\n            _i7 = _iterator6.next();\n            if (_i7.done) break;\n            _ref6 = _i7.value;\n        }\n\n        var childFrame = _ref6;\n\n        try {\n            if (isSameDomain(childFrame) && childFrame.name === name && winFrames.indexOf(childFrame) !== -1) {\n                return childFrame;\n            }\n        } catch (err) {\n            // pass\n        }\n    }\n\n    try {\n        if (winFrames.indexOf(win.frames[name]) !== -1) {\n            return win.frames[name];\n        }\n    } catch (err) {\n        // pass\n    }\n\n    try {\n        if (winFrames.indexOf(win[name]) !== -1) {\n            return win[name];\n        }\n    } catch (err) {\n        // pass\n    }\n}\n\nfunction findChildFrameByName(win, name) {\n\n    var frame = getFrameByName(win, name);\n\n    if (frame) {\n        return frame;\n    }\n\n    for (var _iterator7 = getFrames(win), _isArray7 = Array.isArray(_iterator7), _i8 = 0, _iterator7 = _isArray7 ? _iterator7 : _iterator7[Symbol.iterator]();;) {\n        var _ref7;\n\n        if (_isArray7) {\n            if (_i8 >= _iterator7.length) break;\n            _ref7 = _iterator7[_i8++];\n        } else {\n            _i8 = _iterator7.next();\n            if (_i8.done) break;\n            _ref7 = _i8.value;\n        }\n\n        var childFrame = _ref7;\n\n        var namedFrame = findChildFrameByName(childFrame, name);\n\n        if (namedFrame) {\n            return namedFrame;\n        }\n    }\n}\n\nfunction findFrameByName(win, name) {\n\n    var frame = void 0;\n\n    frame = getFrameByName(win, name);\n\n    if (frame) {\n        return frame;\n    }\n\n    return findChildFrameByName(getTop(win), name);\n}\n\nfunction isParent(win, frame) {\n\n    var frameParent = getParent(frame);\n\n    if (frameParent) {\n        return frameParent === win;\n    }\n\n    for (var _iterator8 = getFrames(win), _isArray8 = Array.isArray(_iterator8), _i9 = 0, _iterator8 = _isArray8 ? _iterator8 : _iterator8[Symbol.iterator]();;) {\n        var _ref8;\n\n        if (_isArray8) {\n            if (_i9 >= _iterator8.length) break;\n            _ref8 = _iterator8[_i9++];\n        } else {\n            _i9 = _iterator8.next();\n            if (_i9.done) break;\n            _ref8 = _i9.value;\n        }\n\n        var childFrame = _ref8;\n\n        if (childFrame === frame) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction isOpener(parent, child) {\n\n    return parent === getOpener(child);\n}\n\nfunction getAncestor(win) {\n    win = win || window;\n\n    var opener = getOpener(win);\n\n    if (opener) {\n        return opener;\n    }\n\n    var parent = getParent(win);\n\n    if (parent) {\n        return parent;\n    }\n}\n\nfunction getAncestors(win) {\n\n    var results = [];\n\n    var ancestor = win;\n\n    while (ancestor) {\n        ancestor = getAncestor(ancestor);\n        if (ancestor) {\n            results.push(ancestor);\n        }\n    }\n\n    return results;\n}\n\nfunction isAncestor(parent, child) {\n\n    var actualParent = getAncestor(child);\n\n    if (actualParent) {\n        if (actualParent === parent) {\n            return true;\n        }\n\n        return false;\n    }\n\n    if (child === parent) {\n        return false;\n    }\n\n    if (getTop(child) === child) {\n        return false;\n    }\n\n    for (var _iterator9 = getFrames(parent), _isArray9 = Array.isArray(_iterator9), _i10 = 0, _iterator9 = _isArray9 ? _iterator9 : _iterator9[Symbol.iterator]();;) {\n        var _ref9;\n\n        if (_isArray9) {\n            if (_i10 >= _iterator9.length) break;\n            _ref9 = _iterator9[_i10++];\n        } else {\n            _i10 = _iterator9.next();\n            if (_i10.done) break;\n            _ref9 = _i10.value;\n        }\n\n        var frame = _ref9;\n\n        if (frame === child) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction isPopup() {\n    return Boolean(getOpener(window));\n}\n\nfunction isIframe() {\n    return Boolean(getParent(window));\n}\n\nfunction isFullpage() {\n    return Boolean(!isIframe() && !isPopup());\n}\n\nfunction getWindowType() {\n    if (isPopup()) {\n        return _conf.CONSTANTS.WINDOW_TYPES.POPUP;\n    }\n    if (isIframe()) {\n        return _conf.CONSTANTS.WINDOW_TYPES.IFRAME;\n    }\n    return _conf.CONSTANTS.WINDOW_TYPES.FULLPAGE;\n}\n\nfunction anyMatch(collection1, collection2) {\n\n    for (var _iterator10 = collection1, _isArray10 = Array.isArray(_iterator10), _i11 = 0, _iterator10 = _isArray10 ? _iterator10 : _iterator10[Symbol.iterator]();;) {\n        var _ref10;\n\n        if (_isArray10) {\n            if (_i11 >= _iterator10.length) break;\n            _ref10 = _iterator10[_i11++];\n        } else {\n            _i11 = _iterator10.next();\n            if (_i11.done) break;\n            _ref10 = _i11.value;\n        }\n\n        var item1 = _ref10;\n\n        for (var _iterator11 = collection2, _isArray11 = Array.isArray(_iterator11), _i12 = 0, _iterator11 = _isArray11 ? _iterator11 : _iterator11[Symbol.iterator]();;) {\n            var _ref11;\n\n            if (_isArray11) {\n                if (_i12 >= _iterator11.length) break;\n                _ref11 = _iterator11[_i12++];\n            } else {\n                _i12 = _iterator11.next();\n                if (_i12.done) break;\n                _ref11 = _i12.value;\n            }\n\n            var item2 = _ref11;\n\n            if (item1 === item2) {\n                return true;\n            }\n        }\n    }\n}\n\nfunction isSameTopWindow(win1, win2) {\n\n    var top1 = getTop(win1);\n    var top2 = getTop(win2);\n\n    try {\n        if (top1 && top2) {\n            if (top1 === top2) {\n                return true;\n            }\n\n            return false;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    var allFrames1 = getAllFramesInWindow(win1);\n    var allFrames2 = getAllFramesInWindow(win2);\n\n    if (anyMatch(allFrames1, allFrames2)) {\n        return true;\n    }\n\n    var opener1 = getOpener(top1);\n    var opener2 = getOpener(top2);\n\n    if (opener1 && anyMatch(getAllFramesInWindow(opener1), allFrames2)) {\n        return false;\n    }\n\n    if (opener2 && anyMatch(getAllFramesInWindow(opener2), allFrames1)) {\n        return false;\n    }\n}\n\nfunction jsonStringify() {\n\n    var objectToJSON = void 0;\n    var arrayToJSON = void 0;\n\n    try {\n        if (JSON.stringify({}) !== '{}') {\n            objectToJSON = Object.prototype.toJSON;\n            delete Object.prototype.toJSON;\n        }\n\n        if (JSON.stringify({}) !== '{}') {\n            throw new Error('Can not correctly serialize JSON objects');\n        }\n\n        if (JSON.stringify([]) !== '[]') {\n            arrayToJSON = Array.prototype.toJSON;\n            delete Array.prototype.toJSON;\n        }\n\n        if (JSON.stringify([]) !== '[]') {\n            throw new Error('Can not correctly serialize JSON objects');\n        }\n    } catch (err) {\n        throw new Error('Can not repair JSON.stringify: ' + err.message);\n    }\n\n    var result = JSON.stringify.apply(this, arguments);\n\n    try {\n        if (objectToJSON) {\n            Object.prototype.toJSON = objectToJSON; // eslint-disable-line\n        }\n\n        if (arrayToJSON) {\n            Array.prototype.toJSON = arrayToJSON; // eslint-disable-line\n        }\n    } catch (err) {\n        throw new Error('Can not repair JSON.stringify: ' + err.message);\n    }\n\n    return result;\n}\n\nfunction jsonParse() {\n    return JSON.parse.apply(this, arguments);\n}\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.patchPromise = patchPromise;\n\nfunction trycatch(method, successHandler, errorHandler) {\n\n    var isCalled = false;\n    var isSuccess = false;\n    var isError = false;\n    var err = void 0,\n        res = void 0;\n\n    function flush() {\n        if (isCalled) {\n            if (isError) {\n                return errorHandler(err);\n            } else if (isSuccess) {\n                return successHandler(res);\n            }\n        }\n    }\n\n    try {\n        method(function (result) {\n            res = result;\n            isSuccess = true;\n            flush();\n        }, function (error) {\n            err = error;\n            isError = true;\n            flush();\n        });\n    } catch (error) {\n        return errorHandler(error);\n    }\n\n    isCalled = true;\n    flush();\n}\n\nvar possiblyUnhandledPromiseHandlers = [];\nvar possiblyUnhandledPromises = [];\nvar possiblyUnhandledPromiseTimeout = void 0;\n\nfunction addPossiblyUnhandledPromise(promise) {\n    possiblyUnhandledPromises.push(promise);\n    possiblyUnhandledPromiseTimeout = possiblyUnhandledPromiseTimeout || setTimeout(flushPossiblyUnhandledPromises, 1);\n}\n\nfunction flushPossiblyUnhandledPromises() {\n\n    possiblyUnhandledPromiseTimeout = null;\n    var promises = possiblyUnhandledPromises;\n    possiblyUnhandledPromises = [];\n\n    var _loop = function _loop(i) {\n        var promise = promises[i];\n\n        if (promise.silentReject) {\n            return 'continue';\n        }\n\n        promise.handlers.push({\n            onError: function onError(err) {\n                if (promise.silentReject) {\n                    return;\n                }\n\n                dispatchError(err);\n            }\n        });\n\n        promise.dispatch();\n    };\n\n    for (var i = 0; i < promises.length; i++) {\n        var _ret = _loop(i);\n\n        if (_ret === 'continue') continue;\n    }\n}\n\nvar dispatchedErrors = [];\n\nfunction dispatchError(err) {\n\n    if (dispatchedErrors.indexOf(err) !== -1) {\n        return;\n    }\n\n    dispatchedErrors.push(err);\n\n    setTimeout(function () {\n        throw err;\n    }, 1);\n\n    for (var j = 0; j < possiblyUnhandledPromiseHandlers.length; j++) {\n        possiblyUnhandledPromiseHandlers[j](err);\n    }\n}\n\nvar toString = {}.toString;\n\nfunction isPromise(item) {\n    try {\n        if (!item) {\n            return false;\n        }\n\n        if (window.Window && item instanceof window.Window) {\n            return false;\n        }\n\n        if (window.constructor && item instanceof window.constructor) {\n            return false;\n        }\n\n        if (toString) {\n            var name = toString.call(item);\n\n            if (name === '[object Window]' || name === '[object global]' || name === '[object DOMWindow]') {\n                return false;\n            }\n        }\n\n        if (item && item.then instanceof Function) {\n            return true;\n        }\n    } catch (err) {\n        return false;\n    }\n\n    return false;\n}\n\nvar SyncPromise = exports.SyncPromise = function SyncPromise(handler) {\n\n    this.resolved = false;\n    this.rejected = false;\n\n    this.silentReject = false;\n\n    this.handlers = [];\n\n    addPossiblyUnhandledPromise(this);\n\n    if (!handler) {\n        return;\n    }\n\n    var self = this;\n\n    trycatch(handler, function (res) {\n        return self.resolve(res);\n    }, function (err) {\n        return self.reject(err);\n    });\n};\n\nSyncPromise.resolve = function SyncPromiseResolve(value) {\n\n    if (isPromise(value)) {\n        return value;\n    }\n\n    return new SyncPromise().resolve(value);\n};\n\nSyncPromise.reject = function SyncPromiseResolve(error) {\n    return new SyncPromise().reject(error);\n};\n\nSyncPromise.prototype.resolve = function (result) {\n    if (this.resolved || this.rejected) {\n        return this;\n    }\n\n    if (isPromise(result)) {\n        throw new Error('Can not resolve promise with another promise');\n    }\n\n    this.resolved = true;\n    this.value = result;\n    this.dispatch();\n\n    return this;\n};\n\nSyncPromise.prototype.reject = function (error) {\n    if (this.resolved || this.rejected) {\n        return this;\n    }\n\n    if (isPromise(error)) {\n        throw new Error('Can not reject promise with another promise');\n    }\n\n    this.rejected = true;\n    this.value = error;\n    this.dispatch();\n\n    return this;\n};\n\nSyncPromise.prototype.asyncReject = function (error) {\n    this.silentReject = true;\n    this.reject(error);\n};\n\nSyncPromise.prototype.dispatch = function () {\n    var _this = this;\n\n    if (!this.resolved && !this.rejected) {\n        return;\n    }\n\n    var _loop2 = function _loop2() {\n\n        var handler = _this.handlers.shift();\n\n        var result = void 0,\n            error = void 0;\n\n        try {\n            if (_this.resolved) {\n                result = handler.onSuccess ? handler.onSuccess(_this.value) : _this.value;\n            } else if (_this.rejected) {\n                if (handler.onError) {\n                    result = handler.onError(_this.value);\n                } else {\n                    error = _this.value;\n                }\n            }\n        } catch (err) {\n            error = err;\n        }\n\n        if (result === _this) {\n            throw new Error('Can not return a promise from the the then handler of the same promise');\n        }\n\n        if (!handler.promise) {\n            return 'continue';\n        }\n\n        if (error) {\n            handler.promise.reject(error);\n        } else if (isPromise(result)) {\n            result.then(function (res) {\n                handler.promise.resolve(res);\n            }, function (err) {\n                handler.promise.reject(err);\n            });\n        } else {\n            handler.promise.resolve(result);\n        }\n    };\n\n    while (this.handlers.length) {\n        var _ret2 = _loop2();\n\n        if (_ret2 === 'continue') continue;\n    }\n};\n\nSyncPromise.prototype.then = function (onSuccess, onError) {\n\n    if (onSuccess && typeof onSuccess !== 'function' && !onSuccess.call) {\n        throw new Error('Promise.then expected a function for success handler');\n    }\n\n    if (onError && typeof onError !== 'function' && !onError.call) {\n        throw new Error('Promise.then expected a function for error handler');\n    }\n\n    var promise = new SyncPromise(null, this);\n\n    this.handlers.push({\n        promise: promise,\n        onSuccess: onSuccess,\n        onError: onError\n    });\n\n    this.silentReject = true;\n\n    this.dispatch();\n\n    return promise;\n};\n\nSyncPromise.prototype['catch'] = function (onError) {\n    return this.then(null, onError);\n};\n\nSyncPromise.prototype['finally'] = function (handler) {\n    return this.then(function (result) {\n        return SyncPromise['try'](handler).then(function () {\n            return result;\n        });\n    }, function (err) {\n        return SyncPromise['try'](handler).then(function () {\n            throw err;\n        });\n    });\n};\n\nSyncPromise.all = function (promises) {\n\n    var promise = new SyncPromise();\n    var count = promises.length;\n    var results = [];\n\n    var _loop3 = function _loop3(i) {\n\n        var prom = isPromise(promises[i]) ? promises[i] : SyncPromise.resolve(promises[i]);\n\n        prom.then(function (result) {\n            results[i] = result;\n            count -= 1;\n            if (count === 0) {\n                promise.resolve(results);\n            }\n        }, function (err) {\n            promise.reject(err);\n        });\n    };\n\n    for (var i = 0; i < promises.length; i++) {\n        _loop3(i);\n    }\n\n    if (!count) {\n        promise.resolve(results);\n    }\n\n    return promise;\n};\n\nSyncPromise.onPossiblyUnhandledException = function syncPromiseOnPossiblyUnhandledException(handler) {\n    possiblyUnhandledPromiseHandlers.push(handler);\n};\n\nSyncPromise['try'] = function syncPromiseTry(method) {\n    return SyncPromise.resolve().then(method);\n};\n\nSyncPromise.delay = function syncPromiseDelay(delay) {\n    return new SyncPromise(function (resolve) {\n        setTimeout(resolve, delay);\n    });\n};\n\nSyncPromise.hash = function (obj) {\n\n    var results = {};\n    var promises = [];\n\n    var _loop4 = function _loop4(key) {\n        if (obj.hasOwnProperty(key)) {\n            promises.push(SyncPromise.resolve(obj[key]).then(function (result) {\n                results[key] = result;\n            }));\n        }\n    };\n\n    for (var key in obj) {\n        _loop4(key);\n    }\n\n    return SyncPromise.all(promises).then(function () {\n        return results;\n    });\n};\n\nSyncPromise.promisifyCall = function () {\n\n    var args = Array.prototype.slice.call(arguments);\n    var method = args.shift();\n\n    if (typeof method !== 'function') {\n        throw new Error('Expected promisifyCall to be called with a function');\n    }\n\n    return new SyncPromise(function (resolve, reject) {\n\n        args.push(function (err, result) {\n            return err ? reject(err) : resolve(result);\n        });\n\n        return method.apply(null, args);\n    });\n};\n\nfunction patchPromise() {\n    window.Promise = SyncPromise;\n}\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.documentBodyReady = undefined;\nexports.needsBridgeForBrowser = needsBridgeForBrowser;\nexports.needsBridgeForWin = needsBridgeForWin;\nexports.needsBridgeForDomain = needsBridgeForDomain;\nexports.needsBridge = needsBridge;\nexports.getBridgeName = getBridgeName;\nexports.isBridge = isBridge;\nexports.registerRemoteWindow = registerRemoteWindow;\nexports.findRemoteWindow = findRemoteWindow;\nexports.registerRemoteSendMessage = registerRemoteSendMessage;\nexports.rejectRemoteSendMessage = rejectRemoteSendMessage;\nexports.sendBridgeMessage = sendBridgeMessage;\n\nvar _src = __webpack_require__(3);\n\nvar _conf = __webpack_require__(0);\n\nvar _lib = __webpack_require__(1);\n\nvar _global = __webpack_require__(2);\n\nvar _drivers = __webpack_require__(4);\n\nfunction needsBridgeForBrowser() {\n\n    if ((0, _lib.getUserAgent)(window).match(/MSIE|trident|edge/i)) {\n        return true;\n    }\n\n    if (!_conf.CONFIG.ALLOW_POSTMESSAGE_POPUP) {\n        return true;\n    }\n\n    return false;\n}\n\nfunction needsBridgeForWin(win) {\n\n    if (win && (0, _lib.isSameTopWindow)(window, win)) {\n        return false;\n    }\n\n    if (win && (0, _lib.isSameDomain)(win)) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction needsBridgeForDomain(domain) {\n\n    if (domain && _lib.util.getDomain() === _lib.util.getDomainFromUrl(domain)) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction needsBridge(_ref) {\n    var win = _ref.win,\n        domain = _ref.domain;\n\n    return needsBridgeForBrowser() && needsBridgeForWin(win) && needsBridgeForDomain(domain);\n}\n\nfunction getBridgeName(domain) {\n\n    domain = domain || _lib.util.getDomainFromUrl(domain);\n\n    var sanitizedDomain = domain.replace(/[^a-zA-Z0-9]+/g, '_');\n\n    var id = _conf.CONSTANTS.BRIDGE_NAME_PREFIX + '_' + sanitizedDomain;\n\n    return id;\n}\n\nfunction isBridge() {\n    return window.name && window.name === getBridgeName(_lib.util.getDomain());\n}\n\nvar documentBodyReady = exports.documentBodyReady = new _lib.promise.Promise(function (resolve) {\n\n    if (window.document && window.document.body) {\n        return resolve(window.document.body);\n    }\n\n    var interval = setInterval(function () {\n        if (window.document && window.document.body) {\n            clearInterval(interval);\n            return resolve(window.document.body);\n        }\n    }, 10);\n});\n\n_global.global.remoteWindows = _global.global.remoteWindows || new _src.WeakMap();\n\nfunction registerRemoteWindow(win) {\n    var timeout = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _conf.CONFIG.BRIDGE_TIMEOUT;\n\n    _global.global.remoteWindows.set(win, { sendMessagePromise: new _lib.promise.Promise() });\n}\n\nfunction findRemoteWindow(win) {\n    return _global.global.remoteWindows.get(win);\n}\n\nfunction registerRemoteSendMessage(win, domain, sendMessage) {\n\n    var remoteWindow = findRemoteWindow(win);\n\n    if (!remoteWindow) {\n        throw new Error('Window not found to register sendMessage to');\n    }\n\n    var sendMessageWrapper = function sendMessageWrapper(remoteWin, message, remoteDomain) {\n\n        if (remoteWin !== win) {\n            throw new Error('Remote window does not match window');\n        }\n\n        if (!(0, _lib.matchDomain)(remoteDomain, domain)) {\n            throw new Error('Remote domain ' + remoteDomain + ' does not match domain ' + domain);\n        }\n\n        sendMessage(message);\n    };\n\n    remoteWindow.sendMessagePromise.resolve(sendMessageWrapper);\n    remoteWindow.sendMessagePromise = _lib.promise.Promise.resolve(sendMessageWrapper);\n}\n\nfunction rejectRemoteSendMessage(win, err) {\n\n    var remoteWindow = findRemoteWindow(win);\n\n    if (!remoteWindow) {\n        throw new Error('Window not found on which to reject sendMessage');\n    }\n\n    remoteWindow.sendMessagePromise.asyncReject(err);\n}\n\nfunction sendBridgeMessage(win, message, domain) {\n\n    var messagingChild = (0, _lib.isOpener)(window, win);\n    var messagingParent = (0, _lib.isOpener)(win, window);\n\n    if (!messagingChild && !messagingParent) {\n        throw new Error('Can only send messages to and from parent and popup windows');\n    }\n\n    var remoteWindow = findRemoteWindow(win);\n\n    if (!remoteWindow) {\n        throw new Error('Window not found to send message to');\n    }\n\n    return remoteWindow.sendMessagePromise.then(function (sendMessage) {\n        return sendMessage(win, message, domain);\n    });\n}\n\n_global.global.receiveMessage = function (event) {\n    return (0, _drivers.receiveMessage)(event);\n};\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _bridge = __webpack_require__(22);\n\nObject.keys(_bridge).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _bridge[key];\n    }\n  });\n});\n\nvar _child = __webpack_require__(23);\n\nObject.keys(_child).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _child[key];\n    }\n  });\n});\n\nvar _common = __webpack_require__(9);\n\nObject.keys(_common).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _common[key];\n    }\n  });\n});\n\nvar _parent = __webpack_require__(25);\n\nObject.keys(_parent).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _parent[key];\n    }\n  });\n});\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.log = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _util = __webpack_require__(5);\n\nvar _windows = __webpack_require__(7);\n\nvar _conf = __webpack_require__(0);\n\nvar LOG_LEVELS = ['debug', 'info', 'warn', 'error'];\n\nif (Function.prototype.bind && window.console && _typeof(console.log) === 'object') {\n    ['log', 'info', 'warn', 'error'].forEach(function (method) {\n        console[method] = this.bind(console[method], console);\n    }, Function.prototype.call);\n}\n\nvar log = exports.log = {\n    clearLogs: function clearLogs() {\n\n        if (window.console && window.console.clear) {\n            window.console.clear();\n        }\n\n        if (_conf.CONFIG.LOG_TO_PAGE) {\n            var container = document.getElementById('postRobotLogs');\n\n            if (container) {\n                container.parentNode.removeChild(container);\n            }\n        }\n    },\n    writeToPage: function writeToPage(level, args) {\n        setTimeout(function () {\n            var container = document.getElementById('postRobotLogs');\n\n            if (!container) {\n                container = document.createElement('div');\n                container.id = 'postRobotLogs';\n                container.style.cssText = 'width: 800px; font-family: monospace; white-space: pre-wrap;';\n                document.body.appendChild(container);\n            }\n\n            var el = document.createElement('div');\n\n            var date = new Date().toString().split(' ')[4];\n\n            var payload = _util.util.map(args, function (item) {\n                if (typeof item === 'string') {\n                    return item;\n                }\n                if (!item) {\n                    return Object.prototype.toString.call(item);\n                }\n                var json = void 0;\n                try {\n                    json = (0, _windows.jsonStringify)(item, 0, 2);\n                } catch (e) {\n                    json = '[object]';\n                }\n\n                return '\\n\\n' + json + '\\n\\n';\n            }).join(' ');\n\n            var msg = date + ' ' + level + ' ' + payload;\n            el.innerHTML = msg;\n\n            var color = {\n                log: '#ddd',\n                warn: 'orange',\n                error: 'red',\n                info: 'blue',\n                debug: '#aaa'\n            }[level];\n\n            el.style.cssText = 'margin-top: 10px; color: ' + color + ';';\n\n            if (!container.childNodes.length) {\n                container.appendChild(el);\n            } else {\n                container.insertBefore(el, container.childNodes[0]);\n            }\n        });\n    },\n    logLevel: function logLevel(level, args) {\n        setTimeout(function () {\n            try {\n                var logLevel = window.LOG_LEVEL || _conf.CONFIG.LOG_LEVEL;\n\n                if (LOG_LEVELS.indexOf(level) < LOG_LEVELS.indexOf(logLevel)) {\n                    return;\n                }\n\n                args = Array.prototype.slice.call(args);\n\n                args.unshift('' + window.location.host + window.location.pathname);\n                args.unshift('::');\n                args.unshift('' + (0, _windows.getWindowType)().toLowerCase());\n                args.unshift('[post-robot]');\n\n                if (_conf.CONFIG.LOG_TO_PAGE) {\n                    log.writeToPage(level, args);\n                }\n\n                if (!window.console) {\n                    return;\n                }\n\n                if (!window.console[level]) {\n                    level = 'log';\n                }\n\n                if (!window.console[level]) {\n                    return;\n                }\n\n                window.console[level].apply(window.console, args);\n            } catch (err) {\n                // pass\n            }\n        }, 1);\n    },\n    debug: function debug() {\n        log.logLevel('debug', arguments);\n    },\n    info: function info() {\n        log.logLevel('info', arguments);\n    },\n    warn: function warn() {\n        log.logLevel('warn', arguments);\n    },\n    error: function error() {\n        log.logLevel('error', arguments);\n    }\n};\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _ie = __webpack_require__(26);\n\nObject.keys(_ie).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _ie[key];\n    }\n  });\n});\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar CONSTANTS = exports.CONSTANTS = {\n\n    POST_MESSAGE_TYPE: {\n        REQUEST: 'postrobot_message_request',\n        RESPONSE: 'postrobot_message_response',\n        ACK: 'postrobot_message_ack'\n    },\n\n    POST_MESSAGE_ACK: {\n        SUCCESS: 'success',\n        ERROR: 'error'\n    },\n\n    POST_MESSAGE_NAMES: {\n        METHOD: 'postrobot_method',\n        READY: 'postrobot_ready',\n        OPEN_TUNNEL: 'postrobot_open_tunnel'\n    },\n\n    WINDOW_TYPES: {\n        FULLPAGE: 'fullpage',\n        POPUP: 'popup',\n        IFRAME: 'iframe'\n    },\n\n    WINDOW_PROPS: {\n        POSTROBOT: '__postRobot__'\n    },\n\n    SERIALIZATION_TYPES: {\n        METHOD: 'postrobot_method',\n        ERROR: 'postrobot_error'\n    },\n\n    SEND_STRATEGIES: {\n        POST_MESSAGE: 'postrobot_post_message',\n        BRIDGE: 'postrobot_bridge',\n        GLOBAL: 'postrobot_global'\n    },\n\n    MOCK_PROTOCOL: 'mock:',\n    FILE_PROTOCOL: 'file:',\n\n    BRIDGE_NAME_PREFIX: '__postrobot_bridge__',\n    POSTROBOT_PROXY: '__postrobot_proxy__',\n\n    WILDCARD: '*'\n};\n\nvar POST_MESSAGE_NAMES_LIST = exports.POST_MESSAGE_NAMES_LIST = Object.keys(CONSTANTS.POST_MESSAGE_NAMES).map(function (key) {\n    return CONSTANTS.POST_MESSAGE_NAMES[key];\n});\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.resetListeners = resetListeners;\nexports.addResponseListener = addResponseListener;\nexports.getResponseListener = getResponseListener;\nexports.deleteResponseListener = deleteResponseListener;\nexports.getRequestListener = getRequestListener;\nexports.addRequestListener = addRequestListener;\n\nvar _src = __webpack_require__(3);\n\nvar _global = __webpack_require__(2);\n\nvar _lib = __webpack_require__(1);\n\nvar _conf = __webpack_require__(0);\n\nfunction resetListeners() {\n    _global.global.responseListeners = {};\n    _global.global.requestListeners = {};\n}\n\n_global.global.responseListeners = _global.global.responseListeners || {};\n_global.global.requestListeners = _global.global.requestListeners || {};\n_global.global.WINDOW_WILDCARD = _global.global.WINDOW_WILDCARD || new function WindowWildcard() {/* pass */}();\n\nvar __DOMAIN_REGEX__ = '__domain_regex__';\n\nfunction addResponseListener(hash, listener) {\n    _global.global.responseListeners[hash] = listener;\n}\n\nfunction getResponseListener(hash) {\n    return _global.global.responseListeners[hash];\n}\n\nfunction deleteResponseListener(hash) {\n    delete _global.global.responseListeners[hash];\n}\n\nfunction getRequestListener(qualifiers) {\n    var name = qualifiers.name,\n        win = qualifiers.win,\n        domain = qualifiers.domain;\n\n\n    if (win === _conf.CONSTANTS.WILDCARD) {\n        win = null;\n    }\n\n    if (domain === _conf.CONSTANTS.WILDCARD) {\n        domain = null;\n    }\n\n    if (!name) {\n        throw new Error('Name required to get request listener');\n    }\n\n    var nameListeners = _global.global.requestListeners[name];\n\n    if (!nameListeners) {\n        return;\n    }\n\n    var _arr = [win, _global.global.WINDOW_WILDCARD];\n    for (var _i = 0; _i < _arr.length; _i++) {\n        var winQualifier = _arr[_i];\n\n        var winListeners = winQualifier && nameListeners.get(winQualifier);\n\n        if (!winListeners) {\n            continue;\n        }\n\n        var _arr2 = [domain, _conf.CONSTANTS.WILDCARD];\n        for (var _i2 = 0; _i2 < _arr2.length; _i2++) {\n            var domainQualifier = _arr2[_i2];\n\n            if (!domainQualifier) {\n                continue;\n            }\n\n            domainQualifier = domainQualifier.toString();\n\n            if (winListeners[domainQualifier]) {\n                return winListeners[domainQualifier];\n            }\n        }\n\n        if (winListeners[__DOMAIN_REGEX__]) {\n            for (var _iterator = winListeners[__DOMAIN_REGEX__], _isArray = Array.isArray(_iterator), _i3 = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n                var _ref2;\n\n                if (_isArray) {\n                    if (_i3 >= _iterator.length) break;\n                    _ref2 = _iterator[_i3++];\n                } else {\n                    _i3 = _iterator.next();\n                    if (_i3.done) break;\n                    _ref2 = _i3.value;\n                }\n\n                var _ref3 = _ref2;\n                var regex = _ref3.regex,\n                    listener = _ref3.listener;\n\n                if ((0, _lib.matchDomain)(regex, domain)) {\n                    return listener;\n                }\n            }\n        }\n    }\n}\n\nfunction addRequestListener(qualifiers, listener) {\n    var name = qualifiers.name,\n        win = qualifiers.win,\n        domain = qualifiers.domain;\n\n\n    if (!name || typeof name !== 'string') {\n        throw new Error('Name required to add request listener');\n    }\n\n    if (Array.isArray(win)) {\n        for (var _iterator2 = win, _isArray2 = Array.isArray(_iterator2), _i4 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {\n            var _ref4;\n\n            if (_isArray2) {\n                if (_i4 >= _iterator2.length) break;\n                _ref4 = _iterator2[_i4++];\n            } else {\n                _i4 = _iterator2.next();\n                if (_i4.done) break;\n                _ref4 = _i4.value;\n            }\n\n            var item = _ref4;\n\n            addRequestListener({ name: name, domain: domain, win: item }, listener);\n        }\n        return;\n    }\n\n    if (Array.isArray(domain)) {\n        for (var _iterator3 = domain, _isArray3 = Array.isArray(_iterator3), _i5 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {\n            var _ref5;\n\n            if (_isArray3) {\n                if (_i5 >= _iterator3.length) break;\n                _ref5 = _iterator3[_i5++];\n            } else {\n                _i5 = _iterator3.next();\n                if (_i5.done) break;\n                _ref5 = _i5.value;\n            }\n\n            var _item = _ref5;\n\n            addRequestListener({ name: name, win: win, domain: _item }, listener);\n        }\n        return;\n    }\n\n    var existingListener = getRequestListener(qualifiers);\n\n    if (!win || win === _conf.CONSTANTS.WILDCARD) {\n        win = _global.global.WINDOW_WILDCARD;\n    }\n\n    domain = domain || _conf.CONSTANTS.WILDCARD;\n\n    if (existingListener) {\n        if (win && domain) {\n            throw new Error('Request listener already exists for ' + name + ' on domain ' + domain + ' for specified window');\n        } else if (win) {\n            throw new Error('Request listener already exists for ' + name + ' for specified window');\n        } else if (domain) {\n            throw new Error('Request listener already exists for ' + name + ' on domain ' + domain);\n        } else {\n            throw new Error('Request listener already exists for ' + name);\n        }\n    }\n\n    var requestListeners = _global.global.requestListeners;\n\n    var nameListeners = requestListeners[name];\n\n    if (!nameListeners) {\n        nameListeners = new _src.WeakMap();\n        requestListeners[name] = nameListeners;\n    }\n\n    var winListeners = nameListeners.get(win);\n\n    if (!winListeners) {\n        winListeners = {};\n        nameListeners.set(win, winListeners);\n    }\n\n    var strDomain = domain.toString();\n\n    winListeners[strDomain] = listener;\n\n    var regexListeners = winListeners[__DOMAIN_REGEX__];\n    var regexListener = void 0;\n\n    if ((0, _lib.isRegex)(domain)) {\n\n        if (!regexListeners) {\n            regexListeners = [];\n            winListeners[__DOMAIN_REGEX__] = regexListeners;\n        }\n\n        regexListener = { regex: domain, listener: listener };\n\n        regexListeners.push(regexListener);\n    }\n\n    return {\n        cancel: function cancel() {\n            delete winListeners[strDomain];\n\n            if (Object.keys(winListeners).length === 0) {\n                nameListeners['delete'](win);\n            }\n\n            if (regexListener) {\n                regexListeners.splice(regexListeners.indexOf(regexListener, 1));\n            }\n        }\n    };\n}\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.buildMessage = buildMessage;\nexports.sendMessage = sendMessage;\n\nvar _conf = __webpack_require__(0);\n\nvar _lib = __webpack_require__(1);\n\nvar _strategies = __webpack_require__(30);\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction buildMessage(win, message) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\n    var id = _lib.util.uniqueID();\n    var type = (0, _lib.getWindowType)();\n    var sourceDomain = _lib.util.getDomain(window);\n\n    return _extends({}, message, options, {\n        sourceDomain: sourceDomain,\n        id: message.id || id,\n        windowType: type\n    });\n}\n\nfunction sendMessage(win, message, domain) {\n    return _lib.promise.run(function () {\n\n        message = buildMessage(win, message, {\n            data: (0, _lib.serializeMethods)(win, domain, message.data),\n            domain: domain\n        });\n\n        var level = void 0;\n\n        if (_conf.POST_MESSAGE_NAMES_LIST.indexOf(message.name) !== -1 || message.type === _conf.CONSTANTS.POST_MESSAGE_TYPE.ACK) {\n            level = 'debug';\n        } else if (message.ack === 'error') {\n            level = 'error';\n        } else {\n            level = 'info';\n        }\n\n        _lib.log.logLevel(level, ['\\n\\n\\t', '#send', message.type.replace(/^postrobot_message_/, ''), '::', message.name, '::', domain || _conf.CONSTANTS.WILDCARD, '\\n\\n', message]);\n\n        if (_conf.CONFIG.MOCK_MODE) {\n            delete message.target;\n            return window[_conf.CONSTANTS.WINDOW_PROPS.POSTROBOT].postMessage({\n                origin: _lib.util.getDomain(window),\n                source: window,\n                data: (0, _lib.jsonStringify)(message, 0, 2)\n            });\n        }\n\n        if (win === window) {\n            throw new Error('Attemping to send message to self');\n        }\n\n        if ((0, _lib.isWindowClosed)(win)) {\n            throw new Error('Window is closed');\n        }\n\n        _lib.log.debug('Running send message strategies', message);\n\n        var messages = [];\n\n        var serializedMessage = (0, _lib.jsonStringify)(_defineProperty({}, _conf.CONSTANTS.WINDOW_PROPS.POSTROBOT, message), 0, 2);\n\n        return _lib.promise.map(Object.keys(_strategies.SEND_MESSAGE_STRATEGIES), function (strategyName) {\n\n            return _lib.promise.run(function () {\n\n                if (!_conf.CONFIG.ALLOWED_POST_MESSAGE_METHODS[strategyName]) {\n                    throw new Error('Strategy disallowed: ' + strategyName);\n                }\n\n                return _strategies.SEND_MESSAGE_STRATEGIES[strategyName](win, serializedMessage, domain);\n            }).then(function () {\n                messages.push(strategyName + ': success');\n                return true;\n            }, function (err) {\n                messages.push(strategyName + ': ' + (err.stack || err.toString()) + '\\n');\n                return false;\n            });\n        }).then(function (results) {\n\n            var success = _lib.util.some(results);\n            var status = message.type + ' ' + message.name + ' ' + (success ? 'success' : 'error') + ':\\n  - ' + messages.join('\\n  - ') + '\\n';\n\n            _lib.log.debug(status);\n\n            if (!success) {\n                throw new Error(status);\n            }\n        });\n    });\n}\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.matchDomain = matchDomain;\n\nvar _util = __webpack_require__(5);\n\nvar _conf = __webpack_require__(0);\n\nfunction matchDomain(domain, origin) {\n\n    if (typeof domain === 'string') {\n\n        if ((0, _util.isRegex)(origin)) {\n            return false;\n        }\n\n        if (Array.isArray(origin)) {\n            return false;\n        }\n\n        return domain === _conf.CONSTANTS.WILDCARD || origin === domain;\n    }\n\n    if ((0, _util.isRegex)(domain)) {\n\n        if ((0, _util.isRegex)(origin)) {\n            return domain.toString() === origin.toString();\n        }\n\n        if (Array.isArray(origin)) {\n            return false;\n        }\n\n        return origin.match(domain);\n    }\n\n    if (Array.isArray(domain)) {\n\n        if ((0, _util.isRegex)(origin)) {\n            return false;\n        }\n\n        if (Array.isArray(origin)) {\n            return JSON.stringify(domain) === JSON.stringify(origin);\n        }\n\n        return domain.indexOf(origin) !== -1;\n    }\n\n    return false;\n}\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.promise = exports.Promise = undefined;\n\nvar _promise = __webpack_require__(8);\n\nvar _tick = __webpack_require__(18);\n\nvar Promise = exports.Promise = _promise.SyncPromise;\n\nvar promise = exports.promise = {\n\n    Promise: Promise,\n\n    run: function run(method) {\n        return Promise.resolve().then(method);\n    },\n    nextTick: function nextTick(method) {\n        return new Promise(function (resolve, reject) {\n            (0, _tick.nextTick)(function () {\n                return promise.run(method).then(resolve, reject);\n            });\n        });\n    },\n    method: function method(_method) {\n        return function promiseWrapper() {\n            var _this = this,\n                _arguments = arguments;\n\n            return Promise.resolve().then(function () {\n                return _method.apply(_this, _arguments);\n            });\n        };\n    },\n    nodeify: function nodeify(prom, callback) {\n        if (!callback) {\n            return prom;\n        }\n        prom.then(function (result) {\n            callback(null, result);\n        }, function (err) {\n            callback(err);\n        });\n    },\n    deNodeify: function deNodeify(method) {\n        for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n            args[_key - 1] = arguments[_key];\n        }\n\n        return new Promise(function (resolve, reject) {\n            try {\n                if (args.length < method.length) {\n                    return method.apply(undefined, args.concat([function (err, result) {\n                        return err ? reject(err) : resolve(result);\n                    }]));\n                }\n\n                return promise.run(function () {\n                    return method.apply(undefined, args);\n                }).then(resolve, reject);\n            } catch (err) {\n                return reject(err);\n            }\n        });\n    },\n    map: function map(items, method) {\n\n        var results = [];\n\n        var _loop = function _loop(i) {\n            results.push(promise.run(function () {\n                return method(items[i]);\n            }));\n        };\n\n        for (var i = 0; i < items.length; i++) {\n            _loop(i);\n        }\n        return Promise.all(results);\n    }\n};\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.nextTick = nextTick;\n\nvar _util = __webpack_require__(5);\n\nvar _conf = __webpack_require__(0);\n\nvar tickMessageName = '__nextTick__postRobot__' + _util.util.uniqueID();\nvar queue = [];\n\nwindow.addEventListener('message', function (event) {\n    if (event.data === tickMessageName) {\n        var method = queue.shift();\n        method.call();\n    }\n});\n\nfunction nextTick(method) {\n    queue.push(method);\n    window.postMessage(tickMessageName, _conf.CONSTANTS.WILDCARD);\n}\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar WeakMap = exports.WeakMap = void 0;\n\nif (window.WeakMap) {\n    exports.WeakMap = WeakMap = window.WeakMap;\n} else {\n    exports.WeakMap = WeakMap = __webpack_require__(21).WeakMap;\n}\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.isWindow = isWindow;\nvar windows = [];\n\nfunction isWindow(obj) {\n\n    if (windows.indexOf(obj) !== -1) {\n        return true;\n    }\n\n    try {\n        if (obj && obj.self === obj) {\n            windows.push(obj);\n            return true;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    return false;\n}\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.WeakMap = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _util = __webpack_require__(20);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar defineProperty = Object.defineProperty;\nvar counter = Date.now() % 1e9;\n\nvar WeakMap = exports.WeakMap = function () {\n    function WeakMap() {\n        _classCallCheck(this, WeakMap);\n\n        counter += 1;\n        this.name = '__weakmap_' + (Math.random() * 1e9 >>> 0) + '__' + counter; // eslint-disable-line\n        this.keys = [];\n        this.values = [];\n    }\n\n    _createClass(WeakMap, [{\n        key: 'set',\n        value: function set(key, value) {\n\n            if ((0, _util.isWindow)(key)) {\n                return this.safeSet(key, value);\n            }\n\n            var name = this.name;\n            var entry = key[name];\n\n            if (entry && entry[0] === key) {\n                entry[1] = value;\n            } else {\n                defineProperty(key, name, {\n                    value: [key, value],\n                    writable: true\n                });\n            }\n        }\n    }, {\n        key: 'get',\n        value: function get(key) {\n\n            if ((0, _util.isWindow)(key)) {\n                return this.safeGet(key);\n            }\n\n            var entry = key[this.name];\n\n            if (entry && entry[0] === key) {\n                return entry[1];\n            }\n        }\n    }, {\n        key: 'delete',\n        value: function _delete(key) {\n\n            if ((0, _util.isWindow)(key)) {\n                return this.safeDelete(key);\n            }\n\n            var entry = key[this.name];\n\n            if (entry && entry[0] === key) {\n                entry[0] = entry[1] = undefined;\n            }\n        }\n    }, {\n        key: 'has',\n        value: function has(key) {\n\n            if ((0, _util.isWindow)(key)) {\n                return this.safeHas(key);\n            }\n\n            var entry = key[this.name];\n\n            if (entry && entry[0] === key) {\n                return true;\n            }\n\n            return false;\n        }\n    }, {\n        key: 'safeSet',\n        value: function safeSet(key, value) {\n\n            var keys = this.keys;\n            var values = this.values;\n            var index = keys.indexOf(key);\n\n            if (index === -1) {\n                keys.push(key);\n                values.push(value);\n                return;\n            }\n\n            values[index] = value;\n        }\n    }, {\n        key: 'safeGet',\n        value: function safeGet(key) {\n\n            var keys = this.keys;\n            var index = keys.indexOf(key);\n\n            if (index === -1) {\n                return;\n            }\n\n            return this.values[index];\n        }\n    }, {\n        key: 'safeDelete',\n        value: function safeDelete(key) {\n\n            var keys = this.keys;\n            var index = keys.indexOf(key);\n\n            if (index !== -1) {\n                keys.splice(index, 1);\n                this.values.splice(index, 1);\n            }\n        }\n    }, {\n        key: 'safeHas',\n        value: function safeHas(key) {\n\n            return this.keys.indexOf(key) !== -1;\n        }\n    }]);\n\n    return WeakMap;\n}();\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _conf = __webpack_require__(0);\n\nvar _lib = __webpack_require__(1);\n\nvar _global = __webpack_require__(2);\n\nvar _interface = __webpack_require__(6);\n\n/*\n    HERE BE DRAGONS\n\n    Warning: this file may look weird. Why save the tunnel window in an Object\n    by ID, then look it up later, rather than just using the reference from the closure scope?\n\n    The reason is, that ends up meaning the garbage collector can never get its hands\n    on a closed window, since our closure has continued access to it -- and post-robot\n    has no good way to know whether to clean up the function with the closure scope.\n\n    If you're editing this file, be sure to run significant memory / GC tests afterwards.\n*/\n\n_global.global.tunnelWindows = _global.global.tunnelWindows || {};\n_global.global.tunnelWindowId = 0;\n\nfunction cleanTunnelWindows() {\n    var tunnelWindows = _global.global.tunnelWindows;\n\n    for (var _iterator = Object.keys(tunnelWindows), _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n        var _ref;\n\n        if (_isArray) {\n            if (_i >= _iterator.length) break;\n            _ref = _iterator[_i++];\n        } else {\n            _i = _iterator.next();\n            if (_i.done) break;\n            _ref = _i.value;\n        }\n\n        var key = _ref;\n\n        var tunnelWindow = tunnelWindows[key];\n\n        if ((0, _lib.isWindowClosed)(tunnelWindow.source)) {\n            delete tunnelWindow.source;\n            delete tunnelWindows[key];\n        }\n    }\n}\n\nfunction addTunnelWindow(data) {\n    cleanTunnelWindows();\n    _global.global.tunnelWindowId += 1;\n    _global.global.tunnelWindows[_global.global.tunnelWindowId] = data;\n    return _global.global.tunnelWindowId;\n}\n\nfunction getTunnelWindow(id) {\n    return _global.global.tunnelWindows[id];\n}\n\n_global.global.openTunnelToParent = function openTunnelToParent(data) {\n\n    var parentWindow = (0, _lib.getParent)(window);\n\n    if (!parentWindow) {\n        throw new Error('No parent window found to open tunnel to');\n    }\n\n    var id = addTunnelWindow(data);\n\n    return (0, _interface.send)(parentWindow, _conf.CONSTANTS.POST_MESSAGE_NAMES.OPEN_TUNNEL, {\n\n        name: data.name,\n\n        sendMessage: function sendMessage() {\n\n            var tunnelWindow = getTunnelWindow(id);\n\n            if (!tunnelWindow || !tunnelWindow.source || (0, _lib.isWindowClosed)(tunnelWindow.source)) {\n                return;\n            }\n\n            try {\n                tunnelWindow.canary();\n            } catch (err) {\n                return;\n            }\n\n            tunnelWindow.sendMessage.apply(this, arguments);\n        }\n    }, { domain: _conf.CONSTANTS.WILDCARD });\n};\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.openTunnelToOpener = openTunnelToOpener;\n\nvar _promise = __webpack_require__(8);\n\nvar _conf = __webpack_require__(0);\n\nvar _lib = __webpack_require__(1);\n\nvar _drivers = __webpack_require__(4);\n\nvar _common = __webpack_require__(9);\n\nvar awaitRemoteBridgeForWindow = (0, _lib.weakMapMemoize)(function (win) {\n    return _promise.SyncPromise['try'](function () {\n        for (var _iterator = (0, _lib.getFrames)(win), _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n            var _ref;\n\n            if (_isArray) {\n                if (_i >= _iterator.length) break;\n                _ref = _iterator[_i++];\n            } else {\n                _i = _iterator.next();\n                if (_i.done) break;\n                _ref = _i.value;\n            }\n\n            var _frame = _ref;\n\n            try {\n                if (_frame && _frame !== window && (0, _lib.isSameDomain)(_frame) && _frame[_conf.CONSTANTS.WINDOW_PROPS.POSTROBOT]) {\n                    return _frame;\n                }\n            } catch (err) {\n                continue;\n            }\n        }\n\n        try {\n            var frame = (0, _lib.getFrameByName)(win, (0, _common.getBridgeName)(_lib.util.getDomain()));\n\n            if (!frame) {\n                return;\n            }\n\n            if ((0, _lib.isSameDomain)(frame) && frame[_conf.CONSTANTS.WINDOW_PROPS.POSTROBOT]) {\n                return frame;\n            }\n\n            return new _promise.SyncPromise(function (resolve) {\n\n                var interval = void 0;\n                var timeout = void 0;\n\n                interval = setInterval(function () {\n                    if ((0, _lib.isSameDomain)(frame) && frame[_conf.CONSTANTS.WINDOW_PROPS.POSTROBOT]) {\n                        clearInterval(interval);\n                        clearTimeout(timeout);\n                        return resolve(frame);\n                    }\n\n                    setTimeout(function () {\n                        clearInterval(interval);\n                        return resolve();\n                    }, 2000);\n                }, 100);\n            });\n        } catch (err) {\n            return;\n        }\n    });\n});\n\nfunction openTunnelToOpener() {\n    return _promise.SyncPromise['try'](function () {\n\n        var opener = (0, _lib.getOpener)(window);\n\n        if (!opener) {\n            return;\n        }\n\n        if (!(0, _common.needsBridge)({ win: opener })) {\n            return;\n        }\n\n        (0, _common.registerRemoteWindow)(opener);\n\n        return awaitRemoteBridgeForWindow(opener).then(function (bridge) {\n\n            if (!bridge) {\n                return (0, _common.rejectRemoteSendMessage)(opener, new Error('Can not register with opener: no bridge found in opener'));\n            }\n\n            if (!window.name) {\n                return (0, _common.rejectRemoteSendMessage)(opener, new Error('Can not register with opener: window does not have a name'));\n            }\n\n            return bridge[_conf.CONSTANTS.WINDOW_PROPS.POSTROBOT].openTunnelToParent({\n\n                name: window.name,\n\n                source: window,\n\n                canary: function canary() {\n                    // pass\n                },\n                sendMessage: function sendMessage(message) {\n\n                    if (!window || window.closed) {\n                        return;\n                    }\n\n                    (0, _drivers.receiveMessage)({\n                        data: message,\n                        origin: this.origin,\n                        source: this.source\n                    });\n                }\n            }).then(function (_ref2) {\n                var source = _ref2.source,\n                    origin = _ref2.origin,\n                    data = _ref2.data;\n\n\n                if (source !== opener) {\n                    throw new Error('Source does not match opener');\n                }\n\n                (0, _common.registerRemoteSendMessage)(source, origin, data.sendMessage);\n            })['catch'](function (err) {\n\n                (0, _common.rejectRemoteSendMessage)(opener, err);\n                throw err;\n            });\n        });\n    });\n}\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar openBridge = exports.openBridge = void 0;\nvar linkUrl = exports.linkUrl = void 0;\nvar isBridge = exports.isBridge = void 0;\nvar needsBridge = exports.needsBridge = void 0;\nvar needsBridgeForBrowser = exports.needsBridgeForBrowser = void 0;\nvar needsBridgeForWin = exports.needsBridgeForWin = void 0;\nvar needsBridgeForDomain = exports.needsBridgeForDomain = void 0;\nvar openTunnelToOpener = exports.openTunnelToOpener = void 0;\nvar destroyBridges = exports.destroyBridges = void 0;\n\nif (true) {\n\n    var bridge = __webpack_require__(10);\n\n    exports.openBridge = openBridge = bridge.openBridge;\n    exports.linkUrl = linkUrl = bridge.linkUrl;\n    exports.isBridge = isBridge = bridge.isBridge;\n    exports.needsBridge = needsBridge = bridge.needsBridge;\n    exports.needsBridgeForBrowser = needsBridgeForBrowser = bridge.needsBridgeForBrowser;\n    exports.needsBridgeForWin = needsBridgeForWin = bridge.needsBridgeForWin;\n    exports.needsBridgeForDomain = needsBridgeForDomain = bridge.needsBridgeForDomain;\n    exports.openTunnelToOpener = openTunnelToOpener = bridge.openTunnelToOpener;\n    exports.destroyBridges = destroyBridges = bridge.destroyBridges;\n}\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nexports.openBridge = openBridge;\nexports.linkUrl = linkUrl;\n\nvar _src = __webpack_require__(3);\n\nvar _conf = __webpack_require__(0);\n\nvar _lib = __webpack_require__(1);\n\nvar _global = __webpack_require__(2);\n\nvar _interface = __webpack_require__(6);\n\nvar _drivers = __webpack_require__(4);\n\nvar _common = __webpack_require__(9);\n\n_global.global.bridges = _global.global.bridges || {};\n\n_global.global.popupWindowsByWin = _global.global.popupWindowsByWin || new _src.WeakMap();\n_global.global.popupWindowsByName = _global.global.popupWindowsByName || {};\n\nfunction listenForRegister(source, domain) {\n    (0, _interface.on)(_conf.CONSTANTS.POST_MESSAGE_NAMES.OPEN_TUNNEL, { source: source, domain: domain }, function (_ref) {\n        var origin = _ref.origin,\n            data = _ref.data;\n\n\n        if (origin !== domain) {\n            throw new Error('Domain ' + domain + ' does not match origin ' + origin);\n        }\n\n        if (!data.name) {\n            throw new Error('Register window expected to be passed window name');\n        }\n\n        if (!data.sendMessage) {\n            throw new Error('Register window expected to be passed sendMessage method');\n        }\n\n        if (!_global.global.popupWindowsByName[data.name]) {\n            throw new Error('Window with name ' + data.name + ' does not exist, or was not opened by this window');\n        }\n\n        if (!_global.global.popupWindowsByName[data.name].domain) {\n            throw new Error('We do not have a registered domain for window ' + data.name);\n        }\n\n        if (_global.global.popupWindowsByName[data.name].domain !== origin) {\n            throw new Error('Message origin ' + origin + ' does not matched registered window origin ' + _global.global.popupWindowsByName[data.name].domain);\n        }\n\n        (0, _common.registerRemoteSendMessage)(_global.global.popupWindowsByName[data.name].win, domain, data.sendMessage);\n\n        return {\n            sendMessage: function sendMessage(message) {\n\n                if (!window || window.closed) {\n                    return;\n                }\n\n                var winDetails = _global.global.popupWindowsByName[data.name];\n\n                if (!winDetails) {\n                    return;\n                }\n\n                (0, _drivers.receiveMessage)({\n                    data: message,\n                    origin: winDetails.domain,\n                    source: winDetails.win\n                });\n            }\n        };\n    });\n}\n\nfunction openBridgeFrame(name, url) {\n\n    _lib.log.debug('Opening bridge:', name, url);\n\n    var iframe = document.createElement('iframe');\n\n    iframe.setAttribute('name', name);\n    iframe.setAttribute('id', name);\n\n    iframe.setAttribute('style', 'display: none; margin: 0; padding: 0; border: 0px none; overflow: hidden;');\n    iframe.setAttribute('frameborder', '0');\n    iframe.setAttribute('border', '0');\n    iframe.setAttribute('scrolling', 'no');\n    iframe.setAttribute('allowTransparency', 'true');\n\n    iframe.setAttribute('tabindex', '-1');\n    iframe.setAttribute('hidden', 'true');\n    iframe.setAttribute('title', '');\n    iframe.setAttribute('role', 'presentation');\n\n    iframe.src = url;\n\n    return iframe;\n}\n\nfunction openBridge(url, domain) {\n\n    domain = domain || _lib.util.getDomainFromUrl(url);\n\n    if (_global.global.bridges[domain]) {\n        return _global.global.bridges[domain];\n    }\n\n    _global.global.bridges[domain] = _lib.promise.run(function () {\n\n        if (_lib.util.getDomain() === domain) {\n            throw new Error('Can not open bridge on the same domain as current domain: ' + domain);\n        }\n\n        var name = (0, _common.getBridgeName)(domain);\n        var frame = (0, _lib.getFrameByName)(window, name);\n\n        if (frame) {\n            throw new Error('Frame with name ' + name + ' already exists on page');\n        }\n\n        var iframe = openBridgeFrame(name, url);\n\n        return _common.documentBodyReady.then(function (body) {\n\n            return new _lib.promise.Promise(function (resolve, reject) {\n\n                setTimeout(resolve, 1);\n            }).then(function () {\n\n                body.appendChild(iframe);\n\n                var bridge = iframe.contentWindow;\n\n                listenForRegister(bridge, domain);\n\n                return new _lib.promise.Promise(function (resolve, reject) {\n\n                    iframe.onload = resolve;\n                    iframe.onerror = reject;\n                }).then(function () {\n\n                    return (0, _lib.onWindowReady)(bridge, _conf.CONFIG.BRIDGE_TIMEOUT, 'Bridge ' + url);\n                }).then(function () {\n\n                    return bridge;\n                });\n            });\n        });\n    });\n\n    return _global.global.bridges[domain];\n}\n\nvar windowOpen = window.open;\n\nwindow.open = function (url, name, options, last) {\n\n    var domain = url;\n\n    if (url && url.indexOf(_conf.CONSTANTS.MOCK_PROTOCOL) === 0) {\n        var _url$split = url.split('|');\n\n        var _url$split2 = _slicedToArray(_url$split, 2);\n\n        domain = _url$split2[0];\n        url = _url$split2[1];\n    }\n\n    if (domain) {\n        domain = _lib.util.getDomainFromUrl(domain);\n    }\n\n    var win = windowOpen.call(this, url, name, options, last);\n\n    if (url) {\n        (0, _common.registerRemoteWindow)(win);\n    }\n\n    for (var _iterator = Object.keys(_global.global.popupWindowsByName), _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n        var _ref2;\n\n        if (_isArray) {\n            if (_i >= _iterator.length) break;\n            _ref2 = _iterator[_i++];\n        } else {\n            _i = _iterator.next();\n            if (_i.done) break;\n            _ref2 = _i.value;\n        }\n\n        var winName = _ref2;\n\n        if ((0, _lib.isWindowClosed)(_global.global.popupWindowsByName[winName].win)) {\n            delete _global.global.popupWindowsByName[winName];\n        }\n    }\n\n    if (name) {\n        var winOptions = { name: name, domain: domain, win: win };\n        _global.global.popupWindowsByWin.set(win, winOptions);\n        _global.global.popupWindowsByName[name] = winOptions;\n    }\n\n    return win;\n};\n\nfunction linkUrl(win, url) {\n\n    var winOptions = _global.global.popupWindowsByWin.get(win);\n\n    if (winOptions) {\n        winOptions.domain = _lib.util.getDomainFromUrl(url);\n        (0, _common.registerRemoteWindow)(win);\n    }\n}\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.emulateIERestrictions = emulateIERestrictions;\n\nvar _conf = __webpack_require__(0);\n\nvar _lib = __webpack_require__(1);\n\nfunction emulateIERestrictions(sourceWindow, targetWindow) {\n    if (!_conf.CONFIG.ALLOW_POSTMESSAGE_POPUP) {\n\n        if ((0, _lib.isSameTopWindow)(sourceWindow, targetWindow) === false) {\n            throw new Error('Can not send and receive post messages between two different windows (disabled to emulate IE)');\n        }\n    }\n}\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.CONFIG = undefined;\n\nvar _ALLOWED_POST_MESSAGE;\n\nvar _constants = __webpack_require__(13);\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar CONFIG = exports.CONFIG = {\n\n    ALLOW_POSTMESSAGE_POPUP:  false ? false : true,\n\n    LOG_LEVEL: 'info',\n\n    BRIDGE_TIMEOUT: 5000,\n    ACK_TIMEOUT: 1000,\n\n    LOG_TO_PAGE: false,\n\n    MOCK_MODE: false,\n\n    ALLOWED_POST_MESSAGE_METHODS: (_ALLOWED_POST_MESSAGE = {}, _defineProperty(_ALLOWED_POST_MESSAGE, _constants.CONSTANTS.SEND_STRATEGIES.POST_MESSAGE, true), _defineProperty(_ALLOWED_POST_MESSAGE, _constants.CONSTANTS.SEND_STRATEGIES.BRIDGE, true), _defineProperty(_ALLOWED_POST_MESSAGE, _constants.CONSTANTS.SEND_STRATEGIES.GLOBAL, true), _ALLOWED_POST_MESSAGE)\n};\n\nif (window.location.href.indexOf(_constants.CONSTANTS.FILE_PROTOCOL) === 0) {\n    CONFIG.ALLOW_POSTMESSAGE_POPUP = true;\n}\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.receiveMessage = receiveMessage;\nexports.messageListener = messageListener;\nexports.listenForMessages = listenForMessages;\n\nvar _conf = __webpack_require__(0);\n\nvar _lib = __webpack_require__(1);\n\nvar _global = __webpack_require__(2);\n\nvar _types = __webpack_require__(29);\n\n_global.global.receivedMessages = _global.global.receivedMessages || [];\n\nfunction parseMessage(message) {\n\n    try {\n        message = (0, _lib.jsonParse)(message);\n    } catch (err) {\n        return;\n    }\n\n    if (!message) {\n        return;\n    }\n\n    message = message[_conf.CONSTANTS.WINDOW_PROPS.POSTROBOT];\n\n    if (!message) {\n        return;\n    }\n\n    if (!message.type) {\n        return;\n    }\n\n    if (!_types.RECEIVE_MESSAGE_TYPES[message.type]) {\n        return;\n    }\n\n    return message;\n}\n\nfunction receiveMessage(event) {\n\n    if (!window || window.closed) {\n        throw new Error('Message recieved in closed window');\n    }\n\n    try {\n        if (!event.source) {\n            return;\n        }\n    } catch (err) {\n        return;\n    }\n\n    var source = event.source,\n        origin = event.origin,\n        data = event.data;\n\n\n    var message = parseMessage(data);\n\n    if (!message) {\n        return;\n    }\n\n    if (message.sourceDomain.indexOf(_conf.CONSTANTS.MOCK_PROTOCOL) === 0 || message.sourceDomain.indexOf(_conf.CONSTANTS.FILE_PROTOCOL) === 0) {\n        origin = message.sourceDomain;\n    }\n\n    if (_global.global.receivedMessages.indexOf(message.id) === -1) {\n        _global.global.receivedMessages.push(message.id);\n    } else {\n        return;\n    }\n\n    var level = void 0;\n\n    if (_conf.POST_MESSAGE_NAMES_LIST.indexOf(message.name) !== -1 || message.type === _conf.CONSTANTS.POST_MESSAGE_TYPE.ACK) {\n        level = 'debug';\n    } else if (message.ack === 'error') {\n        level = 'error';\n    } else {\n        level = 'info';\n    }\n\n    _lib.log.logLevel(level, ['\\n\\n\\t', '#receive', message.type.replace(/^postrobot_message_/, ''), '::', message.name, '::', origin, '\\n\\n', message]);\n\n    if ((0, _lib.isWindowClosed)(source)) {\n        return _lib.log.debug('Source window is closed - can not send ' + message.type + ' ' + message.name);\n    }\n\n    if (message.data) {\n        message.data = (0, _lib.deserializeMethods)(source, origin, message.data);\n    }\n\n    _types.RECEIVE_MESSAGE_TYPES[message.type](source, origin, message);\n}\n\nfunction messageListener(event) {\n\n    try {\n        event.source; // eslint-disable-line\n    } catch (err) {\n        return;\n    }\n\n    event = {\n        source: event.source || event.sourceElement,\n        origin: event.origin || event.originalEvent.origin,\n        data: event.data\n    };\n\n    if (true) {\n        try {\n            __webpack_require__(12).emulateIERestrictions(event.source, window);\n        } catch (err) {\n            return;\n        }\n    }\n\n    receiveMessage(event);\n}\n\nfunction listenForMessages() {\n    _lib.util.listen(window, 'message', messageListener);\n}\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.RECEIVE_MESSAGE_TYPES = undefined;\n\nvar _RECEIVE_MESSAGE_TYPE;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _conf = __webpack_require__(0);\n\nvar _lib = __webpack_require__(1);\n\nvar _send = __webpack_require__(15);\n\nvar _listeners = __webpack_require__(14);\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar RECEIVE_MESSAGE_TYPES = exports.RECEIVE_MESSAGE_TYPES = (_RECEIVE_MESSAGE_TYPE = {}, _defineProperty(_RECEIVE_MESSAGE_TYPE, _conf.CONSTANTS.POST_MESSAGE_TYPE.ACK, function (source, origin, message) {\n\n    var options = (0, _listeners.getResponseListener)(message.hash);\n\n    if (!options) {\n        throw new Error('No handler found for post message ack for message: ' + message.name + ' from ' + origin + ' in ' + window.location.protocol + '//' + window.location.host + window.location.pathname);\n    }\n\n    if (!(0, _lib.matchDomain)(options.domain, origin)) {\n        throw new Error('Ack origin ' + origin + ' does not match domain ' + options.domain);\n    }\n\n    options.ack = true;\n}), _defineProperty(_RECEIVE_MESSAGE_TYPE, _conf.CONSTANTS.POST_MESSAGE_TYPE.REQUEST, function (source, origin, message) {\n\n    var options = (0, _listeners.getRequestListener)({ name: message.name, win: source, domain: origin });\n\n    function respond(data) {\n\n        if (message.fireAndForget || (0, _lib.isWindowClosed)(source)) {\n            return _lib.promise.Promise.resolve();\n        }\n\n        return (0, _send.sendMessage)(source, _extends({\n            target: message.originalSource,\n            hash: message.hash,\n            name: message.name\n        }, data), origin);\n    }\n\n    return _lib.promise.Promise.all([respond({\n        type: _conf.CONSTANTS.POST_MESSAGE_TYPE.ACK\n    }), _lib.promise.run(function () {\n\n        if (!options) {\n            throw new Error('No handler found for post message: ' + message.name + ' from ' + origin + ' in ' + window.location.protocol + '//' + window.location.host + window.location.pathname);\n        }\n\n        if (!(0, _lib.matchDomain)(options.domain, origin)) {\n            throw new Error('Request origin ' + origin + ' does not match domain ' + options.domain);\n        }\n\n        var data = message.data;\n\n        return _lib.promise.deNodeify(options.handler, { source: source, origin: origin, data: data });\n    }).then(function (data) {\n\n        return respond({\n            type: _conf.CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,\n            ack: _conf.CONSTANTS.POST_MESSAGE_ACK.SUCCESS,\n            data: data\n        });\n    }, function (err) {\n\n        return respond({\n            type: _conf.CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,\n            ack: _conf.CONSTANTS.POST_MESSAGE_ACK.ERROR,\n            error: err.stack ? err.message + '\\n' + err.stack : err.toString()\n        });\n    })])['catch'](function (err) {\n\n        if (options && options.handleError) {\n            return options.handleError(err);\n        } else {\n            _lib.log.error(err.stack || err.toString());\n        }\n    });\n}), _defineProperty(_RECEIVE_MESSAGE_TYPE, _conf.CONSTANTS.POST_MESSAGE_TYPE.RESPONSE, function (source, origin, message) {\n\n    var options = (0, _listeners.getResponseListener)(message.hash);\n\n    if (!options) {\n        throw new Error('No handler found for post message response for message: ' + message.name + ' from ' + origin + ' in ' + window.location.protocol + '//' + window.location.host + window.location.pathname);\n    }\n\n    if (!(0, _lib.matchDomain)(options.domain, origin)) {\n        throw new Error('Response origin ' + origin + ' does not match domain ' + options.domain);\n    }\n\n    (0, _listeners.deleteResponseListener)(message.hash);\n\n    if (message.ack === _conf.CONSTANTS.POST_MESSAGE_ACK.ERROR) {\n        return options.respond(new Error(message.error));\n    } else if (message.ack === _conf.CONSTANTS.POST_MESSAGE_ACK.SUCCESS) {\n        var data = message.data || message.response;\n\n        return options.respond(null, { source: source, origin: origin, data: data });\n    }\n}), _RECEIVE_MESSAGE_TYPE);\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.SEND_MESSAGE_STRATEGIES = undefined;\n\nvar _conf = __webpack_require__(0);\n\nvar _lib = __webpack_require__(1);\n\nvar SEND_MESSAGE_STRATEGIES = exports.SEND_MESSAGE_STRATEGIES = {};\n\nSEND_MESSAGE_STRATEGIES[_conf.CONSTANTS.SEND_STRATEGIES.POST_MESSAGE] = function (win, serializedMessage, domain) {\n\n    if (true) {\n        try {\n            __webpack_require__(12).emulateIERestrictions(window, win);\n        } catch (err) {\n            return;\n        }\n    }\n\n    var domains = void 0;\n\n    if (Array.isArray(domain)) {\n        domains = domain;\n    } else if (domain) {\n        domains = [domain];\n    } else {\n        domains = [_conf.CONSTANTS.WILDCARD];\n    }\n\n    domains = domains.map(function (dom) {\n\n        if (dom.indexOf(_conf.CONSTANTS.MOCK_PROTOCOL) === 0) {\n\n            if (window.location.protocol === _conf.CONSTANTS.FILE_PROTOCOL) {\n                return _conf.CONSTANTS.WILDCARD;\n            }\n\n            if (!(0, _lib.isActuallySameDomain)(win)) {\n                throw new Error('Attempting to send messsage to mock domain ' + dom + ', but window is actually cross-domain');\n            }\n\n            return _lib.util.getActualDomain(win);\n        }\n\n        if (dom.indexOf(_conf.CONSTANTS.FILE_PROTOCOL) === 0) {\n            return _conf.CONSTANTS.WILDCARD;\n        }\n\n        return dom;\n    });\n\n    domains.forEach(function (dom) {\n        return win.postMessage(serializedMessage, dom);\n    });\n};\n\nif (true) {\n\n    var sendBridgeMessage = __webpack_require__(10).sendBridgeMessage;\n\n    SEND_MESSAGE_STRATEGIES[_conf.CONSTANTS.SEND_STRATEGIES.BRIDGE] = function (win, serializedMessage, domain) {\n\n        if ((0, _lib.isSameDomain)(win)) {\n            throw new Error('Post message through bridge disabled between same domain windows');\n        }\n\n        if ((0, _lib.isSameTopWindow)(window, win) !== false) {\n            throw new Error('Can only use bridge to communicate between two different windows, not between frames');\n        }\n\n        sendBridgeMessage(win, serializedMessage, domain);\n    };\n\n    SEND_MESSAGE_STRATEGIES[_conf.CONSTANTS.SEND_STRATEGIES.GLOBAL] = function (win, serializedMessage, domain) {\n\n        if (!(0, _lib.isSameDomain)(win)) {\n            throw new Error('Post message through global disabled between different domain windows');\n        }\n\n        if ((0, _lib.isSameTopWindow)(window, win) !== false) {\n            throw new Error('Can only use global to communicate between two different windows, not between frames');\n        }\n\n        var foreignGlobal = win[_conf.CONSTANTS.WINDOW_PROPS.POSTROBOT];\n\n        if (!foreignGlobal) {\n            throw new Error('Can not find postRobot global on foreign window');\n        }\n\n        return foreignGlobal.receiveMessage({\n            source: window,\n            origin: _lib.util.getDomain(),\n            data: serializedMessage\n        });\n    };\n}\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.listenForMethods = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.serializeMethod = serializeMethod;\nexports.serializeMethods = serializeMethods;\nexports.deserializeMethod = deserializeMethod;\nexports.deserializeError = deserializeError;\nexports.deserializeMethods = deserializeMethods;\n\nvar _src = __webpack_require__(3);\n\nvar _conf = __webpack_require__(0);\n\nvar _util = __webpack_require__(5);\n\nvar _domain = __webpack_require__(16);\n\nvar _interface = __webpack_require__(6);\n\nvar _log = __webpack_require__(11);\n\nvar _promise = __webpack_require__(17);\n\nvar _global = __webpack_require__(2);\n\n_global.global.methods = _global.global.methods || new _src.WeakMap();\n\nvar listenForMethods = exports.listenForMethods = _util.util.once(function () {\n    (0, _interface.on)(_conf.CONSTANTS.POST_MESSAGE_NAMES.METHOD, { window: _conf.CONSTANTS.WILDCARD, origin: _conf.CONSTANTS.WILDCARD }, function (_ref) {\n        var source = _ref.source,\n            origin = _ref.origin,\n            data = _ref.data;\n\n\n        var methods = _global.global.methods.get(source);\n\n        if (!methods) {\n            throw new Error('Could not find any methods this window has privileges to call');\n        }\n\n        var meth = methods[data.id];\n\n        if (!meth) {\n            throw new Error('Could not find method with id: ' + data.id);\n        }\n\n        if (!(0, _domain.matchDomain)(meth.domain, origin)) {\n            throw new Error('Method domain ' + meth.domain + ' does not match origin ' + origin);\n        }\n\n        _log.log.debug('Call local method', data.name, data.args);\n\n        return _promise.promise.run(function () {\n            return meth.method.apply({ source: source, origin: origin, data: data }, data.args);\n        }).then(function (result) {\n\n            return {\n                result: result,\n                id: data.id,\n                name: data.name\n            };\n        });\n    });\n});\n\nfunction isSerialized(item, type) {\n    return (typeof item === 'undefined' ? 'undefined' : _typeof(item)) === 'object' && item !== null && item.__type__ === type;\n}\n\nfunction serializeMethod(destination, domain, method, name) {\n\n    var id = _util.util.uniqueID();\n\n    var methods = _global.global.methods.get(destination);\n\n    if (!methods) {\n        methods = {};\n        _global.global.methods.set(destination, methods);\n    }\n\n    methods[id] = { domain: domain, method: method };\n\n    return {\n        __type__: _conf.CONSTANTS.SERIALIZATION_TYPES.METHOD,\n        __id__: id,\n        __name__: name\n    };\n}\n\nfunction serializeError(err) {\n    return {\n        __type__: _conf.CONSTANTS.SERIALIZATION_TYPES.ERROR,\n        __message__: err.stack || err.message || err.toString()\n    };\n}\n\nfunction serializeMethods(destination, domain, obj) {\n\n    return _util.util.replaceObject({ obj: obj }, function (item, key) {\n        if (typeof item === 'function') {\n            return serializeMethod(destination, domain, item, key);\n        }\n\n        if (item instanceof Error) {\n            return serializeError(item);\n        }\n    }).obj;\n}\n\nfunction deserializeMethod(source, origin, obj) {\n\n    function wrapper() {\n        var args = Array.prototype.slice.call(arguments);\n        _log.log.debug('Call foreign method', obj.__name__, args);\n        return (0, _interface.send)(source, _conf.CONSTANTS.POST_MESSAGE_NAMES.METHOD, {\n            id: obj.__id__,\n            name: obj.__name__,\n            args: args\n\n        }, { domain: origin }).then(function (_ref2) {\n            var data = _ref2.data;\n\n\n            _log.log.debug('Got foreign method result', obj.__name__, data.result);\n            return data.result;\n        }, function (err) {\n            _log.log.debug('Got foreign method error', err.stack || err.toString());\n            throw err;\n        });\n    }\n\n    wrapper.__name__ = obj.__name__;\n    wrapper.source = source;\n    wrapper.origin = origin;\n\n    return wrapper;\n}\n\nfunction deserializeError(source, origin, obj) {\n    return new Error(obj.__message__);\n}\n\nfunction deserializeMethods(source, origin, obj) {\n\n    return _util.util.replaceObject({ obj: obj }, function (item, key) {\n\n        if (isSerialized(item, _conf.CONSTANTS.SERIALIZATION_TYPES.METHOD)) {\n            return deserializeMethod(source, origin, item);\n        }\n\n        if (isSerialized(item, _conf.CONSTANTS.SERIALIZATION_TYPES.ERROR)) {\n            return deserializeError(source, origin, item);\n        }\n    }).obj;\n}\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.initOnReady = initOnReady;\nexports.onWindowReady = onWindowReady;\n\nvar _src = __webpack_require__(3);\n\nvar _conf = __webpack_require__(0);\n\nvar _windows = __webpack_require__(7);\n\nvar _interface = __webpack_require__(6);\n\nvar _log = __webpack_require__(11);\n\nvar _promise = __webpack_require__(8);\n\nvar _global = __webpack_require__(2);\n\n_global.global.readyPromises = _global.global.readyPromises || new _src.WeakMap();\n\nfunction initOnReady() {\n\n    (0, _interface.on)(_conf.CONSTANTS.POST_MESSAGE_NAMES.READY, { window: _conf.CONSTANTS.WILDCARD, domain: _conf.CONSTANTS.WILDCARD }, function (event) {\n\n        var win = event.source;\n        var promise = _global.global.readyPromises.get(win);\n\n        if (promise) {\n            promise.resolve(event);\n        } else {\n            promise = new _promise.SyncPromise().resolve(event);\n            _global.global.readyPromises.set(win, promise);\n        }\n    });\n\n    var parent = (0, _windows.getAncestor)();\n\n    if (parent) {\n        (0, _interface.send)(parent, _conf.CONSTANTS.POST_MESSAGE_NAMES.READY, {}, { domain: _conf.CONSTANTS.WILDCARD })['catch'](function (err) {\n            _log.log.debug(err.stack || err.toString());\n        });\n    }\n}\n\nfunction onWindowReady(win) {\n    var timeout = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5000;\n    var name = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'Window';\n\n\n    var promise = _global.global.readyPromises.get(win);\n\n    if (promise) {\n        return promise;\n    }\n\n    promise = new _promise.SyncPromise();\n    _global.global.readyPromises.set(win, promise);\n    setTimeout(function () {\n        return promise.reject(new Error(name + ' did not load after ' + timeout + 'ms'));\n    }, timeout);\n\n    return promise;\n}\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.send = undefined;\nexports.request = request;\nexports.sendToParent = sendToParent;\nexports.client = client;\n\nvar _conf = __webpack_require__(0);\n\nvar _drivers = __webpack_require__(4);\n\nvar _lib = __webpack_require__(1);\n\nfunction request(options) {\n\n    return _lib.promise.nodeify(new _lib.promise.Promise(function (resolve, reject) {\n\n        if (!options.name) {\n            throw new Error('Expected options.name');\n        }\n\n        if (_conf.CONFIG.MOCK_MODE) {\n            options.window = window;\n        } else if (typeof options.window === 'string') {\n            var el = document.getElementById(options.window);\n\n            if (!el) {\n                throw new Error('Expected options.window ' + options.window + ' to be a valid element id');\n            }\n\n            if (el.tagName.toLowerCase() !== 'iframe') {\n                throw new Error('Expected options.window ' + options.window + ' to be an iframe');\n            }\n\n            if (!el.contentWindow) {\n                throw new Error('Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.');\n            }\n\n            options.window = el.contentWindow;\n        } else if (options.window instanceof HTMLElement) {\n\n            if (options.window.tagName.toLowerCase() !== 'iframe') {\n                throw new Error('Expected options.window ' + options.window + ' to be an iframe');\n            }\n\n            if (!options.window.contentWindow) {\n                throw new Error('Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.');\n            }\n\n            options.window = options.window.contentWindow;\n        }\n\n        if (!options.window) {\n            throw new Error('Expected options.window to be a window object, iframe, or iframe element id.');\n        }\n\n        options.domain = options.domain || _conf.CONSTANTS.WILDCARD;\n\n        var hash = options.name + '_' + _lib.util.uniqueID();\n        (0, _drivers.addResponseListener)(hash, options);\n\n        if ((0, _lib.isWindowClosed)(options.window)) {\n            throw new Error('Target window is closed');\n        }\n\n        var hasResult = false;\n\n        options.respond = function (err, result) {\n            if (!err) {\n                hasResult = true;\n            }\n\n            return err ? reject(err) : resolve(result);\n        };\n\n        return _lib.promise.run(function () {\n\n            if ((0, _lib.isAncestor)(window, options.window)) {\n                return (0, _lib.onWindowReady)(options.window);\n            }\n        }).then(function () {\n\n            (0, _drivers.sendMessage)(options.window, {\n                hash: hash,\n                type: _conf.CONSTANTS.POST_MESSAGE_TYPE.REQUEST,\n                name: options.name,\n                data: options.data,\n                fireAndForget: options.fireAndForget\n            }, options.domain)['catch'](reject);\n\n            if (options.fireAndForget) {\n                return resolve();\n            }\n\n            var ackTimeout = _lib.util.intervalTimeout(_conf.CONFIG.ACK_TIMEOUT, 100, function (remaining) {\n\n                if (options.ack || (0, _lib.isWindowClosed)(options.window)) {\n                    return ackTimeout.cancel();\n                }\n\n                if (!remaining) {\n                    return reject(new Error('No ack for postMessage ' + options.name + ' in ' + _conf.CONFIG.ACK_TIMEOUT + 'ms'));\n                }\n            });\n\n            if (options.timeout) {\n                var timeout = _lib.util.intervalTimeout(options.timeout, 100, function (remaining) {\n\n                    if (hasResult || (0, _lib.isWindowClosed)(options.window)) {\n                        return timeout.cancel();\n                    }\n\n                    if (!remaining) {\n                        return reject(new Error('Post message response timed out after ' + options.timeout + ' ms'));\n                    }\n                }, options.timeout);\n            }\n        })['catch'](reject);\n    }), options.callback);\n}\n\nfunction _send(window, name, data, options, callback) {\n\n    if (!callback) {\n        if (!options && typeof data === 'function') {\n            callback = data;\n            options = {};\n            data = {};\n        } else if (typeof options === 'function') {\n            callback = options;\n            options = {};\n        }\n    }\n\n    options = options || {};\n    options.window = window;\n    options.name = name;\n    options.data = data;\n    options.callback = callback;\n\n    return request(options);\n}\n\nexports.send = _send;\nfunction sendToParent(name, data, options, callback) {\n\n    var win = (0, _lib.getAncestor)();\n\n    if (!win) {\n        return new _lib.promise.Promise(function (resolve, reject) {\n            return reject(new Error('Window does not have a parent'));\n        });\n    }\n\n    return _send(win, name, data, options, callback);\n}\n\nfunction client() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n    if (!options.window) {\n        throw new Error('Expected options.window');\n    }\n\n    return {\n        send: function send(name, data, callback) {\n            return _send(options.window, name, data, options, callback);\n        }\n    };\n}\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.CONSTANTS = exports.CONFIG = undefined;\nexports.enableMockMode = enableMockMode;\nexports.disableMockMode = disableMockMode;\n\nvar _conf = __webpack_require__(0);\n\nObject.defineProperty(exports, 'CONFIG', {\n    enumerable: true,\n    get: function get() {\n        return _conf.CONFIG;\n    }\n});\nObject.defineProperty(exports, 'CONSTANTS', {\n    enumerable: true,\n    get: function get() {\n        return _conf.CONSTANTS;\n    }\n});\nexports.disable = disable;\n\nvar _drivers = __webpack_require__(4);\n\nfunction enableMockMode() {\n    _conf.CONFIG.MOCK_MODE = true;\n}\n\nfunction disableMockMode() {\n    _conf.CONFIG.MOCK_MODE = false;\n}\n\nfunction disable() {\n    delete window[_conf.CONSTANTS.WINDOW_PROPS.POSTROBOT];\n    window.removeEventListener('message', _drivers.messageListener);\n}\n\n/***/ }),\n/* 35 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.winutil = exports.util = exports.bridge = exports.parent = undefined;\n\nvar _client = __webpack_require__(33);\n\nObject.keys(_client).forEach(function (key) {\n    if (key === \"default\" || key === \"__esModule\") return;\n    Object.defineProperty(exports, key, {\n        enumerable: true,\n        get: function get() {\n            return _client[key];\n        }\n    });\n});\n\nvar _server = __webpack_require__(36);\n\nObject.keys(_server).forEach(function (key) {\n    if (key === \"default\" || key === \"__esModule\") return;\n    Object.defineProperty(exports, key, {\n        enumerable: true,\n        get: function get() {\n            return _server[key];\n        }\n    });\n});\n\nvar _config = __webpack_require__(34);\n\nObject.keys(_config).forEach(function (key) {\n    if (key === \"default\" || key === \"__esModule\") return;\n    Object.defineProperty(exports, key, {\n        enumerable: true,\n        get: function get() {\n            return _config[key];\n        }\n    });\n});\n\nvar _util = __webpack_require__(5);\n\nObject.defineProperty(exports, 'util', {\n    enumerable: true,\n    get: function get() {\n        return _util.util;\n    }\n});\n\nvar _windows = __webpack_require__(7);\n\nvar windowUtil = _interopRequireWildcard(_windows);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nvar parent = exports.parent = (0, _windows.getAncestor)();\n\nvar bridge = exports.bridge = void 0;\n\nif (true) {\n    exports.bridge = bridge = __webpack_require__(24);\n}\n\nvar winutil = exports.winutil = windowUtil;\n\n/***/ }),\n/* 36 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.on = undefined;\nexports.listen = listen;\nexports.once = once;\nexports.listener = listener;\n\nvar _lib = __webpack_require__(1);\n\nvar _drivers = __webpack_require__(4);\n\nvar _conf = __webpack_require__(0);\n\nfunction listen(options) {\n\n    if (!options.name) {\n        throw new Error('Expected options.name');\n    }\n\n    options.handler = options.handler || _lib.util.noop;\n\n    options.errorHandler = options.errorHandler || function (err) {\n        throw err;\n    };\n\n    if (options.source) {\n        options.window = options.source;\n    }\n\n    options.domain = options.domain || _conf.CONSTANTS.WILDCARD;\n\n    var requestListener = (0, _drivers.addRequestListener)({ name: options.name, win: options.window, domain: options.domain }, options);\n\n    if (options.once) {\n        var handler = options.handler;\n        options.handler = _lib.util.once(function () {\n            requestListener.cancel();\n            return handler.apply(this, arguments);\n        });\n    }\n\n    options.handleError = function (err) {\n        options.errorHandler(err);\n    };\n\n    if (options.window && options.errorOnClose) {\n        var interval = _lib.util.safeInterval(function () {\n            if ((0, _lib.isWindowClosed)(options.window)) {\n                interval.cancel();\n                options.handleError(new Error('Post message target window is closed'));\n            }\n        }, 50);\n    }\n\n    return {\n        cancel: function cancel() {\n            requestListener.cancel();\n        }\n    };\n}\n\nfunction _on(name, options, handler, errorHandler) {\n\n    if (typeof options === 'function') {\n        errorHandler = handler;\n        handler = options;\n        options = {};\n    }\n\n    options = options || {};\n\n    options.name = name;\n    options.handler = handler || options.handler;\n    options.errorHandler = errorHandler || options.errorHandler;\n\n    return listen(options);\n}\n\nexports.on = _on;\nfunction once(name, options, handler, errorHandler) {\n\n    if (typeof options === 'function') {\n        errorHandler = handler;\n        handler = options;\n        options = {};\n    }\n\n    options = options || {};\n\n    options.name = name;\n    options.handler = handler || options.handler;\n    options.errorHandler = errorHandler || options.errorHandler;\n    options.once = true;\n\n    var prom = new _lib.promise.Promise(function (resolve, reject) {\n        options.handler = options.handler || function (event) {\n            return resolve(event);\n        };\n        options.errorHandler = options.errorHandler || reject;\n    });\n\n    var myListener = listen(options);\n\n    _lib.util.extend(prom, myListener);\n\n    return prom;\n}\n\nfunction listener() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n    return {\n        on: function on(name, handler, errorHandler) {\n            return _on(name, options, handler, errorHandler);\n        }\n    };\n}\n\n/***/ }),\n/* 37 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _interface = __webpack_require__(6);\n\nObject.keys(_interface).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _interface[key];\n    }\n  });\n});\n\nvar INTERFACE = _interopRequireWildcard(_interface);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nexports['default'] = INTERFACE;\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// post-robot.ie.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 37);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e6b67721146c44b5a85e","\nexport * from './config';\nexport * from './constants';\n\n\n// WEBPACK FOOTER //\n// ./src/conf/index.js","\nexport * from './promise';\nexport * from './util';\nexport * from './log';\nexport * from './windows';\nexport * from './methods';\nexport * from './tick';\nexport * from './ready';\nexport * from './domain';\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/index.js","\nimport { CONSTANTS } from './conf';\n\nexport let global = window[CONSTANTS.WINDOW_PROPS.POSTROBOT] = window[CONSTANTS.WINDOW_PROPS.POSTROBOT] || {};\n\n// Backwards compatibility\n\nglobal.registerSelf = () => {\n    // pass\n};\n\n\n// WEBPACK FOOTER //\n// ./src/global.js","\nimport * as INTERFACE from './interface';\nexport * from './interface';\nexport default INTERFACE;\n\n\n// WEBPACK FOOTER //\n// ./~/cross-domain-safe-weakmap/src/index.js","\nexport * from './receive';\nexport * from './send';\nexport * from './listeners';\n\n\n// WEBPACK FOOTER //\n// ./src/drivers/index.js","\nimport { WeakMap } from 'cross-domain-safe-weakmap/src';\nimport { CONSTANTS } from '../conf';\n\nexport let util = {\n\n    once(method) {\n        if (!method) {\n            return method;\n        }\n        let called = false;\n        return function onceWrapper() {\n            if (!called) {\n                called = true;\n                return method.apply(this, arguments);\n            }\n        };\n    },\n\n    noop() {}, // eslint-disable-line no-empty-function\n\n    safeHasProp(obj, name) {\n        try {\n            if (obj[name]) {\n                return true;\n            } else {\n                return false;\n            }\n        } catch (err) {\n            return false;\n        }\n    },\n\n    safeGetProp(obj, name) {\n        try {\n            return obj[name];\n        } catch (err) {\n            return;\n        }\n    },\n\n    listen(win, event, handler) {\n        if (win.addEventListener) {\n            win.addEventListener(event, handler);\n        } else {\n            win.attachEvent(`on${event}`, handler);\n        }\n\n        return {\n            cancel() {\n                if (win.removeEventListener) {\n                    win.removeEventListener(event, handler);\n                } else {\n                    win.detachEvent(`on${event}`, handler);\n                }\n            }\n        };\n    },\n\n    apply(method, context, args) {\n        if (typeof method.apply === 'function') {\n            return method.apply(context, args);\n        }\n        return method(args[0], args[1], args[2], args[3], args[4], args[5], args[6], args[7], args[8], args[9]);\n    },\n\n    find(collection, method, def) {\n        if (!collection) {\n            return def;\n        }\n        for (let i = 0; i < collection.length; i++) {\n            if (method(collection[i])) {\n                return collection[i];\n            }\n        }\n        return def;\n    },\n\n    map(collection, method) {\n        let results = [];\n        for (let i = 0; i < collection.length; i++) {\n            results.push(method(collection[i]));\n        }\n        return results;\n    },\n\n    some(collection, method) {\n        method = method || Boolean;\n        for (let i = 0; i < collection.length; i++) {\n            if (method(collection[i])) {\n                return true;\n            }\n        }\n        return false;\n    },\n\n    keys(mapping) {\n        let result = [];\n        for (let key in mapping) {\n            if (mapping.hasOwnProperty(key)) {\n                result.push(key);\n            }\n        }\n        return result;\n    },\n\n    values(mapping) {\n        let result = [];\n        for (let key in mapping) {\n            if (mapping.hasOwnProperty(key)) {\n                result.push(mapping[key]);\n            }\n        }\n        return result;\n    },\n\n    getByValue(mapping, value) {\n        for (let key in mapping) {\n            if (mapping.hasOwnProperty(key) && mapping[key] === value) {\n                return key;\n            }\n        }\n    },\n\n    uniqueID() {\n\n        let chars = '0123456789abcdef';\n\n        return 'xxxxxxxxxx'.replace(/./g, () => {\n            return chars.charAt(Math.floor(Math.random() * chars.length));\n        });\n    },\n\n    memoize(method) {\n\n        let results = {};\n\n        return function memoized() {\n            let args = JSON.stringify(Array.prototype.slice.call(arguments));\n            if (!results.hasOwnProperty(args)) {\n                results[args] = method.apply(this, arguments);\n            }\n            return results[args];\n        };\n    },\n\n    extend(obj, source) {\n        if (!source) {\n            return obj;\n        }\n\n        for (let key in source) {\n            if (source.hasOwnProperty(key)) {\n                obj[key] = source[key];\n            }\n        }\n\n        return obj;\n    },\n\n    each(obj, callback) {\n        if (Array.isArray(obj)) {\n            for (let i = 0; i < obj.length; i++) {\n                callback(obj[i], i);\n            }\n        } else if (typeof obj === 'object' && obj !== null) {\n            for (let key in obj) {\n                if (obj.hasOwnProperty(key)) {\n                    callback(obj[key], key);\n                }\n            }\n        }\n    },\n\n    replaceObject(obj, callback, depth = 1) {\n\n        if (depth >= 100) {\n            throw new Error(`Self-referential object passed, or object contained too many layers`);\n        }\n\n        let newobj = Array.isArray(obj) ? [] : {};\n\n        util.each(obj, (item, key) => {\n\n            let result = callback(item, key);\n\n            if (result !== undefined) {\n                newobj[key] = result;\n            } else if (typeof item === 'object' && item !== null) {\n                newobj[key] = util.replaceObject(item, callback, depth + 1);\n            } else {\n                newobj[key] = item;\n            }\n        });\n\n        return newobj;\n    },\n\n    safeInterval(method, time) {\n        let timeout;\n\n        function runInterval() {\n            timeout = setTimeout(runInterval, time);\n            method.call();\n        }\n\n        timeout = setTimeout(runInterval, time);\n\n        return {\n            cancel() {\n                clearTimeout(timeout);\n            }\n        };\n    },\n\n    intervalTimeout(time, interval, method) {\n\n        let safeInterval = util.safeInterval(() => {\n            time -= interval;\n\n            time = time <= 0 ? 0 : time;\n\n            if (time === 0) {\n                safeInterval.cancel();\n            }\n\n            method(time);\n        }, interval);\n\n        return safeInterval;\n    },\n\n    getActualDomain(win) {\n        return `${win.location.protocol}//${win.location.host}`;\n    },\n\n    getDomain(win) {\n\n        win = win || window;\n\n        if (win.mockDomain && win.mockDomain.indexOf(CONSTANTS.MOCK_PROTOCOL) === 0) {\n            return win.mockDomain;\n        }\n\n        if (!win.location.protocol) {\n            throw new Error(`Can not read window protocol`);\n        }\n\n        if (win.location.protocol === CONSTANTS.FILE_PROTOCOL) {\n            return util.getActualDomain(win);\n        }\n\n        if (!win.location.host) {\n            throw new Error(`Can not read window host`);\n        }\n\n        return util.getActualDomain(win);\n    },\n\n    getDomainFromUrl(url) {\n\n        let domain;\n\n        if (url.match(/^(https?|mock|file):\\/\\//)) {\n            domain = url;\n        } else {\n            return this.getDomain();\n        }\n\n        domain = domain.split('/').slice(0, 3).join('/');\n\n        return domain;\n    },\n\n    safeGet(obj, prop) {\n\n        let result;\n\n        try {\n            result = obj[prop];\n        } catch (err) {\n            // pass\n        }\n\n        return result;\n    }\n};\n\nexport function isRegex(item) {\n    return Object.prototype.toString.call(item) === '[object RegExp]';\n}\n\nexport function weakMapMemoize(method) {\n\n    let map = new WeakMap();\n\n    return function(arg) {\n        let result = map.get(arg);\n\n        if (typeof result !== 'undefined') {\n            return result;\n        }\n\n        result = method.call(this, arg);\n\n        if (typeof result !== 'undefined') {\n            map.set(arg, result);\n        }\n\n        return result;\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/util.js","\nimport { initOnReady, listenForMethods } from './lib';\nimport { listenForMessages } from './drivers';\nimport { global } from './global';\n\nexport function init() {\n\n    if (!global.initialized) {\n        listenForMessages();\n\n        if (__IE_POPUP_SUPPORT__) {\n            require('./bridge').openTunnelToOpener();\n        }\n\n        initOnReady();\n        listenForMethods();\n    }\n\n    global.initialized = true;\n}\n\ninit();\n\nexport * from './public';\nexport { Promise } from './lib';\n\n\n\n// WEBPACK FOOTER //\n// ./src/interface.js","\nimport { WeakMap } from 'cross-domain-safe-weakmap/src';\n\nimport { util } from './util';\nimport { global } from '../global';\nimport { CONSTANTS } from '../conf';\n\nglobal.domainMatches = global.domainMatches || new WeakMap();\n\nlet domainMatchTimeout;\n\nexport function isSameDomain(win) {\n\n    if (global.domainMatches.has(win)) {\n        return global.domainMatches.get(win);\n    }\n\n    let match;\n\n    try {\n        if (util.getDomain(window) === util.getDomain(win)) {\n            match = true;\n        } else {\n            match = false;\n        }\n    } catch (err) {\n        match = false;\n    }\n\n    global.domainMatches.set(win, match);\n\n    if (!domainMatchTimeout) {\n        domainMatchTimeout = setTimeout(() => {\n            global.domainMatches = new WeakMap();\n            domainMatchTimeout = null;\n        }, 1);\n    }\n\n    return match;\n}\n\nexport function isActuallySameDomain(win) {\n\n    try {\n        if (win && win.location && win.location.href) {\n            return true;\n        }\n\n    } catch (err) {\n        global.domainMatches.push({ win, match: false });\n        return false;\n    }\n\n    return true;\n}\n\nexport function getOpener(win) {\n\n    if (!win) {\n        return;\n    }\n\n    try {\n        return win.opener;\n    } catch (err) {\n        return;\n    }\n}\n\nexport function getParent(win) {\n\n    if (!win) {\n        return;\n    }\n\n    try {\n        if (win.parent && win.parent !== win) {\n            return win.parent;\n        }\n    } catch (err) {\n        return;\n    }\n}\n\n\n\nexport function getParents(win) {\n\n    let result = [];\n\n    try {\n\n        while (win.parent !== win) {\n            result.push(win.parent);\n            win = win.parent;\n        }\n\n    } catch (err) {\n        // pass\n    }\n\n    return result;\n}\n\nexport function isAncestorParent(parent, child) {\n\n    if (!parent || !child) {\n        return false;\n    }\n\n    let childParent = getParent(child);\n\n    if (childParent) {\n        return childParent === parent;\n    }\n\n    if (getParents(child).indexOf(parent) !== -1) {\n        return true;\n    }\n\n    return false;\n}\n\nexport function getFrames(win) {\n\n    let result = [];\n\n    let frames;\n\n    try {\n        frames = win.frames;\n    } catch (err) {\n        frames = win;\n    }\n\n    let len;\n\n    try {\n        len = frames.length;\n    } catch (err) {\n        // pass\n    }\n\n    if (len === 0) {\n        return result;\n    }\n\n    if (len) {\n        for (let i = 0; i < len; i++) {\n\n            let frame;\n\n            try {\n                frame = frames[i];\n            } catch (err) {\n                continue;\n            }\n\n            result.push(frame);\n        }\n\n        return result;\n    }\n\n    for (let i = 0; i < 100; i++) {\n        let frame;\n\n        try {\n            frame = frames[i];\n        } catch (err) {\n            return result;\n        }\n\n        if (!frame) {\n            return result;\n        }\n\n        result.push(frame);\n    }\n\n    return result;\n}\n\n\nexport function getAllChildFrames(win) {\n\n    let result = [];\n\n    for (let frame of getFrames(win)) {\n        result.push(frame);\n\n        for (let childFrame of getAllChildFrames(frame)) {\n            result.push(childFrame);\n        }\n    }\n\n    return result;\n}\n\nexport function getAllFramesInWindow(win) {\n\n    let result = getAllChildFrames(win);\n\n    result.push(win);\n\n    for (let parent of getParents(win)) {\n\n        result.push(parent);\n\n        for (let frame of getFrames(parent)) {\n\n            if (result.indexOf(frame) === -1) {\n                result.push(frame);\n            }\n        }\n    }\n\n    return result;\n}\n\nexport function getTop(win) {\n\n    if (!win) {\n        return;\n    }\n\n    try {\n        if (win.top) {\n            return win.top;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    if (getParent(win) === win) {\n        return win;\n    }\n\n    try {\n        if (isAncestorParent(window, win)) {\n            return window.top;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    try {\n        if (isAncestorParent(win, window)) {\n            return window.top;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    for (let frame of getAllChildFrames(win)) {\n        try {\n            if (frame.top) {\n                return frame.top;\n            }\n        } catch (err) {\n            // pass\n        }\n\n        if (getParent(frame) === frame) {\n            return frame;\n        }\n    }\n}\n\n\nexport function isWindowClosed(win, allowMock = true) {\n\n    try {\n        if (win === window) {\n            return false;\n        }\n    } catch (err) {\n        return true;\n    }\n\n\n    try {\n        if (!win) {\n            return true;\n        }\n\n    } catch (err) {\n        return true;\n    }\n\n    try {\n        if (win.closed) {\n            return true;\n        }\n\n    } catch (err) {\n\n        // I love you so much IE\n\n        if (err && err.message === 'Call was rejected by callee.\\r\\n') {\n            return false;\n        }\n\n        return true;\n    }\n\n\n    if (allowMock && isSameDomain(win) && util.safeGet(win, 'mockclosed')) {\n        return true;\n    }\n\n    /*\n\n    // IE9... don't even ask. If an iframe is removed from the parent page, .closed does not get set to true\n\n    try {\n        if (win.parent === win && !getOpener(win) && win !== getTop(window)) {\n            // return true;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    */\n\n\n    return false;\n}\n\nexport function getUserAgent(win) {\n    win = win || window;\n    return win.navigator.mockUserAgent || win.navigator.userAgent;\n}\n\n\nexport function getFrameByName(win, name) {\n\n    let winFrames = getFrames(win);\n\n    for (let childFrame of winFrames) {\n        try {\n            if (isSameDomain(childFrame) && childFrame.name === name && winFrames.indexOf(childFrame) !== -1) {\n                return childFrame;\n            }\n        } catch (err) {\n            // pass\n        }\n    }\n\n    try {\n        if (winFrames.indexOf(win.frames[name]) !== -1) {\n            return win.frames[name];\n        }\n    } catch (err) {\n        // pass\n    }\n\n    try {\n        if (winFrames.indexOf(win[name]) !== -1) {\n            return win[name];\n        }\n    } catch (err) {\n        // pass\n    }\n}\n\nexport function findChildFrameByName(win, name) {\n\n    let frame = getFrameByName(win, name);\n\n    if (frame) {\n        return frame;\n    }\n\n    for (let childFrame of getFrames(win)) {\n        let namedFrame = findChildFrameByName(childFrame, name);\n\n        if (namedFrame) {\n            return namedFrame;\n        }\n    }\n}\n\nexport function findFrameByName(win, name) {\n\n    let frame;\n\n    frame = getFrameByName(win, name);\n\n    if (frame) {\n        return frame;\n    }\n\n    return findChildFrameByName(getTop(win), name);\n}\n\nexport function isParent(win, frame) {\n\n    let frameParent = getParent(frame);\n\n    if (frameParent) {\n        return frameParent === win;\n    }\n\n    for (let childFrame of getFrames(win)) {\n        if (childFrame === frame) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function isOpener(parent, child) {\n\n    return parent === getOpener(child);\n}\n\nexport function getAncestor(win) {\n    win = win || window;\n\n    let opener = getOpener(win);\n\n    if (opener) {\n        return opener;\n    }\n\n    let parent = getParent(win);\n\n    if (parent) {\n        return parent;\n    }\n}\n\nexport function getAncestors(win) {\n\n    let results = [];\n\n    let ancestor = win;\n\n    while (ancestor) {\n        ancestor = getAncestor(ancestor);\n        if (ancestor) {\n            results.push(ancestor);\n        }\n    }\n\n    return results;\n}\n\n\nexport function isAncestor(parent, child) {\n\n    let actualParent = getAncestor(child);\n\n    if (actualParent) {\n        if (actualParent === parent) {\n            return true;\n        }\n\n        return false;\n    }\n\n    if (child === parent) {\n        return false;\n    }\n\n    if (getTop(child) === child) {\n        return false;\n    }\n\n    for (let frame of getFrames(parent)) {\n        if (frame === child) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function isPopup() {\n    return Boolean(getOpener(window));\n}\n\nexport function isIframe() {\n    return Boolean(getParent(window));\n}\n\nexport function isFullpage() {\n    return Boolean(!isIframe() && !isPopup());\n}\n\nexport function getWindowType() {\n    if (isPopup()) {\n        return CONSTANTS.WINDOW_TYPES.POPUP;\n    }\n    if (isIframe()) {\n        return CONSTANTS.WINDOW_TYPES.IFRAME;\n    }\n    return CONSTANTS.WINDOW_TYPES.FULLPAGE;\n}\n\n\nfunction anyMatch(collection1, collection2) {\n\n    for (let item1 of collection1) {\n        for (let item2 of collection2) {\n            if (item1 === item2) {\n                return true;\n            }\n        }\n    }\n}\n\nexport function isSameTopWindow(win1, win2) {\n\n    let top1 = getTop(win1);\n    let top2 = getTop(win2);\n\n    try {\n        if (top1 && top2) {\n            if (top1 === top2) {\n                return true;\n            }\n\n            return false;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    let allFrames1 = getAllFramesInWindow(win1);\n    let allFrames2 = getAllFramesInWindow(win2);\n\n    if (anyMatch(allFrames1, allFrames2)) {\n        return true;\n    }\n\n    let opener1 = getOpener(top1);\n    let opener2 = getOpener(top2);\n\n    if (opener1 && anyMatch(getAllFramesInWindow(opener1), allFrames2)) {\n        return false;\n    }\n\n    if (opener2 && anyMatch(getAllFramesInWindow(opener2), allFrames1)) {\n        return false;\n    }\n}\n\nexport function jsonStringify() {\n\n    let objectToJSON;\n    let arrayToJSON;\n\n    try {\n        if (JSON.stringify({}) !== '{}') {\n            objectToJSON = Object.prototype.toJSON;\n            delete Object.prototype.toJSON;\n        }\n\n        if (JSON.stringify({}) !== '{}') {\n            throw new Error(`Can not correctly serialize JSON objects`);\n        }\n\n        if (JSON.stringify([]) !== '[]') {\n            arrayToJSON  = Array.prototype.toJSON;\n            delete Array.prototype.toJSON;\n        }\n\n        if (JSON.stringify([]) !== '[]') {\n            throw new Error(`Can not correctly serialize JSON objects`);\n        }\n\n    } catch (err) {\n        throw new Error(`Can not repair JSON.stringify: ${err.message}`);\n    }\n\n    let result = JSON.stringify.apply(this, arguments);\n\n    try {\n        if (objectToJSON) {\n            Object.prototype.toJSON = objectToJSON; // eslint-disable-line\n        }\n\n        if (arrayToJSON) {\n            Array.prototype.toJSON = arrayToJSON; // eslint-disable-line\n        }\n\n    } catch (err) {\n        throw new Error(`Can not repair JSON.stringify: ${err.message}`);\n    }\n\n\n    return result;\n}\n\nexport function jsonParse() {\n    return JSON.parse.apply(this, arguments);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/windows.js","\nfunction trycatch(method, successHandler, errorHandler) {\n\n    let isCalled = false;\n    let isSuccess = false;\n    let isError = false;\n    let err, res;\n\n    function flush() {\n        if (isCalled) {\n            if (isError) {\n                return errorHandler(err);\n            } else if (isSuccess) {\n                return successHandler(res);\n            }\n        }\n    }\n\n    try {\n        method(function(result) {\n            res = result;\n            isSuccess = true;\n            flush();\n        }, function(error) {\n            err = error;\n            isError = true;\n            flush();\n        });\n    } catch (error) {\n        return errorHandler(error);\n    }\n\n    isCalled = true;\n    flush();\n}\n\nlet possiblyUnhandledPromiseHandlers = [];\nlet possiblyUnhandledPromises = [];\nlet possiblyUnhandledPromiseTimeout;\n\nfunction addPossiblyUnhandledPromise(promise) {\n    possiblyUnhandledPromises.push(promise);\n    possiblyUnhandledPromiseTimeout = possiblyUnhandledPromiseTimeout || setTimeout(flushPossiblyUnhandledPromises, 1);\n}\n\nfunction flushPossiblyUnhandledPromises() {\n\n    possiblyUnhandledPromiseTimeout = null;\n    let promises = possiblyUnhandledPromises;\n    possiblyUnhandledPromises = [];\n\n    for (let i = 0; i < promises.length; i++) {\n        let promise = promises[i];\n\n        if (promise.silentReject) {\n            continue;\n        }\n\n        promise.handlers.push({\n            onError(err) {\n                if (promise.silentReject) {\n                    return;\n                }\n\n                dispatchError(err);\n            }\n        });\n\n        promise.dispatch();\n    }\n}\n\nlet dispatchedErrors = [];\n\nfunction dispatchError(err) {\n\n    if (dispatchedErrors.indexOf(err) !== -1) {\n        return;\n    }\n\n    dispatchedErrors.push(err);\n\n    setTimeout(() => {\n        throw err;\n    }, 1);\n\n    for (let j = 0; j < possiblyUnhandledPromiseHandlers.length; j++) {\n        possiblyUnhandledPromiseHandlers[j](err);\n    }\n}\n\n\nlet toString = ({}).toString;\n\nfunction isPromise(item) {\n    try {\n        if (!item) {\n            return false;\n        }\n\n        if (window.Window && item instanceof window.Window) {\n            return false;\n        }\n\n        if (window.constructor && item instanceof window.constructor) {\n            return false;\n        }\n\n        if (toString) {\n            let name = toString.call(item);\n\n            if (name === '[object Window]' || name === '[object global]' || name === '[object DOMWindow]') {\n                return false;\n            }\n        }\n\n        if (item && item.then instanceof Function) {\n            return true;\n        }\n    } catch (err) {\n        return false\n    }\n\n    return false\n}\n\nexport let SyncPromise = function SyncPromise(handler) {\n\n    this.resolved = false;\n    this.rejected = false;\n\n    this.silentReject = false;\n\n    this.handlers = [];\n\n    addPossiblyUnhandledPromise(this);\n\n    if (!handler) {\n        return;\n    }\n\n    let self = this;\n\n    trycatch(handler, function(res) {\n        return self.resolve(res);\n    }, function(err) {\n        return self.reject(err);\n    });\n};\n\nSyncPromise.resolve = function SyncPromiseResolve(value) {\n\n    if (isPromise(value)) {\n        return value;\n    }\n\n    return new SyncPromise().resolve(value);\n};\n\nSyncPromise.reject = function SyncPromiseResolve(error) {\n    return new SyncPromise().reject(error);\n};\n\nSyncPromise.prototype.resolve = function (result) {\n    if (this.resolved || this.rejected) {\n        return this;\n    }\n\n    if (isPromise(result)) {\n        throw new Error('Can not resolve promise with another promise');\n    }\n\n    this.resolved = true;\n    this.value = result;\n    this.dispatch();\n\n    return this;\n};\n\nSyncPromise.prototype.reject = function(error) {\n    if (this.resolved || this.rejected) {\n        return this;\n    }\n\n    if (isPromise(error)) {\n        throw new Error('Can not reject promise with another promise');\n    }\n\n    this.rejected = true;\n    this.value = error;\n    this.dispatch();\n\n    return this;\n};\n\nSyncPromise.prototype.asyncReject = function(error) {\n    this.silentReject = true;\n    this.reject(error);\n}\n\nSyncPromise.prototype.dispatch = function() {\n\n    if (!this.resolved && !this.rejected) {\n        return;\n    }\n\n    while (this.handlers.length) {\n\n        let handler = this.handlers.shift();\n\n        let result, error;\n\n        try {\n            if (this.resolved) {\n                result = handler.onSuccess ? handler.onSuccess(this.value) : this.value;\n            } else if (this.rejected) {\n                if (handler.onError) {\n                    result = handler.onError(this.value);\n                } else {\n                    error = this.value;\n                }\n            }\n        } catch (err) {\n            error = err;\n        }\n\n        if (result === this) {\n            throw new Error('Can not return a promise from the the then handler of the same promise');\n        }\n\n        if (!handler.promise) {\n            continue;\n        }\n\n        if (error) {\n            handler.promise.reject(error);\n\n        } else if (isPromise(result)) {\n            result.then(res => { handler.promise.resolve(res); },\n                        err => { handler.promise.reject(err);  });\n\n        } else {\n            handler.promise.resolve(result);\n        }\n    }\n};\n\nSyncPromise.prototype.then = function(onSuccess, onError) {\n\n    if (onSuccess && typeof onSuccess !== 'function' && !onSuccess.call) {\n        throw new Error('Promise.then expected a function for success handler');\n    }\n\n    if (onError && typeof onError !== 'function' && !onError.call) {\n        throw new Error('Promise.then expected a function for error handler');\n    }\n\n    let promise = new SyncPromise(null, this);\n\n    this.handlers.push({\n        promise: promise,\n        onSuccess: onSuccess,\n        onError: onError\n    });\n\n    this.silentReject = true;\n\n    this.dispatch();\n\n    return promise;\n};\n\nSyncPromise.prototype.catch = function(onError) {\n    return this.then(null, onError);\n};\n\nSyncPromise.prototype.finally = function(handler) {\n    return this.then(function(result) {\n        return SyncPromise.try(handler)\n            .then(() => {\n                return result;\n            });\n    }, function(err) {\n        return SyncPromise.try(handler)\n            .then(() => {\n                throw err;\n            });\n    });\n};\n\nSyncPromise.all = function(promises) {\n\n    let promise = new SyncPromise();\n    let count = promises.length;\n    let results = [];\n\n    for (let i = 0; i < promises.length; i++) {\n\n        let prom = isPromise(promises[i]) ? promises[i] : SyncPromise.resolve(promises[i]);\n\n        prom.then(function(result) {\n            results[i] = result;\n            count -= 1;\n            if (count === 0) {\n                promise.resolve(results);\n            }\n        }, function(err) {\n            promise.reject(err);\n        });\n    }\n\n    if (!count) {\n        promise.resolve(results);\n    }\n\n    return promise;\n};\n\nSyncPromise.onPossiblyUnhandledException = function syncPromiseOnPossiblyUnhandledException(handler) {\n    possiblyUnhandledPromiseHandlers.push(handler);\n};\n\nSyncPromise.try = function syncPromiseTry(method) {\n    return SyncPromise.resolve().then(method);\n}\n\nSyncPromise.delay = function syncPromiseDelay(delay) {\n    return new SyncPromise(resolve => {\n        setTimeout(resolve, delay);\n    });\n}\n\nSyncPromise.hash = function(obj) {\n\n    let results = {};\n    let promises = [];\n\n    for (let key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            promises.push(SyncPromise.resolve(obj[key]).then(result => {\n                results[key] = result;\n            }));\n        }\n    }\n\n    return SyncPromise.all(promises).then(() => {\n        return results;\n    });\n}\n\nSyncPromise.promisifyCall = function() {\n\n    let args = Array.prototype.slice.call(arguments);\n    let method = args.shift();\n\n    if (typeof method !== 'function') {\n        throw new Error(`Expected promisifyCall to be called with a function`);\n    }\n\n    return new SyncPromise((resolve, reject) => {\n\n        args.push((err, result) => {\n            return err ? reject(err) : resolve(result);\n        });\n\n        return method.apply(null, args);\n    });\n}\n\n\nexport function patchPromise() {\n    window.Promise = SyncPromise;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./~/sync-browser-mocks/src/promise.js","\nimport { WeakMap } from 'cross-domain-safe-weakmap/src';\n\nimport { CONFIG, CONSTANTS } from '../conf';\nimport { util, promise, isSameDomain, isOpener, isSameTopWindow, getUserAgent, matchDomain } from '../lib';\nimport { global } from '../global';\nimport { receiveMessage } from '../drivers';\n\nexport function needsBridgeForBrowser() {\n\n    if (getUserAgent(window).match(/MSIE|trident|edge/i)) {\n        return true;\n    }\n\n    if (!CONFIG.ALLOW_POSTMESSAGE_POPUP) {\n        return true;\n    }\n\n    return false;\n}\n\nexport function needsBridgeForWin(win) {\n\n    if (win && isSameTopWindow(window, win)) {\n        return false;\n    }\n\n    if (win && isSameDomain(win)) {\n        return false;\n    }\n\n    return true;\n}\n\nexport function needsBridgeForDomain(domain) {\n\n    if (domain && util.getDomain() === util.getDomainFromUrl(domain)) {\n        return false;\n    }\n\n    return true;\n}\n\nexport function needsBridge({ win, domain }) {\n    return needsBridgeForBrowser() && needsBridgeForWin(win) && needsBridgeForDomain(domain);\n}\n\nexport function getBridgeName(domain) {\n\n    domain = domain || util.getDomainFromUrl(domain);\n\n    let sanitizedDomain = domain.replace(/[^a-zA-Z0-9]+/g, '_');\n\n    let id = `${CONSTANTS.BRIDGE_NAME_PREFIX}_${sanitizedDomain}`;\n\n    return id;\n}\n\nexport function isBridge() {\n    return window.name && window.name === getBridgeName(util.getDomain());\n}\n\nexport let documentBodyReady = new promise.Promise(resolve => {\n\n    if (window.document && window.document.body) {\n        return resolve(window.document.body);\n    }\n\n    let interval = setInterval(() => {\n        if (window.document && window.document.body) {\n            clearInterval(interval);\n            return resolve(window.document.body);\n        }\n    }, 10);\n});\n\nglobal.remoteWindows = global.remoteWindows || new WeakMap();\n\nexport function registerRemoteWindow(win, timeout = CONFIG.BRIDGE_TIMEOUT) {\n    global.remoteWindows.set(win, { sendMessagePromise: new promise.Promise() });\n}\n\nexport function findRemoteWindow(win) {\n    return global.remoteWindows.get(win);\n}\n\nexport function registerRemoteSendMessage(win, domain, sendMessage) {\n\n    let remoteWindow = findRemoteWindow(win);\n\n    if (!remoteWindow) {\n        throw new Error(`Window not found to register sendMessage to`);\n    }\n\n    let sendMessageWrapper = (remoteWin, message, remoteDomain) => {\n\n        if (remoteWin !== win) {\n            throw new Error(`Remote window does not match window`);\n        }\n\n        if (!matchDomain(remoteDomain, domain)) {\n            throw new Error(`Remote domain ${remoteDomain} does not match domain ${domain}`);\n        }\n\n        sendMessage(message);\n    };\n\n    remoteWindow.sendMessagePromise.resolve(sendMessageWrapper);\n    remoteWindow.sendMessagePromise = promise.Promise.resolve(sendMessageWrapper);\n}\n\nexport function rejectRemoteSendMessage(win, err) {\n\n    let remoteWindow = findRemoteWindow(win);\n\n    if (!remoteWindow) {\n        throw new Error(`Window not found on which to reject sendMessage`);\n    }\n\n    remoteWindow.sendMessagePromise.asyncReject(err);\n}\n\nexport function sendBridgeMessage(win, message, domain) {\n\n    let messagingChild  = isOpener(window, win);\n    let messagingParent = isOpener(win, window);\n\n    if (!messagingChild && !messagingParent) {\n        throw new Error(`Can only send messages to and from parent and popup windows`);\n    }\n\n    let remoteWindow = findRemoteWindow(win);\n\n    if (!remoteWindow) {\n        throw new Error(`Window not found to send message to`);\n    }\n\n    return remoteWindow.sendMessagePromise.then(sendMessage => {\n        return sendMessage(win, message, domain);\n    });\n}\n\nglobal.receiveMessage = function(event) {\n    return receiveMessage(event);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/bridge/common.js","\nexport * from './bridge';\nexport * from './child';\nexport * from './common';\nexport * from './parent';\n\n\n\n// WEBPACK FOOTER //\n// ./src/bridge/index.js","\nimport { util } from './util';\nimport { getWindowType, jsonStringify } from './windows';\nimport { CONFIG } from '../conf';\n\nconst LOG_LEVELS = ['debug', 'info', 'warn', 'error'];\n\nif (Function.prototype.bind && window.console && typeof console.log === 'object') {\n    [ 'log', 'info', 'warn', 'error' ].forEach(function(method) {\n        console[method] = this.bind(console[method], console);\n    }, Function.prototype.call);\n}\n\nexport let log = {\n\n    clearLogs() {\n\n        if (window.console && window.console.clear) {\n            window.console.clear();\n        }\n\n        if (CONFIG.LOG_TO_PAGE) {\n            let container = document.getElementById('postRobotLogs');\n\n            if (container) {\n                container.parentNode.removeChild(container);\n            }\n        }\n    },\n\n    writeToPage(level, args) {\n        setTimeout(() => {\n            let container = document.getElementById('postRobotLogs');\n\n            if (!container) {\n                container = document.createElement('div');\n                container.id = 'postRobotLogs';\n                container.style.cssText = 'width: 800px; font-family: monospace; white-space: pre-wrap;';\n                document.body.appendChild(container);\n            }\n\n            let el = document.createElement('div');\n\n            let date = (new Date()).toString().split(' ')[4];\n\n            let payload = util.map(args, item => {\n                if (typeof item === 'string') {\n                    return item;\n                }\n                if (!item) {\n                    return Object.prototype.toString.call(item);\n                }\n                let json;\n                try {\n                    json = jsonStringify(item, 0, 2);\n                } catch (e) {\n                    json = '[object]';\n                }\n\n                return `\\n\\n${json}\\n\\n`;\n            }).join(' ');\n\n\n            let msg = `${date} ${level} ${payload}`;\n            el.innerHTML = msg;\n\n            let color = {\n                log: '#ddd',\n                warn: 'orange',\n                error: 'red',\n                info: 'blue',\n                debug: '#aaa'\n            }[level];\n\n            el.style.cssText = `margin-top: 10px; color: ${color};`;\n\n            if (!container.childNodes.length) {\n                container.appendChild(el);\n            } else {\n                container.insertBefore(el, container.childNodes[0]);\n            }\n\n        });\n    },\n\n    logLevel(level, args) {\n        setTimeout(() => {\n            try {\n                let logLevel = window.LOG_LEVEL || CONFIG.LOG_LEVEL;\n\n                if (LOG_LEVELS.indexOf(level) < LOG_LEVELS.indexOf(logLevel)) {\n                    return;\n                }\n\n                args = Array.prototype.slice.call(args);\n\n                args.unshift(`${window.location.host}${window.location.pathname}`);\n                args.unshift(`::`);\n                args.unshift(`${getWindowType().toLowerCase()}`);\n                args.unshift('[post-robot]');\n\n                if (CONFIG.LOG_TO_PAGE) {\n                    log.writeToPage(level, args);\n                }\n\n                if (!window.console) {\n                    return;\n                }\n\n                if (!window.console[level]) {\n                    level = 'log';\n                }\n\n                if (!window.console[level]) {\n                    return;\n                }\n\n                window.console[level].apply(window.console, args);\n\n            } catch (err) {\n                // pass\n            }\n        }, 1);\n    },\n\n    debug() {\n        log.logLevel('debug', arguments);\n    },\n\n    info() {\n        log.logLevel('info', arguments);\n    },\n\n    warn() {\n        log.logLevel('warn', arguments);\n    },\n\n    error() {\n        log.logLevel('error', arguments);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/log.js","\nexport * from './ie';\n\n\n// WEBPACK FOOTER //\n// ./src/compat/index.js","\nexport let CONSTANTS = {\n\n    POST_MESSAGE_TYPE: {\n        REQUEST: 'postrobot_message_request',\n        RESPONSE: 'postrobot_message_response',\n        ACK: 'postrobot_message_ack'\n    },\n\n    POST_MESSAGE_ACK: {\n        SUCCESS: 'success',\n        ERROR: 'error'\n    },\n\n    POST_MESSAGE_NAMES: {\n        METHOD: 'postrobot_method',\n        READY: 'postrobot_ready',\n        OPEN_TUNNEL: 'postrobot_open_tunnel'\n    },\n\n    WINDOW_TYPES: {\n        FULLPAGE: 'fullpage',\n        POPUP: 'popup',\n        IFRAME: 'iframe'\n    },\n\n    WINDOW_PROPS: {\n        POSTROBOT: '__postRobot__'\n    },\n\n    SERIALIZATION_TYPES: {\n        METHOD: 'postrobot_method',\n        ERROR: 'postrobot_error'\n    },\n\n    SEND_STRATEGIES: {\n        POST_MESSAGE: 'postrobot_post_message',\n        BRIDGE: 'postrobot_bridge',\n        GLOBAL: 'postrobot_global'\n    },\n\n    MOCK_PROTOCOL: 'mock:',\n    FILE_PROTOCOL: 'file:',\n\n    BRIDGE_NAME_PREFIX: '__postrobot_bridge__',\n    POSTROBOT_PROXY: '__postrobot_proxy__',\n\n    WILDCARD: '*'\n};\n\nexport let POST_MESSAGE_NAMES_LIST = Object.keys(CONSTANTS.POST_MESSAGE_NAMES).map(key => CONSTANTS.POST_MESSAGE_NAMES[key]);\n\n\n\n// WEBPACK FOOTER //\n// ./src/conf/constants.js","\nimport { WeakMap } from 'cross-domain-safe-weakmap/src';\n\nimport { global } from '../global';\nimport { matchDomain, isRegex } from '../lib';\nimport { CONSTANTS } from '../conf';\n\nexport function resetListeners() {\n    global.responseListeners = {};\n    global.requestListeners  = {};\n}\n\nglobal.responseListeners = global.responseListeners || {};\nglobal.requestListeners  = global.requestListeners  || {};\nglobal.WINDOW_WILDCARD   = global.WINDOW_WILDCARD   || new (function WindowWildcard() { /* pass */ });\n\nconst __DOMAIN_REGEX__ = '__domain_regex__';\n\nexport function addResponseListener(hash, listener) {\n    global.responseListeners[hash] = listener;\n}\n\nexport function getResponseListener(hash) {\n    return global.responseListeners[hash];\n}\n\nexport function deleteResponseListener(hash) {\n    delete global.responseListeners[hash];\n}\n\nexport function getRequestListener(qualifiers) {\n\n    let { name, win, domain } = qualifiers;\n\n    if (win === CONSTANTS.WILDCARD) {\n        win = null;\n    }\n\n    if (domain === CONSTANTS.WILDCARD) {\n        domain = null;\n    }\n\n    if (!name) {\n        throw new Error(`Name required to get request listener`);\n    }\n\n    let nameListeners = global.requestListeners[name];\n\n    if (!nameListeners) {\n        return;\n    }\n\n    for (let winQualifier of [ win, global.WINDOW_WILDCARD ]) {\n\n        let winListeners = winQualifier && nameListeners.get(winQualifier);\n\n        if (!winListeners) {\n            continue;\n        }\n\n        for (let domainQualifier of [ domain, CONSTANTS.WILDCARD ]) {\n\n            if (!domainQualifier) {\n                continue;\n            }\n\n            domainQualifier = domainQualifier.toString();\n\n            if (winListeners[domainQualifier]) {\n                return winListeners[domainQualifier];\n            }\n        }\n\n        if (winListeners[__DOMAIN_REGEX__]) {\n            for (let { regex, listener } of winListeners[__DOMAIN_REGEX__]) {\n                if (matchDomain(regex, domain)) {\n                    return listener;\n                }\n            }\n        }\n    }\n}\n\nexport function addRequestListener(qualifiers, listener) {\n\n    let { name, win, domain } = qualifiers;\n\n    if (!name || typeof name !== 'string') {\n        throw new Error(`Name required to add request listener`);\n    }\n\n    if (Array.isArray(win)) {\n        for (let item of win) {\n            addRequestListener({ name, domain, win: item }, listener);\n        }\n        return;\n    }\n\n    if (Array.isArray(domain)) {\n        for (let item of domain) {\n            addRequestListener({ name, win, domain: item }, listener);\n        }\n        return;\n    }\n\n    let existingListener = getRequestListener(qualifiers);\n\n    if (!win || win === CONSTANTS.WILDCARD) {\n        win = global.WINDOW_WILDCARD;\n    }\n\n    domain = domain || CONSTANTS.WILDCARD;\n\n    if (existingListener) {\n        if (win && domain) {\n            throw new Error(`Request listener already exists for ${name} on domain ${domain} for specified window`);\n        } else if (win) {\n            throw new Error(`Request listener already exists for ${name} for specified window`);\n        } else if (domain) {\n            throw new Error(`Request listener already exists for ${name} on domain ${domain}`);\n        } else {\n            throw new Error(`Request listener already exists for ${name}`);\n        }\n    }\n\n    let requestListeners = global.requestListeners;\n\n    let nameListeners = requestListeners[name];\n\n    if (!nameListeners) {\n        nameListeners = new WeakMap();\n        requestListeners[name] = nameListeners;\n    }\n\n    let winListeners  = nameListeners.get(win);\n\n    if (!winListeners) {\n        winListeners = {};\n        nameListeners.set(win, winListeners);\n    }\n\n    let strDomain = domain.toString();\n\n    winListeners[strDomain] = listener;\n\n    let regexListeners = winListeners[__DOMAIN_REGEX__];\n    let regexListener;\n\n    if (isRegex(domain)) {\n\n        if (!regexListeners) {\n            regexListeners = [];\n            winListeners[__DOMAIN_REGEX__] = regexListeners;\n        }\n\n        regexListener = { regex: domain, listener };\n\n        regexListeners.push(regexListener);\n    }\n\n    return {\n        cancel() {\n            delete winListeners[strDomain];\n\n            if (Object.keys(winListeners).length === 0) {\n                nameListeners.delete(win);\n            }\n\n            if (regexListener) {\n                regexListeners.splice(regexListeners.indexOf(regexListener, 1));\n            }\n        }\n\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/drivers/listeners.js","\nimport { CONSTANTS, CONFIG, POST_MESSAGE_NAMES_LIST } from '../../conf';\nimport { util, promise, serializeMethods, log, isWindowClosed, getWindowType, jsonStringify } from '../../lib';\n\nimport { SEND_MESSAGE_STRATEGIES } from './strategies';\n\n\nexport function buildMessage(win, message, options = {}) {\n\n    let id   = util.uniqueID();\n    let type = getWindowType();\n    let sourceDomain = util.getDomain(window);\n\n    return {\n        ...message,\n        ...options,\n        sourceDomain,\n        id:         message.id || id,\n        windowType: type\n    };\n}\n\n\nexport function sendMessage(win, message, domain) {\n    return promise.run(() => {\n\n        message = buildMessage(win, message, {\n            data: serializeMethods(win, domain, message.data),\n            domain\n        });\n\n        let level;\n\n        if (POST_MESSAGE_NAMES_LIST.indexOf(message.name) !== -1 || message.type === CONSTANTS.POST_MESSAGE_TYPE.ACK) {\n            level = 'debug';\n        } else if (message.ack === 'error') {\n            level = 'error';\n        } else {\n            level = 'info';\n        }\n\n        log.logLevel(level, [ '\\n\\n\\t', '#send', message.type.replace(/^postrobot_message_/, ''), '::', message.name, '::', domain || CONSTANTS.WILDCARD, '\\n\\n', message ]);\n\n        if (CONFIG.MOCK_MODE) {\n            delete message.target;\n            return window[CONSTANTS.WINDOW_PROPS.POSTROBOT].postMessage({\n                origin: util.getDomain(window),\n                source: window,\n                data: jsonStringify(message, 0, 2)\n            });\n        }\n\n        if (win === window) {\n            throw new Error('Attemping to send message to self');\n        }\n\n        if (isWindowClosed(win)) {\n            throw new Error('Window is closed');\n        }\n\n        log.debug('Running send message strategies', message);\n\n        let messages = [];\n\n        let serializedMessage = jsonStringify({\n            [ CONSTANTS.WINDOW_PROPS.POSTROBOT ]: message\n        }, 0, 2);\n\n        return promise.map(Object.keys(SEND_MESSAGE_STRATEGIES), strategyName => {\n\n            return promise.run(() => {\n\n                if (!CONFIG.ALLOWED_POST_MESSAGE_METHODS[strategyName]) {\n                    throw new Error(`Strategy disallowed: ${strategyName}`);\n                }\n\n                return SEND_MESSAGE_STRATEGIES[strategyName](win, serializedMessage, domain);\n\n            }).then(() => {\n                messages.push(`${strategyName}: success`);\n                return true;\n            }, err => {\n                messages.push(`${strategyName}: ${err.stack || err.toString()}\\n`);\n                return false;\n            });\n\n        }).then(results => {\n\n            let success = util.some(results);\n            let status = `${message.type} ${message.name} ${success ? 'success' : 'error'}:\\n  - ${messages.join('\\n  - ')}\\n`;\n\n            log.debug(status);\n\n            if (!success) {\n                throw new Error(status);\n            }\n        });\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/drivers/send/index.js","\nimport { isRegex } from './util';\nimport { CONSTANTS } from '../conf';\n\nexport function matchDomain(domain, origin) {\n\n    if (typeof domain === 'string') {\n\n        if (isRegex(origin)) {\n            return false;\n        }\n\n        if (Array.isArray(origin)) {\n            return false;\n        }\n\n        return domain === CONSTANTS.WILDCARD || origin === domain;\n    }\n\n    if (isRegex(domain)) {\n\n        if (isRegex(origin)) {\n            return domain.toString() === origin.toString();\n        }\n\n        if (Array.isArray(origin)) {\n            return false;\n        }\n\n        return origin.match(domain);\n    }\n\n    if (Array.isArray(domain)) {\n\n        if (isRegex(origin)) {\n            return false;\n        }\n\n        if (Array.isArray(origin)) {\n            return JSON.stringify(domain) === JSON.stringify(origin);\n        }\n\n        return domain.indexOf(origin) !== -1;\n    }\n\n    return false;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/domain.js","\nimport { SyncPromise } from 'sync-browser-mocks/src/promise';\nimport { nextTick } from './tick';\n\nexport let Promise = SyncPromise;\n\nexport let promise = {\n\n    Promise,\n\n    run(method) {\n        return Promise.resolve().then(method);\n    },\n\n    nextTick(method) {\n        return new Promise((resolve, reject) => {\n            nextTick(() => {\n                return promise.run(method).then(resolve, reject);\n            });\n        });\n    },\n\n    method(method) {\n        return function promiseWrapper() {\n            return Promise.resolve().then(() => {\n                return method.apply(this, arguments);\n            });\n        };\n    },\n\n    nodeify(prom, callback) {\n        if (!callback) {\n            return prom;\n        }\n        prom.then(result => {\n            callback(null, result);\n        }, err => {\n            callback(err);\n        });\n    },\n\n    deNodeify(method, ...args) {\n        return new Promise((resolve, reject) => {\n            try {\n                if (args.length < method.length) {\n                    return method(...args, (err, result) => {\n                        return err ? reject(err) : resolve(result);\n                    });\n                }\n\n                return promise.run(() => {\n                    return method(...args);\n                }).then(resolve, reject);\n\n            } catch (err) {\n                return reject(err);\n            }\n        });\n    },\n\n    map(items, method) {\n\n        let results = [];\n        for (let i = 0; i < items.length; i++) {\n            results.push(promise.run(() => {\n                return method(items[i]);\n            }));\n        }\n        return Promise.all(results);\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/lib/promise.js","\nimport { util } from './util';\nimport { CONSTANTS } from '../conf';\n\nlet tickMessageName = `__nextTick__postRobot__${util.uniqueID()}`;\nlet queue = [];\n\nwindow.addEventListener('message', event => {\n    if (event.data === tickMessageName) {\n        let method = queue.shift();\n        method.call();\n    }\n});\n\nexport function nextTick(method) {\n    queue.push(method);\n    window.postMessage(tickMessageName, CONSTANTS.WILDCARD);\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/tick.js","\nexport let WeakMap;\n\nif (window.WeakMap) {\n    WeakMap = window.WeakMap;\n} else {\n    WeakMap = require('./weakmap').WeakMap;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./~/cross-domain-safe-weakmap/src/interface.js","/* @flow */\n\nlet windows = [];\n\nexport function isWindow(obj : Object) {\n\n    if (windows.indexOf(obj) !== -1) {\n        return true;\n    }\n\n    try {\n        if (obj && obj.self === obj) {\n            windows.push(obj);\n            return true;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    return false;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./~/cross-domain-safe-weakmap/src/util.js","/* @flow */\n\nimport { isWindow } from './util';\n\nlet defineProperty = Object.defineProperty;\nlet counter = Date.now() % 1e9;\n\nexport class WeakMap {\n\n    name : string\n    keys : Array<mixed>\n    values : Array<mixed>\n\n    constructor() {\n        counter += 1;\n        this.name = `__weakmap_${Math.random() * 1e9 >>> 0}__${counter}`; // eslint-disable-line\n        this.keys = [];\n        this.values = [];\n    }\n\n    set(key : Object, value : mixed) {\n\n        if (isWindow(key)) {\n            return this.safeSet(key, value);\n        }\n\n        let name = this.name;\n        let entry = key[name];\n\n        if (entry && entry[0] === key) {\n            entry[1] = value;\n        } else {\n            defineProperty(key, name, {\n                value: [ key, value ],\n                writable: true\n            });\n        }\n    }\n\n    get(key : Object) : ?mixed {\n\n        if (isWindow(key)) {\n            return this.safeGet(key);\n        }\n\n        let entry = key[this.name];\n\n        if (entry && entry[0] === key) {\n            return entry[1];\n        }\n    }\n\n    delete(key : Object) {\n\n        if (isWindow(key)) {\n            return this.safeDelete(key);\n        }\n\n        let entry = key[this.name];\n\n        if (entry && entry[0] === key) {\n            entry[0] = entry[1] = undefined;\n        }\n    }\n\n    has(key : Object) {\n\n        if (isWindow(key)) {\n            return this.safeHas(key);\n        }\n\n        let entry = key[this.name];\n\n        if (entry && entry[0] === key) {\n            return true;\n        }\n\n        return false;\n    }\n\n    safeSet(key : Object, value : mixed) {\n\n        let keys = this.keys;\n        let values = this.values;\n        let index = keys.indexOf(key);\n\n        if (index === -1) {\n            keys.push(key);\n            values.push(value);\n            return;\n        }\n\n        values[index] = value;\n    }\n\n    safeGet(key : Object) : ?mixed {\n\n        let keys = this.keys;\n        let index = keys.indexOf(key);\n\n        if (index === -1) {\n            return;\n        }\n\n        return this.values[index];\n    }\n\n    safeDelete(key : Object) {\n\n        let keys = this.keys;\n        let index = keys.indexOf(key);\n\n        if (index !== -1) {\n            keys.splice(index, 1);\n            this.values.splice(index, 1);\n        }\n    }\n\n    safeHas(key : Object) {\n\n        return this.keys.indexOf(key) !== -1;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./~/cross-domain-safe-weakmap/src/weakmap.js","\nimport { CONSTANTS } from '../conf';\nimport { getParent, isWindowClosed } from '../lib';\nimport { global } from '../global';\nimport { send } from '../interface';\n\n/*\n    HERE BE DRAGONS\n\n    Warning: this file may look weird. Why save the tunnel window in an Object\n    by ID, then look it up later, rather than just using the reference from the closure scope?\n\n    The reason is, that ends up meaning the garbage collector can never get its hands\n    on a closed window, since our closure has continued access to it -- and post-robot\n    has no good way to know whether to clean up the function with the closure scope.\n\n    If you're editing this file, be sure to run significant memory / GC tests afterwards.\n*/\n\nglobal.tunnelWindows = global.tunnelWindows || {};\nglobal.tunnelWindowId = 0;\n\nfunction cleanTunnelWindows() {\n    let tunnelWindows = global.tunnelWindows;\n\n    for (let key of Object.keys(tunnelWindows)) {\n        let tunnelWindow = tunnelWindows[key];\n\n        if (isWindowClosed(tunnelWindow.source)) {\n            delete tunnelWindow.source;\n            delete tunnelWindows[key];\n        }\n    }\n}\n\nfunction addTunnelWindow(data) {\n    cleanTunnelWindows();\n    global.tunnelWindowId += 1;\n    global.tunnelWindows[global.tunnelWindowId] = data;\n    return global.tunnelWindowId;\n}\n\nfunction getTunnelWindow(id) {\n    return global.tunnelWindows[id];\n}\n\nglobal.openTunnelToParent = function openTunnelToParent(data) {\n\n    let parentWindow = getParent(window);\n\n    if (!parentWindow) {\n        throw new Error(`No parent window found to open tunnel to`);\n    }\n\n    let id = addTunnelWindow(data);\n\n    return send(parentWindow, CONSTANTS.POST_MESSAGE_NAMES.OPEN_TUNNEL, {\n\n        name: data.name,\n\n        sendMessage() {\n\n            let tunnelWindow = getTunnelWindow(id);\n\n            if (!tunnelWindow || !tunnelWindow.source || isWindowClosed(tunnelWindow.source)) {\n                return;\n            }\n\n            try {\n                tunnelWindow.canary();\n            } catch (err) {\n                return;\n            }\n\n            tunnelWindow.sendMessage.apply(this, arguments);\n        }\n\n    }, { domain: CONSTANTS.WILDCARD });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/bridge/bridge.js","\nimport { SyncPromise as Promise } from 'sync-browser-mocks/src/promise';\nimport { CONSTANTS } from '../conf';\nimport { isSameDomain, getOpener, getFrames, util, getFrameByName, weakMapMemoize } from '../lib';\nimport { receiveMessage } from '../drivers';\n\nimport { needsBridge, registerRemoteWindow, rejectRemoteSendMessage, registerRemoteSendMessage, getBridgeName } from './common';\n\nlet awaitRemoteBridgeForWindow = weakMapMemoize(win => {\n    return Promise.try(() => {\n        for (let frame of getFrames(win)) {\n            try {\n                if (frame && frame !== window && isSameDomain(frame) && frame[CONSTANTS.WINDOW_PROPS.POSTROBOT]) {\n                    return frame;\n                }\n\n            } catch (err) {\n                continue;\n            }\n        }\n\n        try {\n            let frame = getFrameByName(win, getBridgeName(util.getDomain()));\n\n            if (!frame) {\n                return;\n            }\n\n            if (isSameDomain(frame) && frame[CONSTANTS.WINDOW_PROPS.POSTROBOT]) {\n                return frame;\n            }\n\n            return new Promise(resolve => {\n\n                let interval;\n                let timeout;\n\n                interval = setInterval(() => {\n                    if (isSameDomain(frame) && frame[CONSTANTS.WINDOW_PROPS.POSTROBOT]) {\n                        clearInterval(interval);\n                        clearTimeout(timeout);\n                        return resolve(frame);\n                    }\n\n                    setTimeout(() => {\n                        clearInterval(interval);\n                        return resolve();\n                    }, 2000);\n                }, 100);\n            });\n\n        } catch (err) {\n            return;\n        }\n    });\n});\n\nexport function openTunnelToOpener() {\n    return Promise.try(() => {\n\n        let opener = getOpener(window);\n\n        if (!opener) {\n            return;\n        }\n\n        if (!needsBridge({ win: opener })) {\n            return;\n        }\n\n        registerRemoteWindow(opener);\n\n        return awaitRemoteBridgeForWindow(opener).then(bridge => {\n\n            if (!bridge) {\n                return rejectRemoteSendMessage(opener, new Error(`Can not register with opener: no bridge found in opener`));\n            }\n\n            if (!window.name) {\n                return rejectRemoteSendMessage(opener, new Error(`Can not register with opener: window does not have a name`));\n            }\n\n            return bridge[CONSTANTS.WINDOW_PROPS.POSTROBOT].openTunnelToParent({\n\n                name: window.name,\n\n                source: window,\n\n                canary() {\n                    // pass\n                },\n\n                sendMessage(message) {\n\n                    if (!window || window.closed) {\n                        return;\n                    }\n\n                    receiveMessage({\n                        data:   message,\n                        origin: this.origin,\n                        source: this.source\n                    });\n                }\n\n            }).then(({ source, origin, data }) => {\n\n                if (source !== opener) {\n                    throw new Error(`Source does not match opener`);\n                }\n\n                registerRemoteSendMessage(source, origin, data.sendMessage);\n\n            }).catch(err => {\n\n                rejectRemoteSendMessage(opener, err);\n                throw err;\n            });\n        });\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/bridge/child.js","\nexport let openBridge;\nexport let linkUrl;\nexport let isBridge;\nexport let needsBridge;\nexport let needsBridgeForBrowser;\nexport let needsBridgeForWin;\nexport let needsBridgeForDomain;\nexport let openTunnelToOpener;\nexport let destroyBridges;\n\nif (__IE_POPUP_SUPPORT__) {\n\n    let bridge = require('./index');\n\n    openBridge = bridge.openBridge;\n    linkUrl = bridge.linkUrl;\n    isBridge = bridge.isBridge;\n    needsBridge = bridge.needsBridge;\n    needsBridgeForBrowser = bridge.needsBridgeForBrowser;\n    needsBridgeForWin = bridge.needsBridgeForWin;\n    needsBridgeForDomain = bridge.needsBridgeForDomain;\n    openTunnelToOpener = bridge.openTunnelToOpener;\n    destroyBridges = bridge.destroyBridges;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/bridge/interface.js","\nimport { WeakMap } from 'cross-domain-safe-weakmap/src';\n\nimport { CONFIG, CONSTANTS } from '../conf';\nimport { util, promise, log, onWindowReady, getFrameByName, isWindowClosed } from '../lib';\nimport { global } from '../global';\nimport { on } from '../interface';\nimport { receiveMessage } from '../drivers';\n\nimport { getBridgeName, documentBodyReady, registerRemoteSendMessage, registerRemoteWindow } from './common';\n\nglobal.bridges = global.bridges || {};\n\nglobal.popupWindowsByWin = global.popupWindowsByWin || new WeakMap();\nglobal.popupWindowsByName = global.popupWindowsByName || {};\n\nfunction listenForRegister(source, domain) {\n    on(CONSTANTS.POST_MESSAGE_NAMES.OPEN_TUNNEL, { source, domain }, ({ origin, data }) => {\n\n        if (origin !== domain) {\n            throw new Error(`Domain ${domain} does not match origin ${origin}`);\n        }\n\n        if (!data.name) {\n            throw new Error(`Register window expected to be passed window name`);\n        }\n\n        if (!data.sendMessage) {\n            throw new Error(`Register window expected to be passed sendMessage method`);\n        }\n\n        if (!global.popupWindowsByName[data.name]) {\n            throw new Error(`Window with name ${data.name} does not exist, or was not opened by this window`);\n        }\n\n        if (!global.popupWindowsByName[data.name].domain) {\n            throw new Error(`We do not have a registered domain for window ${data.name}`);\n        }\n\n        if (global.popupWindowsByName[data.name].domain !== origin) {\n            throw new Error(`Message origin ${origin} does not matched registered window origin ${global.popupWindowsByName[data.name].domain}`);\n        }\n\n        registerRemoteSendMessage(global.popupWindowsByName[data.name].win, domain, data.sendMessage);\n\n        return {\n            sendMessage(message) {\n\n                if (!window || window.closed) {\n                    return;\n                }\n\n                let winDetails = global.popupWindowsByName[data.name];\n\n                if (!winDetails) {\n                    return;\n                }\n\n                receiveMessage({\n                    data:   message,\n                    origin: winDetails.domain,\n                    source: winDetails.win\n                });\n            }\n        };\n    });\n}\n\nfunction openBridgeFrame(name, url) {\n\n    log.debug(`Opening bridge:`, name, url);\n\n    let iframe = document.createElement(`iframe`);\n\n    iframe.setAttribute(`name`, name);\n    iframe.setAttribute(`id`,   name);\n\n    iframe.setAttribute(`style`, `display: none; margin: 0; padding: 0; border: 0px none; overflow: hidden;`);\n    iframe.setAttribute(`frameborder`, `0`);\n    iframe.setAttribute(`border`, `0`);\n    iframe.setAttribute(`scrolling`, `no`);\n    iframe.setAttribute(`allowTransparency`, `true`);\n\n    iframe.setAttribute(`tabindex`, `-1`);\n    iframe.setAttribute(`hidden`, `true`);\n    iframe.setAttribute(`title`, ``);\n    iframe.setAttribute(`role`, `presentation`);\n\n    iframe.src = url;\n\n    return iframe;\n}\n\nexport function openBridge(url, domain) {\n\n    domain = domain || util.getDomainFromUrl(url);\n\n    if (global.bridges[domain]) {\n        return global.bridges[domain];\n    }\n\n    global.bridges[domain] = promise.run(() => {\n\n        if (util.getDomain() === domain) {\n            throw new Error(`Can not open bridge on the same domain as current domain: ${domain}`);\n        }\n\n        let name  = getBridgeName(domain);\n        let frame = getFrameByName(window, name);\n\n        if (frame) {\n            throw new Error(`Frame with name ${name} already exists on page`);\n        }\n\n        let iframe = openBridgeFrame(name, url);\n\n        return documentBodyReady.then(body => {\n\n            return new promise.Promise((resolve, reject) => {\n\n                setTimeout(resolve, 1);\n\n            }).then(() => {\n\n                body.appendChild(iframe);\n\n                let bridge = iframe.contentWindow;\n\n                listenForRegister(bridge, domain);\n\n                return new promise.Promise((resolve, reject) => {\n\n                    iframe.onload = resolve;\n                    iframe.onerror = reject;\n\n                }).then(() => {\n\n                    return onWindowReady(bridge, CONFIG.BRIDGE_TIMEOUT, `Bridge ${url}`);\n\n                }).then(() => {\n\n                    return bridge;\n                });\n            });\n        });\n    });\n\n    return global.bridges[domain];\n}\n\nlet windowOpen = window.open;\n\nwindow.open = function(url, name, options, last) {\n\n    let domain = url;\n\n    if (url && url.indexOf(CONSTANTS.MOCK_PROTOCOL) === 0) {\n        [ domain, url ] = url.split('|');\n    }\n\n    if (domain) {\n        domain = util.getDomainFromUrl(domain);\n    }\n\n    let win = windowOpen.call(this, url, name, options, last);\n\n    if (url) {\n        registerRemoteWindow(win);\n    }\n\n    for (let winName of Object.keys(global.popupWindowsByName)) {\n        if (isWindowClosed(global.popupWindowsByName[winName].win)) {\n            delete global.popupWindowsByName[winName];\n        }\n    }\n\n    if (name) {\n        let winOptions = { name, domain, win };\n        global.popupWindowsByWin.set(win, winOptions);\n        global.popupWindowsByName[name] = winOptions;\n    }\n\n    return win;\n};\n\nexport function linkUrl(win, url) {\n\n    let winOptions = global.popupWindowsByWin.get(win);\n\n    if (winOptions) {\n        winOptions.domain = util.getDomainFromUrl(url);\n        registerRemoteWindow(win);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/bridge/parent.js","\nimport { CONFIG } from '../conf';\nimport { isSameTopWindow } from '../lib';\n\nexport function emulateIERestrictions(sourceWindow, targetWindow) {\n    if (!CONFIG.ALLOW_POSTMESSAGE_POPUP) {\n\n        if (isSameTopWindow(sourceWindow, targetWindow) === false) {\n            throw new Error(`Can not send and receive post messages between two different windows (disabled to emulate IE)`);\n        }\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/compat/ie.js","\nimport { CONSTANTS } from './constants';\n\nexport let CONFIG = {\n    \n    ALLOW_POSTMESSAGE_POPUP: __TEST__ ? false : true,\n\n    LOG_LEVEL: 'info',\n\n    BRIDGE_TIMEOUT: 5000,\n    ACK_TIMEOUT: 1000,\n\n    LOG_TO_PAGE: false,\n    \n    MOCK_MODE: false,\n\n    ALLOWED_POST_MESSAGE_METHODS: {\n        [ CONSTANTS.SEND_STRATEGIES.POST_MESSAGE ]: true,\n        [ CONSTANTS.SEND_STRATEGIES.BRIDGE ]: true,\n        [ CONSTANTS.SEND_STRATEGIES.GLOBAL ]: true\n    }\n};\n\nif (window.location.href.indexOf(CONSTANTS.FILE_PROTOCOL) === 0) {\n    CONFIG.ALLOW_POSTMESSAGE_POPUP = true;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/conf/config.js","\nimport { CONSTANTS, POST_MESSAGE_NAMES_LIST } from '../../conf';\nimport { deserializeMethods, log, isWindowClosed, jsonParse, util } from '../../lib';\nimport { global } from '../../global';\n\nimport { RECEIVE_MESSAGE_TYPES } from './types';\n\nglobal.receivedMessages = global.receivedMessages || [];\n\nfunction parseMessage(message) {\n\n    try {\n        message = jsonParse(message);\n    } catch (err) {\n        return;\n    }\n\n    if (!message) {\n        return;\n    }\n\n    message = message[CONSTANTS.WINDOW_PROPS.POSTROBOT];\n\n    if (!message) {\n        return;\n    }\n\n    if (!message.type) {\n        return;\n    }\n\n    if (!RECEIVE_MESSAGE_TYPES[message.type]) {\n        return;\n    }\n\n    return message;\n}\n\n\nexport function receiveMessage(event) {\n\n    if (!window || window.closed) {\n        throw new Error(`Message recieved in closed window`);\n    }\n\n    try {\n        if (!event.source) {\n            return;\n        }\n    } catch (err) {\n        return;\n    }\n\n    let { source, origin, data } = event;\n\n    let message = parseMessage(data);\n\n    if (!message) {\n        return;\n    }\n\n    if (message.sourceDomain.indexOf(CONSTANTS.MOCK_PROTOCOL) === 0 || message.sourceDomain.indexOf(CONSTANTS.FILE_PROTOCOL) === 0) {\n        origin = message.sourceDomain;\n    }\n\n    if (global.receivedMessages.indexOf(message.id) === -1) {\n        global.receivedMessages.push(message.id);\n    } else {\n        return;\n    }\n\n    let level;\n\n    if (POST_MESSAGE_NAMES_LIST.indexOf(message.name) !== -1 || message.type === CONSTANTS.POST_MESSAGE_TYPE.ACK) {\n        level = 'debug';\n    } else if (message.ack === 'error') {\n        level = 'error';\n    } else {\n        level = 'info';\n    }\n\n    log.logLevel(level, [ '\\n\\n\\t', '#receive', message.type.replace(/^postrobot_message_/, ''), '::', message.name, '::', origin, '\\n\\n', message ]);\n\n    if (isWindowClosed(source)) {\n        return log.debug(`Source window is closed - can not send ${message.type} ${message.name}`);\n    }\n\n    if (message.data) {\n        message.data = deserializeMethods(source, origin, message.data);\n    }\n\n    RECEIVE_MESSAGE_TYPES[message.type](source, origin, message);\n}\n\nexport function messageListener(event) {\n\n    try {\n        event.source // eslint-disable-line\n    } catch (err) {\n        return;\n    }\n\n    event = {\n        source: event.source || event.sourceElement,\n        origin: event.origin || event.originalEvent.origin,\n        data: event.data\n    };\n\n    if (__IE_POPUP_SUPPORT__) {\n        try {\n            require('../../compat').emulateIERestrictions(event.source, window);\n        } catch (err) {\n            return;\n        }\n    }\n\n    receiveMessage(event);\n}\n\nexport function listenForMessages() {\n    util.listen(window, 'message', messageListener);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/drivers/receive/index.js","\nimport { CONSTANTS } from '../../conf';\nimport { promise, log, isWindowClosed, matchDomain } from '../../lib';\n\nimport { sendMessage } from '../send';\nimport { getRequestListener, getResponseListener, deleteResponseListener } from '../listeners';\n\nexport let RECEIVE_MESSAGE_TYPES = {\n\n    [ CONSTANTS.POST_MESSAGE_TYPE.ACK ]: (source, origin, message) => {\n\n        let options = getResponseListener(message.hash);\n\n        if (!options) {\n            throw new Error(`No handler found for post message ack for message: ${message.name} from ${origin} in ${window.location.protocol}//${window.location.host}${window.location.pathname}`);\n        }\n\n        if (!matchDomain(options.domain, origin)) {\n            throw new Error(`Ack origin ${origin} does not match domain ${options.domain}`);\n        }\n\n        options.ack = true;\n    },\n\n    [ CONSTANTS.POST_MESSAGE_TYPE.REQUEST ]: (source, origin, message) => {\n\n        let options = getRequestListener({ name: message.name, win: source, domain: origin });\n\n        function respond(data) {\n\n            if (message.fireAndForget || isWindowClosed(source)) {\n                return promise.Promise.resolve();\n            }\n\n            return sendMessage(source, {\n                target: message.originalSource,\n                hash: message.hash,\n                name: message.name,\n                ...data\n            }, origin);\n        }\n\n        return promise.Promise.all([\n\n            respond({\n                type: CONSTANTS.POST_MESSAGE_TYPE.ACK\n            }),\n\n            promise.run(() => {\n\n                if (!options) {\n                    throw new Error(`No handler found for post message: ${message.name} from ${origin} in ${window.location.protocol}//${window.location.host}${window.location.pathname}`);\n                }\n\n                if (!matchDomain(options.domain, origin)) {\n                    throw new Error(`Request origin ${origin} does not match domain ${options.domain}`);\n                }\n\n                let data = message.data;\n\n                return promise.deNodeify(options.handler, { source, origin, data });\n\n            }).then(data => {\n\n                return respond({\n                    type: CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,\n                    ack: CONSTANTS.POST_MESSAGE_ACK.SUCCESS,\n                    data\n                });\n\n            }, err => {\n\n                return respond({\n                    type: CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,\n                    ack: CONSTANTS.POST_MESSAGE_ACK.ERROR,\n                    error: err.stack ? `${err.message}\\n${err.stack}` : err.toString()\n                });\n            })\n\n        ]).catch(err => {\n\n            if (options && options.handleError) {\n                return options.handleError(err);\n            } else {\n                log.error(err.stack || err.toString());\n            }\n        });\n    },\n\n    [ CONSTANTS.POST_MESSAGE_TYPE.RESPONSE ]: (source, origin, message) => {\n\n        let options = getResponseListener(message.hash);\n\n        if (!options) {\n            throw new Error(`No handler found for post message response for message: ${message.name} from ${origin} in ${window.location.protocol}//${window.location.host}${window.location.pathname}`);\n        }\n\n        if (!matchDomain(options.domain, origin)) {\n            throw new Error(`Response origin ${origin} does not match domain ${options.domain}`);\n        }\n\n        deleteResponseListener(message.hash);\n\n        if (message.ack === CONSTANTS.POST_MESSAGE_ACK.ERROR) {\n            return options.respond(new Error(message.error));\n        } else if (message.ack === CONSTANTS.POST_MESSAGE_ACK.SUCCESS) {\n            let data = message.data || message.response;\n\n            return options.respond(null, { source, origin, data });\n        }\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/drivers/receive/types.js","\nimport { CONSTANTS } from '../../conf';\nimport { isSameDomain, isSameTopWindow, isActuallySameDomain, util } from '../../lib';\n\nexport let SEND_MESSAGE_STRATEGIES = {};\n\n\n\n\nSEND_MESSAGE_STRATEGIES[CONSTANTS.SEND_STRATEGIES.POST_MESSAGE] = (win, serializedMessage, domain) => {\n\n    if (__IE_POPUP_SUPPORT__) {\n        try {\n            require('../../compat').emulateIERestrictions(window, win);\n        } catch (err) {\n            return;\n        }\n    }\n\n    let domains;\n\n    if (Array.isArray(domain)) {\n        domains = domain;\n    } else if (domain) {\n        domains = [ domain ];\n    } else {\n        domains = [ CONSTANTS.WILDCARD ];\n    }\n\n    domains = domains.map(dom => {\n\n        if (dom.indexOf(CONSTANTS.MOCK_PROTOCOL) === 0) {\n\n            if (window.location.protocol === CONSTANTS.FILE_PROTOCOL) {\n                return CONSTANTS.WILDCARD;\n            }\n\n            if (!isActuallySameDomain(win)) {\n                throw new Error(`Attempting to send messsage to mock domain ${dom}, but window is actually cross-domain`);\n            }\n\n            return util.getActualDomain(win);\n        }\n\n        if (dom.indexOf(CONSTANTS.FILE_PROTOCOL) === 0) {\n            return CONSTANTS.WILDCARD;\n        }\n\n        return dom;\n    });\n\n    domains.forEach(dom => {\n        return win.postMessage(serializedMessage, dom);\n    });\n};\n\nif (__IE_POPUP_SUPPORT__) {\n\n    let sendBridgeMessage = require('../../bridge').sendBridgeMessage;\n\n    SEND_MESSAGE_STRATEGIES[CONSTANTS.SEND_STRATEGIES.BRIDGE] = (win, serializedMessage, domain) => {\n\n        if (isSameDomain(win)) {\n            throw new Error(`Post message through bridge disabled between same domain windows`);\n        }\n\n        if (isSameTopWindow(window, win) !== false) {\n            throw new Error(`Can only use bridge to communicate between two different windows, not between frames`);\n        }\n\n        sendBridgeMessage(win, serializedMessage, domain);\n    };\n\n    SEND_MESSAGE_STRATEGIES[CONSTANTS.SEND_STRATEGIES.GLOBAL] = (win, serializedMessage, domain) => {\n\n        if (!isSameDomain(win)) {\n            throw new Error(`Post message through global disabled between different domain windows`);\n        }\n\n        if (isSameTopWindow(window, win) !== false) {\n            throw new Error(`Can only use global to communicate between two different windows, not between frames`);\n        }\n\n        let foreignGlobal = win[CONSTANTS.WINDOW_PROPS.POSTROBOT];\n\n        if (!foreignGlobal) {\n            throw new Error(`Can not find postRobot global on foreign window`);\n        }\n\n        return foreignGlobal.receiveMessage({\n            source: window,\n            origin: util.getDomain(),\n            data: serializedMessage\n        });\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/drivers/send/strategies.js","\nimport { WeakMap } from 'cross-domain-safe-weakmap/src';\n\nimport { CONSTANTS } from '../conf';\nimport { util } from './util';\nimport { matchDomain } from './domain';\nimport { on, send } from '../interface';\nimport { log } from './log';\nimport { promise } from './promise';\nimport { global } from '../global';\n\nglobal.methods = global.methods || new WeakMap();\n\nexport let listenForMethods = util.once(() => {\n    on(CONSTANTS.POST_MESSAGE_NAMES.METHOD, { window: CONSTANTS.WILDCARD, origin: CONSTANTS.WILDCARD }, ({ source, origin, data }) => {\n\n        let methods = global.methods.get(source);\n\n        if (!methods) {\n            throw new Error(`Could not find any methods this window has privileges to call`);\n        }\n\n        let meth = methods[data.id];\n\n        if (!meth) {\n            throw new Error(`Could not find method with id: ${data.id}`);\n        }\n\n        if (!matchDomain(meth.domain, origin)) {\n            throw new Error(`Method domain ${meth.domain} does not match origin ${origin}`);\n        }\n\n        log.debug('Call local method', data.name, data.args);\n\n        return promise.run(() => {\n            return meth.method.apply({ source, origin, data }, data.args);\n\n        }).then(result => {\n\n            return {\n                result,\n                id: data.id,\n                name: data.name\n            };\n        });\n    });\n});\n\nfunction isSerialized(item, type) {\n    return typeof item === 'object' && item !== null && item.__type__ === type;\n}\n\nexport function serializeMethod(destination, domain, method, name) {\n\n    let id = util.uniqueID();\n\n    let methods = global.methods.get(destination);\n\n    if (!methods) {\n        methods = {};\n        global.methods.set(destination, methods);\n    }\n\n    methods[id] = { domain, method };\n\n    return {\n        __type__: CONSTANTS.SERIALIZATION_TYPES.METHOD,\n        __id__: id,\n        __name__: name\n    };\n}\n\nfunction serializeError(err) {\n    return {\n        __type__: CONSTANTS.SERIALIZATION_TYPES.ERROR,\n        __message__: err.stack || err.message || err.toString()\n    };\n}\n\nexport function serializeMethods(destination, domain, obj) {\n\n    return util.replaceObject({ obj }, (item, key) => {\n        if (typeof item === 'function') {\n            return serializeMethod(destination, domain, item, key);\n        }\n\n        if (item instanceof Error) {\n            return serializeError(item);\n        }\n    }).obj;\n}\n\nexport function deserializeMethod(source, origin, obj) {\n\n    function wrapper() {\n        let args = Array.prototype.slice.call(arguments);\n        log.debug('Call foreign method', obj.__name__, args);\n        return send(source, CONSTANTS.POST_MESSAGE_NAMES.METHOD, {\n            id: obj.__id__,\n            name: obj.__name__,\n            args\n\n        }, { domain: origin }).then(({ data }) => {\n\n            log.debug('Got foreign method result', obj.__name__, data.result);\n            return data.result;\n        }, err => {\n            log.debug('Got foreign method error', err.stack || err.toString());\n            throw err;\n        });\n    }\n\n    wrapper.__name__ = obj.__name__;\n    wrapper.source = source;\n    wrapper.origin = origin;\n\n    return wrapper;\n}\n\nexport function deserializeError(source, origin, obj) {\n    return new Error(obj.__message__);\n}\n\nexport function deserializeMethods(source, origin, obj) {\n\n    return util.replaceObject({ obj }, (item, key) => {\n\n        if (isSerialized(item, CONSTANTS.SERIALIZATION_TYPES.METHOD)) {\n            return deserializeMethod(source, origin, item);\n        }\n\n        if (isSerialized(item, CONSTANTS.SERIALIZATION_TYPES.ERROR)) {\n            return deserializeError(source, origin, item);\n        }\n\n    }).obj;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/methods.js","\nimport { WeakMap } from 'cross-domain-safe-weakmap/src';\n\nimport { CONSTANTS } from '../conf';\nimport { getAncestor } from './windows';\nimport { on, send } from '../interface';\nimport { log } from './log';\nimport { SyncPromise as Promise } from 'sync-browser-mocks/src/promise';\nimport { global } from '../global';\n\nglobal.readyPromises = global.readyPromises || new WeakMap();\n\nexport function initOnReady() {\n\n    on(CONSTANTS.POST_MESSAGE_NAMES.READY, { window: CONSTANTS.WILDCARD, domain: CONSTANTS.WILDCARD }, event => {\n\n        let win = event.source;\n        let promise = global.readyPromises.get(win);\n\n        if (promise) {\n            promise.resolve(event);\n        } else {\n            promise = new Promise().resolve(event);\n            global.readyPromises.set(win, promise);\n        }\n    });\n\n    let parent = getAncestor();\n\n    if (parent) {\n        send(parent, CONSTANTS.POST_MESSAGE_NAMES.READY, {}, { domain: CONSTANTS.WILDCARD }).catch(err => {\n            log.debug(err.stack || err.toString());\n        });\n    }\n}\n\nexport function onWindowReady(win, timeout = 5000, name = 'Window') {\n\n    let promise = global.readyPromises.get(win);\n\n    if (promise) {\n        return promise;\n    }\n\n    promise = new Promise();\n    global.readyPromises.set(win, promise);\n    setTimeout(() => promise.reject(new Error(`${name} did not load after ${timeout}ms`)), timeout);\n\n    return promise;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/ready.js","\nimport { CONFIG, CONSTANTS } from '../conf';\nimport { sendMessage, addResponseListener } from '../drivers';\nimport { util, promise, getAncestor, isAncestor, onWindowReady, isWindowClosed } from '../lib';\n\n\nexport function request(options) {\n\n    return promise.nodeify(new promise.Promise((resolve, reject) => {\n\n        if (!options.name) {\n            throw new Error('Expected options.name');\n        }\n\n\n        if (CONFIG.MOCK_MODE) {\n            options.window = window;\n\n        } else if (typeof options.window === 'string') {\n            let el = document.getElementById(options.window);\n\n            if (!el) {\n                throw new Error(`Expected options.window ${options.window} to be a valid element id`);\n            }\n\n            if (el.tagName.toLowerCase() !== 'iframe') {\n                throw new Error(`Expected options.window ${options.window} to be an iframe`);\n            }\n\n            if (!el.contentWindow) {\n                throw new Error('Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.');\n            }\n\n            options.window = el.contentWindow;\n\n\n        } else if (options.window instanceof HTMLElement) {\n\n            if (options.window.tagName.toLowerCase() !== 'iframe') {\n                throw new Error(`Expected options.window ${options.window} to be an iframe`);\n            }\n\n            if (!options.window.contentWindow) {\n                throw new Error('Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.');\n            }\n\n            options.window = options.window.contentWindow;\n        }\n\n        if (!options.window) {\n            throw new Error('Expected options.window to be a window object, iframe, or iframe element id.');\n        }\n\n        options.domain = options.domain || CONSTANTS.WILDCARD;\n\n        let hash = `${options.name}_${util.uniqueID()}`;\n        addResponseListener(hash, options);\n\n        if (isWindowClosed(options.window)) {\n            throw new Error('Target window is closed');\n        }\n\n        let hasResult = false;\n\n        options.respond = (err, result) => {\n            if (!err) {\n                hasResult = true;\n            }\n\n            return err ? reject(err) : resolve(result);\n        };\n\n        return promise.run(() => {\n\n            if (isAncestor(window, options.window)) {\n                return onWindowReady(options.window);\n            }\n\n        }).then(() => {\n\n            sendMessage(options.window, {\n                hash,\n                type: CONSTANTS.POST_MESSAGE_TYPE.REQUEST,\n                name: options.name,\n                data: options.data,\n                fireAndForget: options.fireAndForget\n            }, options.domain).catch(reject);\n\n            if (options.fireAndForget) {\n                return resolve();\n            }\n\n            let ackTimeout = util.intervalTimeout(CONFIG.ACK_TIMEOUT, 100, remaining => {\n\n                if (options.ack || isWindowClosed(options.window)) {\n                    return ackTimeout.cancel();\n                }\n\n                if (!remaining) {\n                    return reject(new Error(`No ack for postMessage ${options.name} in ${CONFIG.ACK_TIMEOUT}ms`));\n                }\n            });\n\n            if (options.timeout) {\n                let timeout = util.intervalTimeout(options.timeout, 100, remaining => {\n\n                    if (hasResult || isWindowClosed(options.window)) {\n                        return timeout.cancel();\n                    }\n\n                    if (!remaining) {\n                        return reject(new Error(`Post message response timed out after ${options.timeout} ms`));\n                    }\n\n                }, options.timeout);\n            }\n\n        }).catch(reject);\n\n    }), options.callback);\n}\n\nexport function send(window, name, data, options, callback) {\n\n    if (!callback) {\n        if (!options && typeof data === 'function') {\n            callback = data;\n            options = {};\n            data = {};\n        } else if (typeof options === 'function') {\n            callback = options;\n            options = {};\n        }\n    }\n\n    options = options || {};\n    options.window = window;\n    options.name = name;\n    options.data = data;\n    options.callback = callback;\n\n    return request(options);\n}\n\nexport function sendToParent(name, data, options, callback) {\n\n    let win = getAncestor();\n\n    if (!win) {\n        return new promise.Promise((resolve, reject) => reject(new Error('Window does not have a parent')));\n    }\n\n    return send(win, name, data, options, callback);\n}\n\nexport function client(options = {}) {\n\n    if (!options.window) {\n        throw new Error(`Expected options.window`);\n    }\n\n    return {\n        send(name, data, callback) {\n            return send(options.window, name, data, options, callback);\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/client.js","\nimport { CONFIG, CONSTANTS } from '../conf';\nimport { messageListener } from '../drivers';\n\nexport function enableMockMode() {\n    CONFIG.MOCK_MODE = true;\n}\n\nexport function disableMockMode() {\n    CONFIG.MOCK_MODE = false;\n}\n\nexport { CONFIG, CONSTANTS } from '../conf';\n\nexport function disable() {\n    delete window[CONSTANTS.WINDOW_PROPS.POSTROBOT];\n    window.removeEventListener('message', messageListener);\n}\n\n\n// WEBPACK FOOTER //\n// ./src/public/config.js","\nimport { getAncestor } from '../lib/windows';\n\nexport * from './client';\nexport * from './server';\nexport * from './config';\n\nimport * as windowUtil from '../lib/windows';\n\nexport let parent = getAncestor();\n\nexport let bridge;\n\nif (__IE_POPUP_SUPPORT__) {\n    bridge = require('../bridge/interface');\n}\n\nexport { util } from '../lib/util';\n\nexport let winutil = windowUtil;\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/index.js","\nimport { util, promise, isWindowClosed } from '../lib';\nimport { addRequestListener } from '../drivers';\nimport { CONSTANTS } from '../conf';\n\nexport function listen(options) {\n\n    if (!options.name) {\n        throw new Error('Expected options.name');\n    }\n\n    options.handler = options.handler || util.noop;\n\n    options.errorHandler = options.errorHandler || function(err) {\n        throw err;\n    };\n\n    if (options.source) {\n        options.window = options.source;\n    }\n\n    options.domain = options.domain || CONSTANTS.WILDCARD;\n\n    let requestListener = addRequestListener({ name: options.name, win: options.window, domain: options.domain }, options);\n\n    if (options.once) {\n        let handler = options.handler;\n        options.handler = util.once(function() {\n            requestListener.cancel();\n            return handler.apply(this, arguments);\n        });\n    }\n\n    options.handleError = err => {\n        options.errorHandler(err);\n    };\n\n    if (options.window && options.errorOnClose) {\n        let interval = util.safeInterval(() => {\n            if (isWindowClosed(options.window)) {\n                interval.cancel();\n                options.handleError(new Error('Post message target window is closed'));\n            }\n        }, 50);\n    }\n\n    return {\n        cancel() {\n            requestListener.cancel();\n        }\n    };\n}\n\nexport function on(name, options, handler, errorHandler) {\n\n    if (typeof options === 'function') {\n        errorHandler = handler;\n        handler = options;\n        options = {};\n    }\n\n    options = options || {};\n\n    options.name = name;\n    options.handler = handler || options.handler;\n    options.errorHandler = errorHandler || options.errorHandler;\n\n    return listen(options);\n}\n\nexport function once(name, options, handler, errorHandler) {\n\n    if (typeof options === 'function') {\n        errorHandler = handler;\n        handler = options;\n        options = {};\n    }\n\n    options = options || {};\n\n    options.name = name;\n    options.handler = handler || options.handler;\n    options.errorHandler = errorHandler || options.errorHandler;\n    options.once = true;\n\n    let prom = new promise.Promise((resolve, reject) => {\n        options.handler = options.handler || (event => resolve(event));\n        options.errorHandler = options.errorHandler || reject;\n    });\n\n    let myListener = listen(options);\n\n    util.extend(prom, myListener);\n\n    return prom;\n}\n\nexport function listener(options = {}) {\n\n    return {\n        on(name, handler, errorHandler) {\n            return on(name, options, handler, errorHandler);\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/server.js","\nimport * as INTERFACE from './interface';\nexport * from './interface';\nexport default INTERFACE;\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}