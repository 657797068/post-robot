{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 1c20e4259b733bfadd33","webpack:///./src/conf/index.js","webpack:///./src/lib/index.js","webpack:///./src/global.js","webpack:///./src/drivers/index.js","webpack:///./src/lib/util.js","webpack:///./src/interface.js","webpack:///./~/sync-browser-mocks/src/promise.js","webpack:///./src/lib/windows.js","webpack:///./src/bridge/common.js","webpack:///./src/bridge/index.js","webpack:///./src/lib/log.js","webpack:///./src/compat/index.js","webpack:///./src/conf/constants.js","webpack:///./src/drivers/listeners.js","webpack:///./src/drivers/send/index.js","webpack:///./src/lib/cleanup.js","webpack:///./src/lib/promise.js","webpack:///./src/lib/tick.js","webpack:///./src/bridge/bridge.js","webpack:///./src/bridge/child.js","webpack:///./src/bridge/parent.js","webpack:///./src/compat/ie.js","webpack:///./src/conf/config.js","webpack:///./src/drivers/receive/index.js","webpack:///./src/drivers/receive/types.js","webpack:///./src/drivers/send/strategies.js","webpack:///./src/lib/methods.js","webpack:///./src/lib/ready.js","webpack:///./src/public/client.js","webpack:///./src/public/config.js","webpack:///./src/public/index.js","webpack:///./src/public/server.js","webpack:///./src/index.js"],"names":["global","window","WINDOW_PROPS","POSTROBOT","clean","registerSelf","util","once","method","called","onceWrapper","apply","arguments","noop","safeHasProp","obj","name","err","safeGetProp","listen","win","event","handler","addEventListener","attachEvent","cancel","removeEventListener","detachEvent","context","args","find","collection","def","i","length","map","results","push","some","Boolean","keys","mapping","result","key","hasOwnProperty","values","getByValue","value","uniqueID","chars","replace","charAt","Math","floor","random","memoize","memoized","JSON","stringify","Array","prototype","slice","call","extend","source","each","callback","isArray","replaceObject","depth","Error","newobj","item","undefined","safeInterval","time","timeout","runInterval","setTimeout","clearTimeout","intervalTimeout","interval","getDomain","mockDomain","indexOf","MOCK_PROTOCOL","location","protocol","FILE_PROTOCOL","host","getDomainFromUrl","url","domain","match","split","join","safeGet","prop","init","reset","Promise","initialized","all","then","patchPromise","trycatch","successHandler","errorHandler","isCalled","isSuccess","isError","res","flush","error","possiblyUnhandledPromiseHandlers","possiblyUnhandledPromises","possiblyUnhandledPromiseTimeout","addPossiblyUnhandledPromise","promise","flushPossiblyUnhandledPromises","promises","silentReject","handlers","onError","dispatchError","dispatch","dispatchedErrors","j","toString","isPromise","Window","constructor","Function","SyncPromise","resolved","rejected","self","resolve","reject","SyncPromiseResolve","asyncReject","shift","onSuccess","count","prom","onPossiblyUnhandledException","syncPromiseOnPossiblyUnhandledException","syncPromiseTry","delay","syncPromiseDelay","hash","promisifyCall","isSameDomain","getOpener","getParent","getParents","isAncestorParent","getFrames","getAllChildFrames","getAllFramesInWindow","getTop","isWindowClosed","getUserAgent","getFrameByName","findChildFrameByName","findFrameByName","isParent","isOpener","getAncestor","getAncestors","isAncestor","isPopup","isIframe","isFullpage","getWindowType","isSameTopWindow","jsonStringify","jsonParse","domainMatches","domainMatchTimeout","opener","parent","child","childParent","frames","len","frame","childFrame","top","allowMock","closed","message","navigator","mockUserAgent","userAgent","winFrames","namedFrame","frameParent","ancestor","actualParent","WINDOW_TYPES","POPUP","IFRAME","FULLPAGE","anyMatch","collection1","collection2","item1","item2","win1","win2","top1","top2","allFrames1","allFrames2","opener1","opener2","objectToJSON","arrayToJSON","Object","toJSON","parse","needsBridgeForBrowser","needsBridgeForWin","needsBridgeForDomain","needsBridge","getBridgeName","isBridge","registerRemoteWindow","findRemoteWindow","registerRemoteSendMessage","rejectRemoteSendMessage","sendBridgeMessage","ALLOW_POSTMESSAGE_POPUP","sanitizedDomain","id","BRIDGE_NAME_PREFIX","documentBodyReady","document","body","setInterval","clearInterval","remoteWindows","BRIDGE_TIMEOUT","sendMessagePromise","sendMessage","remoteWindow","sendMessageWrapper","remoteWin","remoteDomain","messagingChild","messagingParent","receiveMessage","LOG_LEVELS","bind","console","log","forEach","clearLogs","clear","LOG_TO_PAGE","container","getElementById","parentNode","removeChild","writeToPage","level","createElement","style","cssText","appendChild","el","date","Date","payload","json","e","msg","innerHTML","color","warn","info","debug","childNodes","insertBefore","logLevel","LOG_LEVEL","unshift","pathname","toLowerCase","CONSTANTS","POST_MESSAGE_TYPE","REQUEST","RESPONSE","ACK","POST_MESSAGE_ACK","SUCCESS","ERROR","POST_MESSAGE_NAMES","METHOD","READY","OPEN_TUNNEL","SERIALIZATION_TYPES","SEND_STRATEGIES","POST_MESSAGE","BRIDGE","GLOBAL","POSTROBOT_PROXY","POST_MESSAGE_NAMES_LIST","resetListeners","getRequestListener","removeRequestListener","addRequestListener","listeners","request","response","isRegex","matchDomain","origin","requestListener","specifiedWin","specifiedDomain","matchedWin","matchedDomain","options","listener","splice","override","buildMessage","type","sourceDomain","windowType","run","data","ack","MOCK_MODE","target","postMessage","messages","serializedMessage","ALLOWED_POST_MESSAGE_METHODS","strategyName","stack","success","status","cleanup","tasks","getters","array","object","set","register","index","setItem","complete","hasTasks","filter","pop","toClean","nextTick","promiseWrapper","nodeify","deNodeify","items","tickMessageName","queue","openTunnelToParent","canary","openTunnelToOpener","getRemoteBridgeForWindow","bridge","openBridge","destroyBridges","linkUrl","bridges","listenForRegister","winDetails","popupWindows","openBridgeFrame","iframe","setAttribute","src","contentWindow","onload","onerror","windowOpen","open","last","winOptions","emulateIERestrictions","sourceWindow","targetWindow","CONFIG","__TEST__","ACK_TIMEOUT","href","messageListener","listenForMessages","receivedMessages","parseMessage","sourceElement","originalEvent","RECEIVE_MESSAGE_TYPES","respond","fireAndForget","originalSource","handleError","SEND_MESSAGE_STRATEGIES","foreignGlobal","serializeMethod","serializeMethods","deserializeMethod","deserializeError","deserializeMethods","methods","listenForMethods","meth","destination","isSerialized","__type__","__id__","__name__","serializeError","__message__","wrapper","initOnReady","onWindowReady","readyPromises","sendToParent","client","tagName","HTMLElement","hasResult","ackTimeout","remaining","send","enableMockMode","disableMockMode","disable","windowUtil","winutil","errorOnClose","on","myListener","INTERFACE"],"mappings":"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","file":"post-robot.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"postRobot\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"postRobot\"] = factory();\n\telse\n\t\troot[\"postRobot\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 32);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1c20e4259b733bfadd33","\nexport * from './config';\nexport * from './constants';\n\n\n// WEBPACK FOOTER //\n// ./src/conf/index.js","\nexport * from './promise';\nexport * from './util';\nexport * from './log';\nexport * from './windows';\nexport * from './methods';\nexport * from './tick';\nexport * from './ready';\nexport * from './cleanup';\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/index.js","\nimport { CONSTANTS } from './conf';\nimport { cleanup } from './lib/cleanup';\n\nexport let global = window[CONSTANTS.WINDOW_PROPS.POSTROBOT] = window[CONSTANTS.WINDOW_PROPS.POSTROBOT] || {};\n\nglobal.clean = global.clean || cleanup(global);\n\n// Backwards compatibility\n\nglobal.registerSelf = () => {\n    // pass\n};\n\n\n// WEBPACK FOOTER //\n// ./src/global.js","\nexport * from './receive';\nexport * from './send';\nexport * from './listeners';\n\n\n// WEBPACK FOOTER //\n// ./src/drivers/index.js","\nimport { CONSTANTS } from '../conf';\n\nexport let util = {\n\n    once(method) {\n        if (!method) {\n            return method;\n        }\n        let called = false;\n        return function onceWrapper() {\n            if (!called) {\n                called = true;\n                return method.apply(this, arguments);\n            }\n        };\n    },\n\n    noop() {}, // eslint-disable-line no-empty-function\n\n    safeHasProp(obj, name) {\n        try {\n            if (obj[name]) {\n                return true;\n            } else {\n                return false;\n            }\n        } catch (err) {\n            return false;\n        }\n    },\n\n    safeGetProp(obj, name) {\n        try {\n            return obj[name];\n        } catch (err) {\n            return;\n        }\n    },\n\n    listen(win, event, handler) {\n        if (win.addEventListener) {\n            win.addEventListener(event, handler);\n        } else {\n            win.attachEvent(`on${event}`, handler);\n        }\n\n        return {\n            cancel() {\n                if (win.removeEventListener) {\n                    win.removeEventListener(event, handler);\n                } else {\n                    win.detachEvent(`on${event}`, handler);\n                }\n            }\n        };\n    },\n\n    apply(method, context, args) {\n        if (typeof method.apply === 'function') {\n            return method.apply(context, args);\n        }\n        return method(args[0], args[1], args[2], args[3], args[4], args[5], args[6], args[7], args[8], args[9]);\n    },\n\n    find(collection, method, def) {\n        if (!collection) {\n            return def;\n        }\n        for (let i = 0; i < collection.length; i++) {\n            if (method(collection[i])) {\n                return collection[i];\n            }\n        }\n        return def;\n    },\n\n    map(collection, method) {\n        let results = [];\n        for (let i = 0; i < collection.length; i++) {\n            results.push(method(collection[i]));\n        }\n        return results;\n    },\n\n    some(collection, method) {\n        method = method || Boolean;\n        for (let i = 0; i < collection.length; i++) {\n            if (method(collection[i])) {\n                return true;\n            }\n        }\n        return false;\n    },\n\n    keys(mapping) {\n        let result = [];\n        for (let key in mapping) {\n            if (mapping.hasOwnProperty(key)) {\n                result.push(key);\n            }\n        }\n        return result;\n    },\n\n    values(mapping) {\n        let result = [];\n        for (let key in mapping) {\n            if (mapping.hasOwnProperty(key)) {\n                result.push(mapping[key]);\n            }\n        }\n        return result;\n    },\n\n    getByValue(mapping, value) {\n        for (let key in mapping) {\n            if (mapping.hasOwnProperty(key) && mapping[key] === value) {\n                return key;\n            }\n        }\n    },\n\n    uniqueID() {\n\n        let chars = '0123456789abcdef';\n\n        return 'xxxxxxxxxx'.replace(/./g, () => {\n            return chars.charAt(Math.floor(Math.random() * chars.length));\n        });\n    },\n\n    memoize(method) {\n\n        let results = {};\n\n        return function memoized() {\n            let args = JSON.stringify(Array.prototype.slice.call(arguments));\n            if (!results.hasOwnProperty(args)) {\n                results[args] = method.apply(this, arguments);\n            }\n            return results[args];\n        };\n    },\n\n    extend(obj, source) {\n        if (!source) {\n            return obj;\n        }\n\n        for (let key in source) {\n            if (source.hasOwnProperty(key)) {\n                obj[key] = source[key];\n            }\n        }\n\n        return obj;\n    },\n\n    each(obj, callback) {\n        if (Array.isArray(obj)) {\n            for (let i = 0; i < obj.length; i++) {\n                callback(obj[i], i);\n            }\n        } else if (typeof obj === 'object' && obj !== null) {\n            for (let key in obj) {\n                if (obj.hasOwnProperty(key)) {\n                    callback(obj[key], key);\n                }\n            }\n        }\n    },\n\n    replaceObject(obj, callback, depth = 1) {\n\n        if (depth >= 100) {\n            throw new Error(`Self-referential object passed, or object contained too many layers`);\n        }\n\n        let newobj = Array.isArray(obj) ? [] : {};\n\n        util.each(obj, (item, key) => {\n\n            let result = callback(item, key);\n\n            if (result !== undefined) {\n                newobj[key] = result;\n            } else if (typeof item === 'object' && item !== null) {\n                newobj[key] = util.replaceObject(item, callback, depth + 1);\n            } else {\n                newobj[key] = item;\n            }\n        });\n\n        return newobj;\n    },\n\n    safeInterval(method, time) {\n        let timeout;\n\n        function runInterval() {\n            timeout = setTimeout(runInterval, time);\n            method.call();\n        }\n\n        timeout = setTimeout(runInterval, time);\n\n        return {\n            cancel() {\n                clearTimeout(timeout);\n            }\n        };\n    },\n\n    intervalTimeout(time, interval, method) {\n\n        let safeInterval = util.safeInterval(() => {\n            time -= interval;\n\n            time = time <= 0 ? 0 : time;\n\n            if (time === 0) {\n                safeInterval.cancel();\n            }\n\n            method(time);\n        }, interval);\n\n        return safeInterval;\n    },\n\n    getDomain(win) {\n\n        win = win || window;\n\n        if (win.mockDomain && win.mockDomain.indexOf(CONSTANTS.MOCK_PROTOCOL) === 0) {\n            return win.mockDomain;\n        }\n\n        if (!win.location.protocol) {\n            throw new Error(`Can not read window protocol`);\n        }\n\n        if (win.location.protocol === CONSTANTS.FILE_PROTOCOL) {\n            return `${win.location.protocol}//${win.location.host}`;\n        }\n\n        if (!win.location.host) {\n            throw new Error(`Can not read window host`);\n        }\n\n        return `${win.location.protocol}//${win.location.host}`;\n    },\n\n    getDomainFromUrl(url) {\n\n        let domain;\n\n        if (url.match(/^(https?|mock|file):\\/\\//)) {\n            domain = url;\n        } else {\n            return this.getDomain();\n        }\n\n        domain = domain.split('/').slice(0, 3).join('/');\n\n        return domain;\n    },\n\n    safeGet(obj, prop) {\n\n        let result;\n\n        try {\n            result = obj[prop];\n        } catch (err) {\n            // pass\n        }\n\n        return result;\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/lib/util.js","\nimport { initOnReady, listenForMethods } from './lib';\nimport { listenForMessages } from './drivers';\nimport { global } from './global';\nimport { openTunnelToOpener } from './bridge';\n\nexport function init() {\n\n    if (!global.initialized) {\n        listenForMessages();\n        openTunnelToOpener();\n        initOnReady();\n        listenForMethods();\n    }\n\n    global.initialized = true;\n}\n\ninit();\n\nexport function reset() {\n    return global.clean.all().then(() => {\n        global.initialized = false;\n        return init();\n    });\n}\n\nexport * from './public';\nexport { Promise } from './lib';\n\n\n// WEBPACK FOOTER //\n// ./src/interface.js","\nfunction trycatch(method, successHandler, errorHandler) {\n\n    let isCalled = false;\n    let isSuccess = false;\n    let isError = false;\n    let err, res;\n\n    function flush() {\n        if (isCalled) {\n            if (isError) {\n                return errorHandler(err);\n            } else if (isSuccess) {\n                return successHandler(res);\n            }\n        }\n    }\n\n    try {\n        method(function(result) {\n            res = result;\n            isSuccess = true;\n            flush();\n        }, function(error) {\n            err = error;\n            isError = true;\n            flush();\n        });\n    } catch (error) {\n        return errorHandler(error);\n    }\n\n    isCalled = true;\n    flush();\n}\n\nlet possiblyUnhandledPromiseHandlers = [];\nlet possiblyUnhandledPromises = [];\nlet possiblyUnhandledPromiseTimeout;\n\nfunction addPossiblyUnhandledPromise(promise) {\n    possiblyUnhandledPromises.push(promise);\n    possiblyUnhandledPromiseTimeout = possiblyUnhandledPromiseTimeout || setTimeout(flushPossiblyUnhandledPromises, 1);\n}\n\nfunction flushPossiblyUnhandledPromises() {\n\n    possiblyUnhandledPromiseTimeout = null;\n    let promises = possiblyUnhandledPromises;\n    possiblyUnhandledPromises = [];\n\n    for (let i = 0; i < promises.length; i++) {\n        let promise = promises[i];\n\n        if (promise.silentReject) {\n            continue;\n        }\n\n        promise.handlers.push({\n            onError(err) {\n                if (promise.silentReject) {\n                    return;\n                }\n\n                dispatchError(err);\n            }\n        });\n\n        promise.dispatch();\n    }\n}\n\nlet dispatchedErrors = [];\n\nfunction dispatchError(err) {\n\n    if (dispatchedErrors.indexOf(err) !== -1) {\n        return;\n    }\n\n    dispatchedErrors.push(err);\n\n    setTimeout(() => {\n        throw err;\n    }, 1);\n\n    for (let j = 0; j < possiblyUnhandledPromiseHandlers.length; j++) {\n        possiblyUnhandledPromiseHandlers[j](err);\n    }\n}\n\n\nlet toString = ({}).toString;\n\nfunction isPromise(item) {\n    try {\n        if (!item) {\n            return false;\n        }\n\n        if (window.Window && item instanceof window.Window) {\n            return false;\n        }\n\n        if (window.constructor && item instanceof window.constructor) {\n            return false;\n        }\n\n        if (toString) {\n            let name = toString.call(item);\n\n            if (name === '[object Window]' || name === '[object global]' || name === '[object DOMWindow]') {\n                return false;\n            }\n        }\n\n        if (item && item.then instanceof Function) {\n            return true;\n        }\n    } catch (err) {\n        return false\n    }\n\n    return false\n}\n\nexport let SyncPromise = function SyncPromise(handler) {\n\n    this.resolved = false;\n    this.rejected = false;\n\n    this.silentReject = false;\n\n    this.handlers = [];\n\n    addPossiblyUnhandledPromise(this);\n\n    if (!handler) {\n        return;\n    }\n\n    let self = this;\n\n    trycatch(handler, function(res) {\n        return self.resolve(res);\n    }, function(err) {\n        return self.reject(err);\n    });\n};\n\nSyncPromise.resolve = function SyncPromiseResolve(value) {\n\n    if (isPromise(value)) {\n        return value;\n    }\n\n    return new SyncPromise().resolve(value);\n};\n\nSyncPromise.reject = function SyncPromiseResolve(error) {\n    return new SyncPromise().reject(error);\n};\n\nSyncPromise.prototype.resolve = function (result) {\n    if (this.resolved || this.rejected) {\n        return this;\n    }\n\n    if (isPromise(result)) {\n        throw new Error('Can not resolve promise with another promise');\n    }\n\n    this.resolved = true;\n    this.value = result;\n    this.dispatch();\n\n    return this;\n};\n\nSyncPromise.prototype.reject = function(error) {\n    if (this.resolved || this.rejected) {\n        return this;\n    }\n\n    if (isPromise(error)) {\n        throw new Error('Can not reject promise with another promise');\n    }\n\n    this.rejected = true;\n    this.value = error;\n    this.dispatch();\n\n    return this;\n};\n\nSyncPromise.prototype.asyncReject = function(error) {\n    this.silentReject = true;\n    this.reject(error);\n}\n\nSyncPromise.prototype.dispatch = function() {\n\n    if (!this.resolved && !this.rejected) {\n        return;\n    }\n\n    while (this.handlers.length) {\n\n        let handler = this.handlers.shift();\n\n        let result, error;\n\n        try {\n            if (this.resolved) {\n                result = handler.onSuccess ? handler.onSuccess(this.value) : this.value;\n            } else if (this.rejected) {\n                if (handler.onError) {\n                    result = handler.onError(this.value);\n                } else {\n                    error = this.value;\n                }\n            }\n        } catch (err) {\n            error = err;\n        }\n\n        if (result === this) {\n            throw new Error('Can not return a promise from the the then handler of the same promise');\n        }\n\n        if (!handler.promise) {\n            continue;\n        }\n\n        if (error) {\n            handler.promise.reject(error);\n\n        } else if (isPromise(result)) {\n            result.then(res => { handler.promise.resolve(res); },\n                        err => { handler.promise.reject(err);  });\n\n        } else {\n            handler.promise.resolve(result);\n        }\n    }\n};\n\nSyncPromise.prototype.then = function(onSuccess, onError) {\n\n    if (onSuccess && typeof onSuccess !== 'function' && !onSuccess.call) {\n        throw new Error('Promise.then expected a function for success handler');\n    }\n\n    if (onError && typeof onError !== 'function' && !onError.call) {\n        throw new Error('Promise.then expected a function for error handler');\n    }\n\n    let promise = new SyncPromise(null, this);\n\n    this.handlers.push({\n        promise: promise,\n        onSuccess: onSuccess,\n        onError: onError\n    });\n\n    this.silentReject = true;\n\n    this.dispatch();\n\n    return promise;\n};\n\nSyncPromise.prototype.catch = function(onError) {\n    return this.then(null, onError);\n};\n\nSyncPromise.prototype.finally = function(handler) {\n    return this.then(function(result) {\n        return SyncPromise.try(handler)\n            .then(() => {\n                return result;\n            });\n    }, function(err) {\n        return SyncPromise.try(handler)\n            .then(() => {\n                throw err;\n            });\n    });\n};\n\nSyncPromise.all = function(promises) {\n\n    let promise = new SyncPromise();\n    let count = promises.length;\n    let results = [];\n\n    for (let i = 0; i < promises.length; i++) {\n\n        let prom = isPromise(promises[i]) ? promises[i] : SyncPromise.resolve(promises[i]);\n\n        prom.then(function(result) {\n            results[i] = result;\n            count -= 1;\n            if (count === 0) {\n                promise.resolve(results);\n            }\n        }, function(err) {\n            promise.reject(err);\n        });\n    }\n\n    if (!count) {\n        promise.resolve(results);\n    }\n\n    return promise;\n};\n\nSyncPromise.onPossiblyUnhandledException = function syncPromiseOnPossiblyUnhandledException(handler) {\n    possiblyUnhandledPromiseHandlers.push(handler);\n};\n\nSyncPromise.try = function syncPromiseTry(method) {\n    return SyncPromise.resolve().then(method);\n}\n\nSyncPromise.delay = function syncPromiseDelay(delay) {\n    return new SyncPromise(resolve => {\n        setTimeout(resolve, delay);\n    });\n}\n\nSyncPromise.hash = function(obj) {\n\n    let results = {};\n    let promises = [];\n\n    for (let key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            promises.push(SyncPromise.resolve(obj[key]).then(result => {\n                results[key] = result;\n            }));\n        }\n    }\n\n    return SyncPromise.all(promises).then(() => {\n        return results;\n    });\n}\n\nSyncPromise.promisifyCall = function() {\n\n    let args = Array.prototype.slice.call(arguments);\n    let method = args.shift();\n\n    if (typeof method !== 'function') {\n        throw new Error(`Expected promisifyCall to be called with a function`);\n    }\n\n    return new SyncPromise((resolve, reject) => {\n\n        args.push((err, result) => {\n            return err ? reject(err) : resolve(result);\n        });\n\n        return method.apply(null, args);\n    });\n}\n\n\nexport function patchPromise() {\n    window.Promise = SyncPromise;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./~/sync-browser-mocks/src/promise.js","\nimport { util } from './util';\nimport { global } from '../global';\nimport { CONSTANTS } from '../conf';\n\nglobal.domainMatches = global.domainMatches || [];\n\nlet domainMatchTimeout;\n\nexport function isSameDomain(win) {\n\n    for (let match of global.domainMatches) {\n        if (match.win === win) {\n            return match.match;\n        }\n    }\n\n    let match;\n\n    try {\n        if (util.getDomain(window) === util.getDomain(win)) {\n            match = true;\n        } else {\n            match = false;\n        }\n    } catch (err) {\n        match = false;\n    }\n\n    global.clean.push(global.domainMatches, { win, match });\n\n    if (!domainMatchTimeout) {\n        domainMatchTimeout = setTimeout(() => {\n            global.domainMatches = [];\n            domainMatchTimeout = null;\n        }, 1);\n    }\n\n    return match;\n}\n\n\nexport function getOpener(win) {\n\n    if (!win) {\n        return;\n    }\n\n    try {\n        return win.opener;\n    } catch (err) {\n        return;\n    }\n}\n\nexport function getParent(win) {\n\n    if (!win) {\n        return;\n    }\n\n    try {\n        if (win.parent && win.parent !== win) {\n            return win.parent;\n        }\n    } catch (err) {\n        return;\n    }\n}\n\n\n\nexport function getParents(win) {\n\n    let result = [];\n\n    try {\n\n        while (win.parent !== win) {\n            result.push(win.parent);\n            win = win.parent;\n        }\n\n    } catch (err) {\n        // pass\n    }\n\n    return result;\n}\n\nexport function isAncestorParent(parent, child) {\n\n    if (!parent || !child) {\n        return false;\n    }\n\n    let childParent = getParent(child);\n\n    if (childParent) {\n        return childParent === parent;\n    }\n\n    if (getParents(child).indexOf(parent) !== -1) {\n        return true;\n    }\n\n    return false;\n}\n\nexport function getFrames(win) {\n\n    let result = [];\n\n    let frames;\n\n    try {\n        frames = win.frames;\n    } catch (err) {\n        frames = win;\n    }\n\n    let len;\n\n    try {\n        len = frames.length;\n    } catch (err) {\n        // pass\n    }\n\n    if (len === 0) {\n        return result;\n    }\n\n    if (len) {\n        for (let i = 0; i < len; i++) {\n\n            let frame;\n\n            try {\n                frame = frames[i];\n            } catch (err) {\n                continue;\n            }\n\n            result.push(frame);\n        }\n\n        return result;\n    }\n\n    for (let i = 0; i < 100; i++) {\n        let frame;\n\n        try {\n            frame = frames[i];\n        } catch (err) {\n            return result;\n        }\n\n        if (!frame) {\n            return result;\n        }\n\n        result.push(frame);\n    }\n\n    return result;\n}\n\n\nexport function getAllChildFrames(win) {\n\n    let result = [];\n\n    for (let frame of getFrames(win)) {\n        result.push(frame);\n\n        for (let childFrame of getAllChildFrames(frame)) {\n            result.push(childFrame);\n        }\n    }\n\n    return result;\n}\n\nexport function getAllFramesInWindow(win) {\n\n    let result = getAllChildFrames(win);\n\n    result.push(win);\n\n    for (let parent of getParents(win)) {\n\n        result.push(parent);\n\n        for (let frame of getFrames(parent)) {\n\n            if (result.indexOf(frame) === -1) {\n                result.push(frame);\n            }\n        }\n    }\n\n    return result;\n}\n\nexport function getTop(win) {\n\n    if (!win) {\n        return;\n    }\n\n    try {\n        if (win.top) {\n            return win.top;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    if (getParent(win) === win) {\n        return win;\n    }\n\n    try {\n        if (isAncestorParent(window, win)) {\n            return window.top;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    try {\n        if (isAncestorParent(win, window)) {\n            return window.top;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    for (let frame of getAllChildFrames(win)) {\n        try {\n            if (frame.top) {\n                return frame.top;\n            }\n        } catch (err) {\n            // pass\n        }\n\n        if (getParent(frame) === frame) {\n            return frame;\n        }\n    }\n}\n\n\nexport function isWindowClosed(win, allowMock = true) {\n\n    try {\n        if (win === window) {\n            return false;\n        }\n    } catch (err) {\n        return true;\n    }\n\n\n    try {\n        if (!win) {\n            return true;\n        }\n\n    } catch (err) {\n        return true;\n    }\n\n    try {\n        if (win.closed) {\n            return true;\n        }\n\n    } catch (err) {\n\n        // I love you so much IE\n\n        if (err && err.message === 'Call was rejected by callee.\\r\\n') {\n            return false;\n        }\n\n        return true;\n    }\n\n\n    if (allowMock && isSameDomain(win) && util.safeGet(win, 'mockclosed')) {\n        return true;\n    }\n\n    /*\n\n    // IE9... don't even ask. If an iframe is removed from the parent page, .closed does not get set to true\n\n    try {\n        if (win.parent === win && !getOpener(win) && win !== getTop(window)) {\n            // return true;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    */\n\n\n    return false;\n}\n\nexport function getUserAgent(win) {\n    win = win || window;\n    return win.navigator.mockUserAgent || win.navigator.userAgent;\n}\n\n\nexport function getFrameByName(win, name) {\n\n    let winFrames = getFrames(win);\n\n    for (let childFrame of winFrames) {\n        try {\n            if (isSameDomain(childFrame) && childFrame.name === name && winFrames.indexOf(childFrame) !== -1) {\n                return childFrame;\n            }\n        } catch (err) {\n            // pass\n        }\n    }\n\n    try {\n        if (winFrames.indexOf(win.frames[name]) !== -1) {\n            return win.frames[name];\n        }\n    } catch (err) {\n        // pass\n    }\n\n    try {\n        if (winFrames.indexOf(win[name]) !== -1) {\n            return win[name];\n        }\n    } catch (err) {\n        // pass\n    }\n}\n\nexport function findChildFrameByName(win, name) {\n\n    let frame = getFrameByName(win, name);\n\n    if (frame) {\n        return frame;\n    }\n\n    for (let childFrame of getFrames(win)) {\n        let namedFrame = findChildFrameByName(childFrame, name);\n\n        if (namedFrame) {\n            return namedFrame;\n        }\n    }\n}\n\nexport function findFrameByName(win, name) {\n\n    let frame;\n\n    frame = getFrameByName(win, name);\n\n    if (frame) {\n        return frame;\n    }\n\n    return findChildFrameByName(getTop(win), name);\n}\n\nexport function isParent(win, frame) {\n\n    let frameParent = getParent(frame);\n\n    if (frameParent) {\n        return frameParent === win;\n    }\n\n    for (let childFrame of getFrames(win)) {\n        if (childFrame === frame) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function isOpener(parent, child) {\n\n    return parent === getOpener(child);\n}\n\nexport function getAncestor(win) {\n    win = win || window;\n\n    let opener = getOpener(win);\n\n    if (opener) {\n        return opener;\n    }\n\n    let parent = getParent(win);\n\n    if (parent) {\n        return parent;\n    }\n}\n\nexport function getAncestors(win) {\n\n    let results = [];\n\n    let ancestor = win;\n\n    while (ancestor) {\n        ancestor = getAncestor(ancestor);\n        if (ancestor) {\n            results.push(ancestor);\n        }\n    }\n\n    return results;\n}\n\n\nexport function isAncestor(parent, child) {\n\n    let actualParent = getAncestor(child);\n\n    if (actualParent) {\n        if (actualParent === parent) {\n            return true;\n        }\n\n        return false;\n    }\n\n    if (child === parent) {\n        return false;\n    }\n\n    if (getTop(child) === child) {\n        return false;\n    }\n\n    for (let frame of getFrames(parent)) {\n        if (frame === child) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function isPopup() {\n    return Boolean(getOpener(window));\n}\n\nexport function isIframe() {\n    return Boolean(getParent(window));\n}\n\nexport function isFullpage() {\n    return Boolean(!isIframe() && !isPopup());\n}\n\nexport function getWindowType() {\n    if (isPopup()) {\n        return CONSTANTS.WINDOW_TYPES.POPUP;\n    }\n    if (isIframe()) {\n        return CONSTANTS.WINDOW_TYPES.IFRAME;\n    }\n    return CONSTANTS.WINDOW_TYPES.FULLPAGE;\n}\n\n\nfunction anyMatch(collection1, collection2) {\n\n    for (let item1 of collection1) {\n        for (let item2 of collection2) {\n            if (item1 === item2) {\n                return true;\n            }\n        }\n    }\n}\n\nexport function isSameTopWindow(win1, win2) {\n\n    let top1 = getTop(win1);\n    let top2 = getTop(win2);\n\n    try {\n        if (top1 && top2) {\n            if (top1 === top2) {\n                return true;\n            }\n\n            return false;\n        }\n    } catch (err) {\n        // pass\n    }\n\n    let allFrames1 = getAllFramesInWindow(win1);\n    let allFrames2 = getAllFramesInWindow(win2);\n\n    if (anyMatch(allFrames1, allFrames2)) {\n        return true;\n    }\n\n    let opener1 = getOpener(top1);\n    let opener2 = getOpener(top2);\n\n    if (opener1 && anyMatch(getAllFramesInWindow(opener1), allFrames2)) {\n        return false;\n    }\n\n    if (opener2 && anyMatch(getAllFramesInWindow(opener2), allFrames1)) {\n        return false;\n    }\n}\n\nexport function jsonStringify() {\n\n    let objectToJSON;\n    let arrayToJSON;\n\n    try {\n        if (JSON.stringify({}) !== '{}') {\n            objectToJSON = Object.prototype.toJSON;\n            delete Object.prototype.toJSON;\n        }\n\n        if (JSON.stringify({}) !== '{}') {\n            throw new Error(`Can not correctly serialize JSON objects`);\n        }\n\n        if (JSON.stringify([]) !== '[]') {\n            arrayToJSON  = Array.prototype.toJSON;\n            delete Array.prototype.toJSON;\n        }\n\n        if (JSON.stringify([]) !== '[]') {\n            throw new Error(`Can not correctly serialize JSON objects`);\n        }\n\n    } catch (err) {\n        throw new Error(`Can not repair JSON.stringify: ${err.message}`);\n    }\n\n    let result = JSON.stringify.apply(this, arguments);\n\n    try {\n        if (objectToJSON) {\n            Object.prototype.toJSON = objectToJSON; // eslint-disable-line\n        }\n\n        if (arrayToJSON) {\n            Array.prototype.toJSON = arrayToJSON; // eslint-disable-line\n        }\n\n    } catch (err) {\n        throw new Error(`Can not repair JSON.stringify: ${err.message}`);\n    }\n\n\n    return result;\n}\n\nexport function jsonParse() {\n    return JSON.parse.apply(this, arguments);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/windows.js","\nimport { CONFIG, CONSTANTS } from '../conf';\nimport { util, promise, isSameDomain, isOpener, isSameTopWindow, getUserAgent } from '../lib';\nimport { global } from '../global';\nimport { receiveMessage } from '../drivers';\n\nexport function needsBridgeForBrowser() {\n\n    if (getUserAgent(window).match(/MSIE|trident|edge/i)) {\n        return true;\n    }\n\n    if (!CONFIG.ALLOW_POSTMESSAGE_POPUP) {\n        return true;\n    }\n\n    return false;\n}\n\nexport function needsBridgeForWin(win) {\n\n    if (win && isSameTopWindow(window, win)) {\n        return false;\n    }\n\n    if (win && isSameDomain(win)) {\n        return false;\n    }\n\n    return true;\n}\n\nexport function needsBridgeForDomain(domain) {\n\n    if (domain && util.getDomain() === util.getDomainFromUrl(domain)) {\n        return false;\n    }\n\n    return true;\n}\n\nexport function needsBridge({ win, domain }) {\n    return needsBridgeForBrowser() && needsBridgeForWin(win) && needsBridgeForDomain(domain);\n}\n\nexport function getBridgeName(domain) {\n\n    domain = domain || util.getDomainFromUrl(domain);\n\n    let sanitizedDomain = domain.replace(/[^a-zA-Z0-9]+/g, '_');\n\n    let id = `${CONSTANTS.BRIDGE_NAME_PREFIX}_${sanitizedDomain}`;\n\n    return id;\n}\n\nexport function isBridge() {\n    return window.name && window.name === getBridgeName(util.getDomain());\n}\n\nexport let documentBodyReady = new promise.Promise(resolve => {\n\n    if (window.document && window.document.body) {\n        return resolve(window.document.body);\n    }\n\n    let interval = setInterval(() => {\n        if (window.document && window.document.body) {\n            clearInterval(interval);\n            return resolve(window.document.body);\n        }\n    }, 10);\n});\n\nglobal.remoteWindows = global.remoteWindows || [];\n\nexport function registerRemoteWindow(win, timeout = CONFIG.BRIDGE_TIMEOUT) {\n    let sendMessagePromise = new promise.Promise();\n    global.clean.push(global.remoteWindows, { win, sendMessagePromise });\n}\n\nexport function findRemoteWindow(win) {\n    for (let i = 0; i < global.remoteWindows.length; i++) {\n        if (global.remoteWindows[i].win === win) {\n            return global.remoteWindows[i];\n        }\n    }\n}\n\nexport function registerRemoteSendMessage(win, domain, sendMessage) {\n\n    let remoteWindow = findRemoteWindow(win);\n\n    if (!remoteWindow) {\n        throw new Error(`Window not found to register sendMessage to`);\n    }\n\n    let sendMessageWrapper = (remoteWin, message, remoteDomain) => {\n\n        if (remoteWin !== win) {\n            throw new Error(`Remote window does not match window`);\n        }\n\n        if (remoteDomain !== `*` && remoteDomain !== domain) {\n            throw new Error(`Remote domain ${remoteDomain} does not match domain ${domain}`);\n        }\n\n        sendMessage(message);\n    };\n\n    remoteWindow.sendMessagePromise.resolve(sendMessageWrapper);\n    remoteWindow.sendMessagePromise = promise.Promise.resolve(sendMessageWrapper);\n}\n\nexport function rejectRemoteSendMessage(win, err) {\n\n    let remoteWindow = findRemoteWindow(win);\n\n    if (!remoteWindow) {\n        throw new Error(`Window not found on which to reject sendMessage`);\n    }\n\n    remoteWindow.sendMessagePromise.asyncReject(err);\n}\n\nexport function sendBridgeMessage(win, message, domain) {\n\n    let messagingChild  = isOpener(window, win);\n    let messagingParent = isOpener(win, window);\n\n    if (!messagingChild && !messagingParent) {\n        throw new Error(`Can only send messages to and from parent and popup windows`);\n    }\n\n    let remoteWindow = findRemoteWindow(win);\n\n    if (!remoteWindow) {\n        throw new Error(`Window not found to send message to`);\n    }\n\n    return remoteWindow.sendMessagePromise.then(sendMessage => {\n        return sendMessage(win, message, domain);\n    });\n}\n\nglobal.receiveMessage = function(event) {\n    return receiveMessage(event);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/bridge/common.js","\nexport * from './bridge';\nexport * from './child';\nexport * from './common';\nexport * from './parent';\n\n\n\n// WEBPACK FOOTER //\n// ./src/bridge/index.js","\nimport { util } from './util';\nimport { getWindowType, jsonStringify } from './windows';\nimport { CONFIG } from '../conf';\n\nconst LOG_LEVELS = ['debug', 'info', 'warn', 'error'];\n\nif (Function.prototype.bind && window.console && typeof console.log === 'object') {\n    [ 'log', 'info', 'warn', 'error' ].forEach(function(method) {\n        console[method] = this.bind(console[method], console);\n    }, Function.prototype.call);\n}\n\nexport let log = {\n\n    clearLogs() {\n\n        if (window.console && window.console.clear) {\n            window.console.clear();\n        }\n\n        if (CONFIG.LOG_TO_PAGE) {\n            let container = document.getElementById('postRobotLogs');\n\n            if (container) {\n                container.parentNode.removeChild(container);\n            }\n        }\n    },\n\n    writeToPage(level, args) {\n        setTimeout(() => {\n            let container = document.getElementById('postRobotLogs');\n\n            if (!container) {\n                container = document.createElement('div');\n                container.id = 'postRobotLogs';\n                container.style.cssText = 'width: 800px; font-family: monospace; white-space: pre-wrap;';\n                document.body.appendChild(container);\n            }\n\n            let el = document.createElement('div');\n\n            let date = (new Date()).toString().split(' ')[4];\n\n            let payload = util.map(args, item => {\n                if (typeof item === 'string') {\n                    return item;\n                }\n                if (!item) {\n                    return Object.prototype.toString.call(item);\n                }\n                let json;\n                try {\n                    json = jsonStringify(item, 0, 2);\n                } catch (e) {\n                    json = '[object]';\n                }\n\n                return `\\n\\n${json}\\n\\n`;\n            }).join(' ');\n\n\n            let msg = `${date} ${level} ${payload}`;\n            el.innerHTML = msg;\n\n            let color = {\n                log: '#ddd',\n                warn: 'orange',\n                error: 'red',\n                info: 'blue',\n                debug: '#aaa'\n            }[level];\n\n            el.style.cssText = `margin-top: 10px; color: ${color};`;\n\n            if (!container.childNodes.length) {\n                container.appendChild(el);\n            } else {\n                container.insertBefore(el, container.childNodes[0]);\n            }\n\n        });\n    },\n\n    logLevel(level, args) {\n        setTimeout(() => {\n            try {\n                if (LOG_LEVELS.indexOf(level) < LOG_LEVELS.indexOf(CONFIG.LOG_LEVEL)) {\n                    return;\n                }\n\n                args = Array.prototype.slice.call(args);\n\n                args.unshift(`${window.location.host}${window.location.pathname}`);\n                args.unshift(`::`);\n                args.unshift(`${getWindowType().toLowerCase()}`);\n                args.unshift('[post-robot]');\n\n                if (CONFIG.LOG_TO_PAGE) {\n                    log.writeToPage(level, args);\n                }\n\n                if (!window.console) {\n                    return;\n                }\n\n                if (!window.console[level]) {\n                    level = 'log';\n                }\n\n                if (!window.console[level]) {\n                    return;\n                }\n\n                window.console[level].apply(window.console, args);\n\n            } catch (err) {\n                // pass\n            }\n        }, 1);\n    },\n\n    debug() {\n        log.logLevel('debug', arguments);\n    },\n\n    info() {\n        log.logLevel('info', arguments);\n    },\n\n    warn() {\n        log.logLevel('warn', arguments);\n    },\n\n    error() {\n        log.logLevel('error', arguments);\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/lib/log.js","\nexport * from './ie';\n\n\n// WEBPACK FOOTER //\n// ./src/compat/index.js","\nexport let CONSTANTS = {\n\n    POST_MESSAGE_TYPE: {\n        REQUEST: 'postrobot_message_request',\n        RESPONSE: 'postrobot_message_response',\n        ACK: 'postrobot_message_ack'\n    },\n\n    POST_MESSAGE_ACK: {\n        SUCCESS: 'success',\n        ERROR: 'error'\n    },\n\n    POST_MESSAGE_NAMES: {\n        METHOD: 'postrobot_method',\n        READY: 'postrobot_ready',\n        OPEN_TUNNEL: 'postrobot_open_tunnel'\n    },\n\n    WINDOW_TYPES: {\n        FULLPAGE: 'fullpage',\n        POPUP: 'popup',\n        IFRAME: 'iframe'\n    },\n\n    WINDOW_PROPS: {\n        POSTROBOT: '__postRobot__'\n    },\n\n    SERIALIZATION_TYPES: {\n        METHOD: 'postrobot_method',\n        ERROR: 'postrobot_error'\n    },\n\n    SEND_STRATEGIES: {\n        POST_MESSAGE: 'postrobot_post_message',\n        BRIDGE: 'postrobot_bridge',\n        GLOBAL: 'postrobot_global'\n    },\n\n    MOCK_PROTOCOL: 'mock:',\n    FILE_PROTOCOL: 'file:',\n\n    BRIDGE_NAME_PREFIX: '__postrobot_bridge__',\n    POSTROBOT_PROXY: '__postrobot_proxy__'\n};\n\nexport let POST_MESSAGE_NAMES_LIST = Object.keys(CONSTANTS.POST_MESSAGE_NAMES).map(key => CONSTANTS.POST_MESSAGE_NAMES[key]);\n\n\n\n// WEBPACK FOOTER //\n// ./src/conf/constants.js","\nimport { global } from '../global';\n\nglobal.listeners = global.listeners || {\n    request: [],\n    response: []\n};\n\nexport let listeners = global.listeners;\n\nexport function resetListeners() {\n    global.listeners.request = [];\n    global.listeners.response = [];\n}\n\nfunction isRegex(item) {\n    return Object.prototype.toString.call(item) === '[object RegExp]';\n}\n\nfunction matchDomain(domain, origin) {\n\n    if (typeof domain === 'string') {\n\n        if (isRegex(origin)) {\n            return false;\n        }\n\n        if (Array.isArray(origin)) {\n            return false;\n        }\n\n        return domain === '*' || origin === domain;\n    }\n\n    if (isRegex(domain)) {\n\n        if (isRegex(origin)) {\n            return domain.toString() === origin.toString();\n        }\n\n        if (Array.isArray(origin)) {\n            return false;\n        }\n\n        return origin.match(domain);\n    }\n\n    if (Array.isArray(domain)) {\n\n        if (isRegex(origin)) {\n            return false;\n        }\n\n        if (Array.isArray(origin)) {\n            return JSON.stringify(domain) === JSON.stringify(origin);\n        }\n\n        return domain.indexOf(origin) !== -1;\n    }\n\n    return false;\n}\n\nexport function getRequestListener(name, win, domain) {\n\n    let result = {};\n\n    for (let requestListener of global.listeners.request) {\n\n        if (requestListener.name !== name) {\n            continue;\n        }\n\n        let specifiedWin = (requestListener.win && requestListener.win !== '*');\n        let specifiedDomain = (requestListener.domain && requestListener.domain !== '*');\n\n        let matchedWin = (specifiedWin && requestListener.win === win);\n        let matchedDomain = (specifiedDomain && matchDomain(requestListener.domain, domain));\n\n        if (specifiedWin && specifiedDomain) {\n            if (matchedWin && matchedDomain) {\n                result.all = result.all || requestListener.options;\n            }\n        } else if (specifiedDomain) {\n            if (matchedDomain) {\n                result.domain = result.domain || requestListener.options;\n            }\n        } else if (specifiedWin) {\n            if (matchedWin) {\n                result.win = result.win || requestListener.options;\n            }\n        } else {\n            result.name = result.name || requestListener.options;\n        }\n    }\n\n    return result.all || result.domain || result.win || result.name;\n}\n\nexport function removeRequestListener(options) {\n\n    for (let listener of global.listeners.request) {\n        if (listener.options === options) {\n            global.listeners.request.splice(global.listeners.request.indexOf(listener), 1);\n        }\n    }\n}\n\nexport function addRequestListener(name, win, domain, options, override) {\n\n    let listener = getRequestListener(name, win, domain);\n\n    if (listener) {\n        if (override) {\n            removeRequestListener(listener);\n        } else {\n\n            if (win) {\n                throw new Error(`Request listener already exists for ${name} on domain ${domain} for specified window: ${listener.win === win}`);\n            }\n\n            throw new Error(`Request listener already exists for ${name} on domain ${domain}`);\n        }\n    }\n\n    global.clean.push(global.listeners.request, { name, win, domain, options });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/drivers/listeners.js","\nimport { CONSTANTS, CONFIG, POST_MESSAGE_NAMES_LIST } from '../../conf';\nimport { util, promise, serializeMethods, log, isWindowClosed, getWindowType, jsonStringify } from '../../lib';\n\nimport { SEND_MESSAGE_STRATEGIES } from './strategies';\n\n\nexport function buildMessage(win, message, options = {}) {\n\n    let id   = util.uniqueID();\n    let type = getWindowType();\n    let sourceDomain = util.getDomain(window);\n\n    return {\n        ...message,\n        ...options,\n        sourceDomain,\n        id:         message.id || id,\n        windowType: type\n    };\n}\n\n\nexport function sendMessage(win, message, domain) {\n    return promise.run(() => {\n\n        message = buildMessage(win, message, {\n            data: serializeMethods(win, domain, message.data),\n            domain\n        });\n\n        let level;\n\n        if (POST_MESSAGE_NAMES_LIST.indexOf(message.name) !== -1 || message.type === CONSTANTS.POST_MESSAGE_TYPE.ACK) {\n            level = 'debug';\n        } else if (message.ack === 'error') {\n            level = 'error';\n        } else {\n            level = 'info';\n        }\n\n        log.logLevel(level, [ '\\n\\n\\t', '#send', message.type.replace(/^postrobot_message_/, ''), '::', message.name, '::', domain || '*', '\\n\\n', message ]);\n\n        if (CONFIG.MOCK_MODE) {\n            delete message.target;\n            return window[CONSTANTS.WINDOW_PROPS.POSTROBOT].postMessage({\n                origin: util.getDomain(window),\n                source: window,\n                data: jsonStringify(message, 0, 2)\n            });\n        }\n\n        if (win === window) {\n            throw new Error('Attemping to send message to self');\n        }\n\n        if (isWindowClosed(win)) {\n            throw new Error('Window is closed');\n        }\n\n        log.debug('Running send message strategies', message);\n\n        let messages = [];\n\n        let serializedMessage = jsonStringify({\n            [ CONSTANTS.WINDOW_PROPS.POSTROBOT ]: message\n        }, 0, 2);\n\n        return promise.map(Object.keys(SEND_MESSAGE_STRATEGIES), strategyName => {\n\n            return promise.run(() => {\n\n                if (!CONFIG.ALLOWED_POST_MESSAGE_METHODS[strategyName]) {\n                    throw new Error(`Strategy disallowed: ${strategyName}`);\n                }\n\n                return SEND_MESSAGE_STRATEGIES[strategyName](win, serializedMessage, domain);\n\n            }).then(() => {\n                messages.push(`${strategyName}: success`);\n                return true;\n            }, err => {\n                messages.push(`${strategyName}: ${err.stack || err.toString()}\\n`);\n                return false;\n            });\n\n        }).then(results => {\n\n            let success = util.some(results);\n            let status = `${message.type} ${message.name} ${success ? 'success' : 'error'}:\\n  - ${messages.join('\\n  - ')}\\n`;\n\n            log.debug(status);\n\n            if (!success) {\n                throw new Error(status);\n            }\n        });\n    });\n}\n\n\n// WEBPACK FOOTER //\n// ./src/drivers/send/index.js","\nimport { SyncPromise as Promise } from 'sync-browser-mocks/src/promise';\n\nexport function cleanup(obj) {\n\n    let tasks = [];\n\n    return {\n\n        getters: {\n            array:  () => { return []; },\n            object: () => { return {}; }\n        },\n\n        set(name, item) {\n            obj[name] = item;\n            this.register(() => {\n                delete obj[name];\n            });\n            return item;\n        },\n\n        push(collection, item) {\n            collection.push(item);\n            this.register(() => {\n                let index = collection.indexOf(item);\n                if (index !== -1) {\n                    collection.splice(index, 1);\n                }\n            });\n            return item;\n        },\n\n        setItem(mapping, key, item) {\n            mapping[key] = item;\n            this.register(() => {\n                delete mapping[key];\n            });\n            return item;\n        },\n\n        register(name, method) {\n\n            if (!method) {\n                method = name;\n                name = undefined;\n            }\n\n            tasks.push({\n                complete: false,\n\n                name,\n\n                run() {\n\n                    if (this.complete) {\n                        return;\n                    }\n\n                    this.complete = true;\n\n                    return method();\n                }\n            });\n        },\n\n        hasTasks() {\n            return Boolean(tasks.filter(item => !item.complete).length);\n        },\n\n        all() {\n            let results = [];\n\n            while (tasks.length) {\n                results.push(tasks.pop().run());\n            }\n\n            return Promise.all(results).then(() => {\n                return;\n            });\n        },\n\n        run(name) {\n            let results = [];\n            let toClean = [];\n\n            for (let item of tasks) {\n                if (item.name === name) {\n                    toClean.push(item);\n                    results.push(item.run());\n                }\n            }\n\n            for (let item of toClean) {\n                tasks.splice(tasks.indexOf(item), 1);\n            }\n\n            return Promise.all(results).then(() => {\n                return;\n            });\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/cleanup.js","\nimport { SyncPromise } from 'sync-browser-mocks/src/promise';\nimport { nextTick } from './tick';\n\nexport let Promise = SyncPromise;\n\nexport let promise = {\n\n    Promise,\n\n    run(method) {\n        return Promise.resolve().then(method);\n    },\n\n    nextTick(method) {\n        return new Promise((resolve, reject) => {\n            nextTick(() => {\n                return promise.run(method).then(resolve, reject);\n            });\n        });\n    },\n\n    method(method) {\n        return function promiseWrapper() {\n            return Promise.resolve().then(() => {\n                return method.apply(this, arguments);\n            });\n        };\n    },\n\n    nodeify(prom, callback) {\n        if (!callback) {\n            return prom;\n        }\n        prom.then(result => {\n            callback(null, result);\n        }, err => {\n            callback(err);\n        });\n    },\n\n    deNodeify(method, ...args) {\n        return new Promise((resolve, reject) => {\n            try {\n                if (args.length < method.length) {\n                    return method(...args, (err, result) => {\n                        return err ? reject(err) : resolve(result);\n                    });\n                }\n\n                return promise.run(() => {\n                    return method(...args);\n                }).then(resolve, reject);\n\n            } catch (err) {\n                return reject(err);\n            }\n        });\n    },\n\n    map(items, method) {\n\n        let results = [];\n        for (let i = 0; i < items.length; i++) {\n            results.push(promise.run(() => {\n                return method(items[i]);\n            }));\n        }\n        return Promise.all(results);\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/lib/promise.js","\nimport { util } from './util';\n\nlet tickMessageName = `__nextTick__postRobot__${util.uniqueID()}`;\nlet queue = [];\n\nwindow.addEventListener('message', event => {\n    if (event.data === tickMessageName) {\n        let method = queue.shift();\n        method.call();\n    }\n});\n\nexport function nextTick(method) {\n\n    queue.push(method);\n    window.postMessage(tickMessageName, '*');\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/tick.js","\nimport { CONSTANTS } from '../conf';\nimport { getParent, isWindowClosed } from '../lib';\nimport { global } from '../global';\nimport { send } from '../interface';\n\nglobal.openTunnelToParent = function openTunnelToParent({ name, source, canary, sendMessage }) {\n\n    let remoteWindow = getParent(window);\n\n    if (!remoteWindow) {\n        throw new Error(`No parent window found to open tunnel to`);\n    }\n\n    return send(remoteWindow, CONSTANTS.POST_MESSAGE_NAMES.OPEN_TUNNEL, {\n        name,\n        sendMessage() {\n\n            if (isWindowClosed(source)) {\n                return;\n            }\n\n            try {\n                canary();\n            } catch (err) {\n                return;\n            }\n\n            sendMessage.apply(this, arguments);\n        }\n    }, { domain: '*' });\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/bridge/bridge.js","\nimport { SyncPromise as Promise } from 'sync-browser-mocks/src/promise';\nimport { CONSTANTS } from '../conf';\nimport { isSameDomain, getOpener, getFrames, util, getFrameByName } from '../lib';\nimport { receiveMessage } from '../drivers';\n\nimport { needsBridge, registerRemoteWindow, rejectRemoteSendMessage, registerRemoteSendMessage, getBridgeName } from './common';\n\nfunction getRemoteBridgeForWindow(win) {\n    return Promise.try(() => {\n        for (let frame of getFrames(win)) {\n            try {\n                if (frame && frame !== window && isSameDomain(frame) && frame[CONSTANTS.WINDOW_PROPS.POSTROBOT]) {\n                    return frame;\n                }\n\n            } catch (err) {\n                continue;\n            }\n        }\n\n        try {\n            let frame = getFrameByName(win, getBridgeName(util.getDomain()));\n\n            if (!frame) {\n                return;\n            }\n\n            if (isSameDomain(frame) && frame[CONSTANTS.WINDOW_PROPS.POSTROBOT]) {\n                return frame;\n            }\n\n            return new Promise(resolve => {\n\n                let interval;\n                let timeout;\n\n                interval = setInterval(() => {\n                    if (isSameDomain(frame) && frame[CONSTANTS.WINDOW_PROPS.POSTROBOT]) {\n                        clearInterval(interval);\n                        clearTimeout(timeout);\n                        return resolve(frame);\n                    }\n\n                    setTimeout(() => {\n                        clearInterval(interval);\n                        return resolve();\n                    }, 2000);\n                }, 100);\n            });\n\n        } catch (err) {\n            return;\n        }\n    });\n}\n\nexport function openTunnelToOpener() {\n    return Promise.try(() => {\n\n        let opener = getOpener(window);\n\n        if (!opener) {\n            return;\n        }\n\n        if (!needsBridge({ win: opener })) {\n            return;\n        }\n\n        registerRemoteWindow(opener);\n\n        return getRemoteBridgeForWindow(opener).then(bridge => {\n\n            if (!bridge) {\n                return rejectRemoteSendMessage(opener, new Error(`Can not register with opener: no bridge found in opener`));\n            }\n\n            if (!window.name) {\n                return rejectRemoteSendMessage(opener, new Error(`Can not register with opener: window does not have a name`));\n            }\n\n            return bridge[CONSTANTS.WINDOW_PROPS.POSTROBOT].openTunnelToParent({\n\n                name: window.name,\n\n                source: window,\n\n                canary() {\n                    // pass\n                },\n\n                sendMessage(message) {\n\n                    if (!window || window.closed) {\n                        return;\n                    }\n\n                    receiveMessage({\n                        data:   message,\n                        origin: this.origin,\n                        source: this.source\n                    });\n                }\n\n            }).then(({ source, origin, data }) => {\n\n                if (source !== opener) {\n                    throw new Error(`Source does not match opener`);\n                }\n\n                registerRemoteSendMessage(source, origin, data.sendMessage);\n\n            }).catch(err => {\n\n                rejectRemoteSendMessage(opener, err);\n                throw err;\n            });\n        });\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/bridge/child.js","\nimport { CONFIG, CONSTANTS } from '../conf';\nimport { util, promise, log, onWindowReady, getFrameByName } from '../lib';\nimport { global } from '../global';\nimport { on } from '../interface';\nimport { receiveMessage } from '../drivers';\n\nglobal.bridges = global.bridges || {};\n\nimport { getBridgeName, documentBodyReady, registerRemoteSendMessage, registerRemoteWindow } from './common';\n\nfunction listenForRegister(source, domain) {\n    on(CONSTANTS.POST_MESSAGE_NAMES.OPEN_TUNNEL, { source, domain }, ({ origin, data }) => {\n\n        if (origin !== domain) {\n            throw new Error(`Domain ${domain} does not match origin ${origin}`);\n        }\n\n        if (!data.name) {\n            throw new Error(`Register window expected to be passed window name`);\n        }\n\n        if (!data.sendMessage) {\n            throw new Error(`Register window expected to be passed sendMessage method`);\n        }\n\n        let winDetails = global.popupWindows[data.name];\n\n        if (!winDetails) {\n            throw new Error(`Window with name ${data.name} does not exist, or was not opened by this window`);\n        }\n\n        if (!winDetails.domain) {\n            throw new Error(`We do not have a registered domain for window ${data.name}`);\n        }\n\n        if (winDetails.domain !== origin) {\n            throw new Error(`Message origin ${origin} does not matched registered window origin ${winDetails.domain}`);\n        }\n\n        registerRemoteSendMessage(winDetails.win, domain, data.sendMessage);\n\n        return {\n            sendMessage(message) {\n\n                if (!window || window.closed) {\n                    return;\n                }\n\n                receiveMessage({\n                    data:   message,\n                    origin: winDetails.domain,\n                    source: winDetails.win\n                });\n            }\n        };\n    });\n}\n\nfunction openBridgeFrame(name, url) {\n\n    log.debug(`Opening bridge:`, name, url);\n\n    let iframe = document.createElement(`iframe`);\n\n    iframe.setAttribute(`name`, name);\n    iframe.setAttribute(`id`,   name);\n\n    iframe.setAttribute(`style`, `display: none; margin: 0; padding: 0; border: 0px none; overflow: hidden;`);\n    iframe.setAttribute(`frameborder`, `0`);\n    iframe.setAttribute(`border`, `0`);\n    iframe.setAttribute(`scrolling`, `no`);\n    iframe.setAttribute(`allowTransparency`, `true`);\n\n    iframe.setAttribute(`tabindex`, `-1`);\n    iframe.setAttribute(`hidden`, `true`);\n    iframe.setAttribute(`title`, ``);\n    iframe.setAttribute(`role`, `presentation`);\n\n    iframe.src = url;\n\n    return iframe;\n}\n\nexport function openBridge(url, domain) {\n\n    domain = domain || util.getDomainFromUrl(url);\n\n    if (global.bridges[domain]) {\n        return global.bridges[domain];\n    }\n\n    return global.clean.setItem(global.bridges, domain, promise.run(() => {\n\n        if (util.getDomain() === domain) {\n            throw new Error(`Can not open bridge on the same domain as current domain: ${domain}`);\n        }\n\n        let name  = getBridgeName(domain);\n        let frame = getFrameByName(window, name);\n\n        if (frame) {\n            throw new Error(`Frame with name ${name} already exists on page`);\n        }\n\n        let iframe = openBridgeFrame(name, url);\n\n        return documentBodyReady.then(body => {\n\n            return new promise.Promise((resolve, reject) => {\n\n                setTimeout(resolve, 1);\n\n            }).then(() => {\n\n                body.appendChild(iframe);\n\n                global.clean.register('bridgeFrames', () => {\n                    body.removeChild(iframe);\n                    delete global.bridges[domain];\n                });\n\n                let bridge = iframe.contentWindow;\n\n                listenForRegister(bridge, domain);\n\n                return new promise.Promise((resolve, reject) => {\n\n                    iframe.onload = resolve;\n                    iframe.onerror = reject;\n\n                }).then(() => {\n\n                    return onWindowReady(bridge, CONFIG.BRIDGE_TIMEOUT, `Bridge ${url}`);\n\n                }).then(() => {\n\n                    return bridge;\n                });\n            });\n        });\n    }));\n}\n\nexport function destroyBridges() {\n    return global.clean.run('bridgeFrames');\n}\n\nglobal.popupWindows = global.popupWindows || {};\n\nlet windowOpen = window.open;\n\nwindow.open = function(url, name, options, last) {\n\n    let domain = url;\n\n    if (url && url.indexOf(CONSTANTS.MOCK_PROTOCOL) === 0) {\n        [ domain, url ] = url.split('|');\n    }\n\n    if (domain) {\n        domain = util.getDomainFromUrl(domain);\n    }\n\n    let win = windowOpen.call(this, url, name, options, last);\n\n    if (url) {\n        registerRemoteWindow(win);\n    }\n\n    if (name) {\n        global.clean.setItem(global.popupWindows, name, { win, domain });\n    }\n\n    return win;\n};\n\nexport function linkUrl(win, url) {\n\n    for (let name of Object.keys(global.popupWindows)) {\n        let winOptions = global.popupWindows[name];\n\n        if (winOptions.win === win) {\n            winOptions.domain = util.getDomainFromUrl(url);\n\n            registerRemoteWindow(win);\n\n            break;\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/bridge/parent.js","\nimport { CONFIG } from '../conf';\nimport { isSameTopWindow } from '../lib';\n\nexport function emulateIERestrictions(sourceWindow, targetWindow) {\n    if (!CONFIG.ALLOW_POSTMESSAGE_POPUP) {\n\n        if (isSameTopWindow(sourceWindow, targetWindow) === false) {\n            throw new Error(`Can not send and receive post messages between two different windows (disabled to emulate IE)`);\n        }\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/compat/ie.js","\nimport { CONSTANTS } from './constants';\n\nexport let CONFIG = {\n    \n    ALLOW_POSTMESSAGE_POPUP: __TEST__ ? false : true,\n\n    LOG_LEVEL: 'info',\n\n    BRIDGE_TIMEOUT: 5000,\n    ACK_TIMEOUT: 1000,\n\n    LOG_TO_PAGE: false,\n    \n    MOCK_MODE: false,\n\n    ALLOWED_POST_MESSAGE_METHODS: {\n        [ CONSTANTS.SEND_STRATEGIES.POST_MESSAGE ]: true,\n        [ CONSTANTS.SEND_STRATEGIES.BRIDGE ]: true,\n        [ CONSTANTS.SEND_STRATEGIES.GLOBAL ]: true\n    }\n};\n\nif (window.location.href.indexOf(CONSTANTS.FILE_PROTOCOL) === 0) {\n    CONFIG.ALLOW_POSTMESSAGE_POPUP = true;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/conf/config.js","\nimport { CONSTANTS, POST_MESSAGE_NAMES_LIST } from '../../conf';\nimport { deserializeMethods, log, isWindowClosed, jsonParse, util } from '../../lib';\nimport { emulateIERestrictions } from '../../compat';\nimport { global } from '../../global';\n\nimport { RECEIVE_MESSAGE_TYPES } from './types';\n\nglobal.receivedMessages = global.receivedMessages || [];\n\nfunction parseMessage(message) {\n\n    try {\n        message = jsonParse(message);\n    } catch (err) {\n        return;\n    }\n\n    if (!message) {\n        return;\n    }\n\n    message = message[CONSTANTS.WINDOW_PROPS.POSTROBOT];\n\n    if (!message) {\n        return;\n    }\n\n    if (!message.type) {\n        return;\n    }\n\n    if (!RECEIVE_MESSAGE_TYPES[message.type]) {\n        return;\n    }\n\n    return message;\n}\n\n\nexport function receiveMessage(event) {\n\n    if (!window || window.closed) {\n        throw new Error(`Message recieved in closed window`);\n    }\n\n    try {\n        if (!event.source) {\n            return;\n        }\n    } catch (err) {\n        return;\n    }\n\n    let { source, origin, data } = event;\n\n    let message = parseMessage(data);\n\n    if (!message) {\n        return;\n    }\n\n    if (message.sourceDomain.indexOf(CONSTANTS.MOCK_PROTOCOL) === 0 || message.sourceDomain.indexOf(CONSTANTS.FILE_PROTOCOL) === 0) {\n        origin = message.sourceDomain;\n    }\n\n    if (global.receivedMessages.indexOf(message.id) === -1) {\n        global.clean.push(global.receivedMessages, message.id);\n    } else {\n        return;\n    }\n\n    let level;\n\n    if (POST_MESSAGE_NAMES_LIST.indexOf(message.name) !== -1 || message.type === CONSTANTS.POST_MESSAGE_TYPE.ACK) {\n        level = 'debug';\n    } else if (message.ack === 'error') {\n        level = 'error';\n    } else {\n        level = 'info';\n    }\n\n    log.logLevel(level, [ '\\n\\n\\t', '#receive', message.type.replace(/^postrobot_message_/, ''), '::', message.name, '::', origin, '\\n\\n', message ]);\n\n    if (isWindowClosed(source)) {\n        return log.debug(`Source window is closed - can not send ${message.type} ${message.name}`);\n    }\n\n    if (message.data) {\n        message.data = deserializeMethods(source, origin, message.data);\n    }\n\n    RECEIVE_MESSAGE_TYPES[message.type](source, origin, message);\n}\n\nexport function messageListener(event) {\n\n    try {\n        event.source // eslint-disable-line\n    } catch (err) {\n        return;\n    }\n\n    event = {\n        source: event.source || event.sourceElement,\n        origin: event.origin || event.originalEvent.origin,\n        data: event.data\n    };\n\n    try {\n        emulateIERestrictions(event.source, window);\n    } catch (err) {\n        return;\n    }\n\n    receiveMessage(event);\n}\n\nexport function listenForMessages() {\n    let listener = util.listen(window, 'message', messageListener);\n\n    global.clean.register('listener', () => {\n        listener.cancel();\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/drivers/receive/index.js","\nimport { CONSTANTS } from '../../conf';\nimport { promise, log, isWindowClosed } from '../../lib';\n\nimport { sendMessage } from '../send';\nimport { listeners, getRequestListener } from '../listeners';\n\nfunction matchDomain(domain, origin) {\n\n    if (typeof domain === 'string') {\n        return domain === '*' || origin === domain;\n    }\n\n    if (Object.prototype.toString.call(domain) === '[object RegExp]') {\n        return origin.match(domain);\n    }\n\n    if (Array.isArray(domain)) {\n        return domain.indexOf(origin) !== -1;\n    }\n\n    return false;\n}\n\nexport let RECEIVE_MESSAGE_TYPES = {\n\n    [ CONSTANTS.POST_MESSAGE_TYPE.ACK ]: (source, origin, message) => {\n\n        let options = listeners.response[message.hash];\n\n        if (!options) {\n            throw new Error(`No handler found for post message ack for message: ${message.name} from ${origin} in ${window.location.protocol}//${window.location.host}${window.location.pathname}`);\n        }\n\n        if (!matchDomain(options.domain, origin)) {\n            throw new Error(`Ack origin ${origin} does not match domain ${options.domain}`);\n        }\n\n        options.ack = true;\n    },\n\n    [ CONSTANTS.POST_MESSAGE_TYPE.REQUEST ]: (source, origin, message) => {\n\n        let options = getRequestListener(message.name, source, origin);\n\n        function respond(data) {\n\n            if (message.fireAndForget || isWindowClosed(source)) {\n                return promise.Promise.resolve();\n            }\n\n            return sendMessage(source, {\n                target: message.originalSource,\n                hash: message.hash,\n                name: message.name,\n                ...data\n            }, origin);\n        }\n\n        return promise.Promise.all([\n\n            respond({\n                type: CONSTANTS.POST_MESSAGE_TYPE.ACK\n            }),\n\n            promise.run(() => {\n\n                if (!options) {\n                    throw new Error(`No handler found for post message: ${message.name} from ${origin} in ${window.location.protocol}//${window.location.host}${window.location.pathname}`);\n                }\n\n                if (!matchDomain(options.domain, origin)) {\n                    throw new Error(`Request origin ${origin} does not match domain ${options.domain}`);\n                }\n\n                let data = message.data;\n\n                return promise.deNodeify(options.handler, { source, origin, data });\n\n            }).then(data => {\n\n                return respond({\n                    type: CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,\n                    ack: CONSTANTS.POST_MESSAGE_ACK.SUCCESS,\n                    data\n                });\n\n            }, err => {\n\n                return respond({\n                    type: CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,\n                    ack: CONSTANTS.POST_MESSAGE_ACK.ERROR,\n                    error: err.stack ? `${err.message}\\n${err.stack}` : err.toString()\n                });\n            })\n\n        ]).catch(err => {\n\n            if (options && options.handleError) {\n                return options.handleError(err);\n            } else {\n                log.error(err.stack || err.toString());\n            }\n        });\n    },\n\n    [ CONSTANTS.POST_MESSAGE_TYPE.RESPONSE ]: (source, origin, message) => {\n\n        let options = listeners.response[message.hash];\n\n        if (!options) {\n            throw new Error(`No handler found for post message response for message: ${message.name} from ${origin} in ${window.location.protocol}//${window.location.host}${window.location.pathname}`);\n        }\n\n        if (!matchDomain(options.domain, origin)) {\n            throw new Error(`Response origin ${origin} does not match domain ${options.domain}`);\n        }\n\n        delete listeners.response[message.hash];\n\n        if (message.ack === CONSTANTS.POST_MESSAGE_ACK.ERROR) {\n            return options.respond(new Error(message.error));\n        } else if (message.ack === CONSTANTS.POST_MESSAGE_ACK.SUCCESS) {\n            let data = message.data || message.response;\n\n            return options.respond(null, { source, origin, data });\n        }\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/drivers/receive/types.js","\nimport { CONSTANTS } from '../../conf';\nimport { isSameDomain, isSameTopWindow } from '../../lib';\nimport { emulateIERestrictions } from '../../compat';\nimport { sendBridgeMessage } from '../../bridge';\n\nexport let SEND_MESSAGE_STRATEGIES = {\n\n    [ CONSTANTS.SEND_STRATEGIES.POST_MESSAGE ](win, serializedMessage, domain) {\n\n        emulateIERestrictions(window, win);\n\n        if (domain && domain.indexOf(CONSTANTS.MOCK_PROTOCOL) === 0) {\n            domain = `${win.location.protocol}//${win.location.host}`;\n        }\n\n        if (domain && domain.indexOf(CONSTANTS.FILE_PROTOCOL) === 0) {\n            domain = `*`;\n        }\n\n        return win.postMessage(serializedMessage, domain);\n    },\n\n    [ CONSTANTS.SEND_STRATEGIES.BRIDGE ](win, serializedMessage, domain) {\n\n        if (isSameDomain(win)) {\n            throw new Error(`Post message through bridge disabled between same domain windows`);\n        }\n\n        if (isSameTopWindow(window, win) !== false) {\n            throw new Error(`Can only use bridge to communicate between two different windows, not between frames`);\n        }\n\n        return sendBridgeMessage(win, serializedMessage, domain);\n    },\n\n    [ CONSTANTS.SEND_STRATEGIES.GLOBAL ](win, serializedMessage, domain) {\n\n        if (!isSameDomain(win)) {\n            throw new Error(`Post message through global disabled between different domain windows`);\n        }\n\n        if (isSameTopWindow(window, win) !== false) {\n            throw new Error(`Can only use global to communicate between two different windows, not between frames`);\n        }\n\n        let foreignGlobal = win[CONSTANTS.WINDOW_PROPS.POSTROBOT];\n        \n        if (!foreignGlobal) {\n            throw new Error(`Can not find postRobot global on foreign window`);\n        }\n\n        return foreignGlobal.receiveMessage({\n            source: window,\n            origin: domain,\n            data: serializedMessage\n        });\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/drivers/send/strategies.js","\nimport { CONSTANTS } from '../conf';\nimport { util } from './util';\nimport { on, send } from '../interface';\nimport { log } from './log';\nimport { promise } from './promise';\nimport { global } from '../global';\n\nglobal.methods = global.methods || {};\n\nexport let listenForMethods = util.once(() => {\n    on(CONSTANTS.POST_MESSAGE_NAMES.METHOD, { window: '*', origin: '*' }, ({ source, origin, data }) => {\n\n        let meth = global.methods[data.id];\n\n        if (!meth) {\n            throw new Error(`Could not find method with id: ${data.id}`);\n        }\n\n        if (meth.destination !== source) {\n            throw new Error(`Method window does not match`);\n        }\n\n        if (meth.domain && meth.domain !== '*' && origin !== meth.domain) {\n            throw new Error(`Method domain ${meth.domain} does not match origin ${origin}`);\n        }\n\n        log.debug('Call local method', data.name, data.args);\n\n        return promise.run(() => {\n            return meth.method.apply({ source, origin, data }, data.args);\n\n        }).then(result => {\n\n            return {\n                result,\n                id: data.id,\n                name: data.name\n            };\n        });\n    });\n});\n\nfunction isSerialized(item, type) {\n    return typeof item === 'object' && item !== null && item.__type__ === type;\n}\n\nexport function serializeMethod(destination, domain, method, name) {\n\n    let id = util.uniqueID();\n\n    global.clean.setItem(global.methods, id, { destination, domain, method });\n\n    return {\n        __type__: CONSTANTS.SERIALIZATION_TYPES.METHOD,\n        __id__: id,\n        __name__: name\n    };\n}\n\nfunction serializeError(err) {\n    return {\n        __type__: CONSTANTS.SERIALIZATION_TYPES.ERROR,\n        __message__: err.stack || err.message || err.toString()\n    };\n}\n\nexport function serializeMethods(destination, domain, obj) {\n\n    return util.replaceObject({ obj }, (item, key) => {\n        if (typeof item === 'function') {\n            return serializeMethod(destination, domain, item, key);\n        }\n\n        if (item instanceof Error) {\n            return serializeError(item);\n        }\n    }).obj;\n}\n\nexport function deserializeMethod(source, origin, obj) {\n\n    function wrapper() {\n        let args = Array.prototype.slice.call(arguments);\n        log.debug('Call foreign method', obj.__name__, args);\n        return send(source, CONSTANTS.POST_MESSAGE_NAMES.METHOD, {\n            id: obj.__id__,\n            name: obj.__name__,\n            args\n\n        }, { domain: origin }).then(({ data }) => {\n\n            log.debug('Got foreign method result', obj.__name__, data.result);\n            return data.result;\n        }, err => {\n            log.debug('Got foreign method error', err.stack || err.toString());\n            throw err;\n        });\n    }\n\n    wrapper.__name__ = obj.__name__;\n    wrapper.source = source;\n    wrapper.origin = origin;\n\n    return wrapper;\n}\n\nexport function deserializeError(source, origin, obj) {\n    return new Error(obj.__message__);\n}\n\nexport function deserializeMethods(source, origin, obj) {\n\n    return util.replaceObject({ obj }, (item, key) => {\n\n        if (isSerialized(item, CONSTANTS.SERIALIZATION_TYPES.METHOD)) {\n            return deserializeMethod(source, origin, item);\n        }\n\n        if (isSerialized(item, CONSTANTS.SERIALIZATION_TYPES.ERROR)) {\n            return deserializeError(source, origin, item);\n        }\n\n    }).obj;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/methods.js","\nimport { CONSTANTS } from '../conf';\nimport { getAncestor } from './windows';\nimport { on, send } from '../interface';\nimport { log } from './log';\nimport { SyncPromise as Promise } from 'sync-browser-mocks/src/promise';\nimport { global } from '../global';\n\nglobal.readyPromises = global.readyPromises || [];\n\nexport function initOnReady() {\n\n    on(CONSTANTS.POST_MESSAGE_NAMES.READY, { window: '*', domain: '*' }, event => {\n\n        for (let item of global.readyPromises) {\n            if (item.win === event.source) {\n                item.promise.resolve(event);\n                return;\n            }\n        }\n\n        global.clean.push(global.readyPromises, {\n            win: event.source,\n            promise: new Promise().resolve(event)\n        });\n    });\n\n    let parent = getAncestor();\n\n    if (parent) {\n        send(parent, CONSTANTS.POST_MESSAGE_NAMES.READY, {}, { domain: '*' }).catch(err => {\n            log.debug(err.stack || err.toString());\n        });\n    }\n}\n\nexport function onWindowReady(win, timeout = 5000, name = 'Window') {\n\n    for (let item of global.readyPromises) {\n        if (item.win === win) {\n            return item.promise;\n        }\n    }\n\n    let promise = new Promise();\n\n    global.clean.push(global.readyPromises, { win, promise });\n\n    setTimeout(() => promise.reject(new Error(`${name} did not load after ${timeout}ms`)), timeout);\n\n    return promise;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/ready.js","\nimport { CONFIG, CONSTANTS } from '../conf';\nimport { sendMessage } from '../drivers';\nimport { global } from '../global';\nimport { util, promise, getAncestor, isAncestor, onWindowReady, isWindowClosed } from '../lib';\n\n\nexport function request(options) {\n\n    return promise.nodeify(new promise.Promise((resolve, reject) => {\n\n        if (!options.name) {\n            throw new Error('Expected options.name');\n        }\n\n        \n        if (CONFIG.MOCK_MODE) {\n            options.window = window;\n\n        } else if (typeof options.window === 'string') {\n            let el = document.getElementById(options.window);\n\n            if (!el) {\n                throw new Error(`Expected options.window ${options.window} to be a valid element id`);\n            }\n\n            if (el.tagName.toLowerCase() !== 'iframe') {\n                throw new Error(`Expected options.window ${options.window} to be an iframe`);\n            }\n\n            if (!el.contentWindow) {\n                throw new Error('Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.');\n            }\n\n            options.window = el.contentWindow;\n\n            \n        } else if (options.window instanceof HTMLElement) {\n            \n            if (options.window.tagName.toLowerCase() !== 'iframe') {\n                throw new Error(`Expected options.window ${options.window} to be an iframe`);\n            }\n\n            if (!options.window.contentWindow) {\n                throw new Error('Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.');\n            }\n            \n            options.window = options.window.contentWindow;\n        }\n\n        if (!options.window) {\n            throw new Error('Expected options.window to be a window object, iframe, or iframe element id.');\n        }\n\n        options.domain = options.domain || '*';\n\n        let hash = `${options.name}_${util.uniqueID()}`;\n        global.clean.setItem(global.listeners.response, hash, options);\n\n        if (isWindowClosed(options.window)) {\n            throw new Error('Target window is closed');\n        }\n\n        let hasResult = false;\n\n        options.respond = (err, result) => {\n            if (!err) {\n                hasResult = true;\n            }\n\n            return err ? reject(err) : resolve(result);\n        };\n\n        return promise.run(() => {\n\n            if (isAncestor(window, options.window)) {\n                return onWindowReady(options.window);\n            }\n\n        }).then(() => {\n\n            sendMessage(options.window, {\n                hash,\n                type: CONSTANTS.POST_MESSAGE_TYPE.REQUEST,\n                name: options.name,\n                data: options.data,\n                fireAndForget: options.fireAndForget\n            }, options.domain).catch(reject);\n\n            if (options.fireAndForget) {\n                return resolve();\n            }\n\n            let ackTimeout = util.intervalTimeout(CONFIG.ACK_TIMEOUT, 100, remaining => {\n\n                if (options.ack || isWindowClosed(options.window)) {\n                    return ackTimeout.cancel();\n                }\n\n                if (!remaining) {\n                    return reject(new Error(`No ack for postMessage ${options.name} in ${CONFIG.ACK_TIMEOUT}ms`));\n                }\n            });\n\n            if (options.timeout) {\n                let timeout = util.intervalTimeout(options.timeout, 100, remaining => {\n\n                    if (hasResult || isWindowClosed(options.window)) {\n                        return timeout.cancel();\n                    }\n\n                    if (!remaining) {\n                        return reject(new Error(`Post message response timed out after ${options.timeout} ms`));\n                    }\n\n                }, options.timeout);\n            }\n\n        }).catch(reject);\n\n    }), options.callback);\n}\n\nexport function send(window, name, data, options, callback) {\n\n    if (!callback) {\n        if (!options && typeof data === 'function') {\n            callback = data;\n            options = {};\n            data = {};\n        } else if (typeof options === 'function') {\n            callback = options;\n            options = {};\n        }\n    }\n\n    options = options || {};\n    options.window = window;\n    options.name = name;\n    options.data = data;\n    options.callback = callback;\n\n    return request(options);\n}\n\nexport function sendToParent(name, data, options, callback) {\n\n    let win = getAncestor();\n\n    if (!win) {\n        return new promise.Promise((resolve, reject) => reject(new Error('Window does not have a parent')));\n    }\n\n    return send(win, name, data, options, callback);\n}\n\nexport function client(options = {}) {\n\n    if (!options.window) {\n        throw new Error(`Expected options.window`);\n    }\n\n    return {\n        send(name, data, callback) {\n            return send(options.window, name, data, options, callback);\n        }\n    };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/client.js","\nimport { CONFIG, CONSTANTS } from '../conf';\nimport { messageListener } from '../drivers';\n\nexport function enableMockMode() {\n    CONFIG.MOCK_MODE = true;\n}\n\nexport function disableMockMode() {\n    CONFIG.MOCK_MODE = false;\n}\n\nexport { CONFIG, CONSTANTS } from '../conf';\n\nexport function disable() {\n    delete window[CONSTANTS.WINDOW_PROPS.POSTROBOT];\n    window.removeEventListener('message', messageListener);\n}\n\n\n// WEBPACK FOOTER //\n// ./src/public/config.js","\nimport { getAncestor } from '../lib/windows';\n\nexport * from './client';\nexport * from './server';\nexport * from './config';\n\nimport * as windowUtil from '../lib/windows';\n\nexport let parent = getAncestor();\n\nexport { openBridge, linkUrl, isBridge, needsBridge, needsBridgeForBrowser, needsBridgeForWin, needsBridgeForDomain, openTunnelToOpener, destroyBridges } from '../bridge';\n\nexport { util } from '../lib/util';\n\nexport let winutil = windowUtil;\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/index.js","\nimport { CONFIG } from '../conf';\nimport { util, promise, isWindowClosed } from '../lib';\nimport { addRequestListener, removeRequestListener } from '../drivers';\n\nexport function listen(options) {\n\n    if (!options.name) {\n        throw new Error('Expected options.name');\n    }\n\n    options.handler = options.handler || util.noop;\n\n    options.errorHandler = options.errorHandler || function(err) {\n        throw err;\n    };\n\n    if (options.once) {\n        let handler = options.handler;\n        options.handler = util.once(function() {\n            removeRequestListener(options);\n            return handler.apply(this, arguments);\n        });\n    }\n\n    let override = options.override || CONFIG.MOCK_MODE;\n\n    if (options.source) {\n        options.window = options.source;\n    }\n\n    options.domain = options.domain || '*';\n\n    addRequestListener(options.name, options.window, options.domain, options, override);\n\n    options.handleError = err => {\n        // removeRequestListener(options);\n        options.errorHandler(err);\n    };\n\n    if (options.window && options.errorOnClose) {\n        let interval = util.safeInterval(() => {\n            if (isWindowClosed(options.window)) {\n                interval.cancel();\n                options.handleError(new Error('Post message target window is closed'));\n            }\n        }, 50);\n    }\n\n    return {\n        cancel() {\n            removeRequestListener(options);\n        }\n    };\n}\n\nexport function on(name, options, handler, errorHandler) {\n\n    if (typeof options === 'function') {\n        errorHandler = handler;\n        handler = options;\n        options = {};\n    }\n\n    options = options || {};\n\n    options.name = name;\n    options.handler = handler || options.handler;\n    options.errorHandler = errorHandler || options.errorHandler;\n\n    return listen(options);\n}\n\nexport function once(name, options, handler, errorHandler) {\n\n    if (typeof options === 'function') {\n        errorHandler = handler;\n        handler = options;\n        options = {};\n    }\n\n    options = options || {};\n\n    options.name = name;\n    options.handler = handler || options.handler;\n    options.errorHandler = errorHandler || options.errorHandler;\n    options.once = true;\n\n    let prom = new promise.Promise((resolve, reject) => {\n        options.handler = options.handler || (event => resolve(event));\n        options.errorHandler = options.errorHandler || reject;\n    });\n\n    let myListener = listen(options);\n\n    util.extend(prom, myListener);\n\n    return prom;\n}\n\nexport function listener(options = {}) {\n\n    return {\n        on(name, handler, errorHandler) {\n            return on(name, options, handler, errorHandler);\n        }\n    };\n}\n\n\n// WEBPACK FOOTER //\n// ./src/public/server.js","\nimport * as INTERFACE from './interface';\nexport * from './interface';\nexport default INTERFACE;\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}